var ChatbotWidget=function(Wn,F,Bo){"use strict";function zn(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Gn={exports:{}},Ft={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fi;function Fo(){if(fi)return Ft;fi=1;var t=F,e=Symbol.for("react.element"),n=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function a(l,c,h){var p,m={},b=null,v=null;h!==void 0&&(b=""+h),c.key!==void 0&&(b=""+c.key),c.ref!==void 0&&(v=c.ref);for(p in c)r.call(c,p)&&!s.hasOwnProperty(p)&&(m[p]=c[p]);if(l&&l.defaultProps)for(p in c=l.defaultProps,c)m[p]===void 0&&(m[p]=c[p]);return{$$typeof:e,type:l,key:b,ref:v,props:m,_owner:i.current}}return Ft.Fragment=n,Ft.jsx=a,Ft.jsxs=a,Ft}var mi;function Uo(){return mi||(mi=1,Gn.exports=Fo()),Gn.exports}var j=Uo(),Hn={exports:{}},Qn,gi;function $o(){if(gi)return Qn;gi=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Qn=t,Qn}var Kn,vi;function qo(){if(vi)return Kn;vi=1;var t=$o();function e(){}function n(){}return n.resetWarningCache=e,Kn=function(){function r(a,l,c,h,p,m){if(m!==t){var b=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw b.name="Invariant Violation",b}}r.isRequired=r;function i(){return r}var s={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:i,element:r,elementType:r,instanceOf:i,node:r,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:n,resetWarningCache:e};return s.PropTypes=s,s},Kn}var yi;function Jo(){return yi||(yi=1,Hn.exports=qo()()),Hn.exports}var Vo=Jo();const sn=zn(Vo);var Yn,bi;function _i(){if(bi)return Yn;bi=1;var t=Object.prototype.toString;Yn=function(m){if(m===void 0)return"undefined";if(m===null)return"null";var b=typeof m;if(b==="boolean")return"boolean";if(b==="string")return"string";if(b==="number")return"number";if(b==="symbol")return"symbol";if(b==="function")return a(m)?"generatorfunction":"function";if(n(m))return"array";if(h(m))return"buffer";if(c(m))return"arguments";if(i(m))return"date";if(r(m))return"error";if(s(m))return"regexp";switch(e(m)){case"Symbol":return"symbol";case"Promise":return"promise";case"WeakMap":return"weakmap";case"WeakSet":return"weakset";case"Map":return"map";case"Set":return"set";case"Int8Array":return"int8array";case"Uint8Array":return"uint8array";case"Uint8ClampedArray":return"uint8clampedarray";case"Int16Array":return"int16array";case"Uint16Array":return"uint16array";case"Int32Array":return"int32array";case"Uint32Array":return"uint32array";case"Float32Array":return"float32array";case"Float64Array":return"float64array"}if(l(m))return"generator";switch(b=t.call(m),b){case"[object Object]":return"object";case"[object Map Iterator]":return"mapiterator";case"[object Set Iterator]":return"setiterator";case"[object String Iterator]":return"stringiterator";case"[object Array Iterator]":return"arrayiterator"}return b.slice(8,-1).toLowerCase().replace(/\s/g,"")};function e(p){return typeof p.constructor=="function"?p.constructor.name:null}function n(p){return Array.isArray?Array.isArray(p):p instanceof Array}function r(p){return p instanceof Error||typeof p.message=="string"&&p.constructor&&typeof p.constructor.stackTraceLimit=="number"}function i(p){return p instanceof Date?!0:typeof p.toDateString=="function"&&typeof p.getDate=="function"&&typeof p.setDate=="function"}function s(p){return p instanceof RegExp?!0:typeof p.flags=="string"&&typeof p.ignoreCase=="boolean"&&typeof p.multiline=="boolean"&&typeof p.global=="boolean"}function a(p,m){return e(p)==="GeneratorFunction"}function l(p){return typeof p.throw=="function"&&typeof p.return=="function"&&typeof p.next=="function"}function c(p){try{if(typeof p.length=="number"&&typeof p.callee=="function")return!0}catch(m){if(m.message.indexOf("callee")!==-1)return!0}return!1}function h(p){return p.constructor&&typeof p.constructor.isBuffer=="function"?p.constructor.isBuffer(p):!1}return Yn}/*!
 * shallow-clone <https://github.com/jonschlinkert/shallow-clone>
 *
 * Copyright (c) 2015-present, Jon Schlinkert.
 * Released under the MIT License.
 */var Xn,wi;function Wo(){if(wi)return Xn;wi=1;const t=Symbol.prototype.valueOf,e=_i();function n(c,h){switch(e(c)){case"array":return c.slice();case"object":return Object.assign({},c);case"date":return new c.constructor(Number(c));case"map":return new Map(c);case"set":return new Set(c);case"buffer":return a(c);case"symbol":return l(c);case"arraybuffer":return i(c);case"float32array":case"float64array":case"int16array":case"int32array":case"int8array":case"uint16array":case"uint32array":case"uint8clampedarray":case"uint8array":return s(c);case"regexp":return r(c);case"error":return Object.create(c);default:return c}}function r(c){const h=c.flags!==void 0?c.flags:/\w+$/.exec(c)||void 0,p=new c.constructor(c.source,h);return p.lastIndex=c.lastIndex,p}function i(c){const h=new c.constructor(c.byteLength);return new Uint8Array(h).set(new Uint8Array(c)),h}function s(c,h){return new c.constructor(c.buffer,c.byteOffset,c.length)}function a(c){const h=c.length,p=Buffer.allocUnsafe?Buffer.allocUnsafe(h):Buffer.from(h);return c.copy(p),p}function l(c){return t?Object(t.call(c)):{}}return Xn=n,Xn}/*!
 * isobject <https://github.com/jonschlinkert/isobject>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var Zn,Si;function zo(){return Si||(Si=1,Zn=function(e){return e!=null&&typeof e=="object"&&Array.isArray(e)===!1}),Zn}/*!
 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var er,ki;function Go(){if(ki)return er;ki=1;var t=zo();function e(n){return t(n)===!0&&Object.prototype.toString.call(n)==="[object Object]"}return er=function(r){var i,s;return!(e(r)===!1||(i=r.constructor,typeof i!="function")||(s=i.prototype,e(s)===!1)||s.hasOwnProperty("isPrototypeOf")===!1)},er}var tr,Ci;function Ho(){if(Ci)return tr;Ci=1;const t=Wo(),e=_i(),n=Go();function r(a,l){switch(e(a)){case"object":return i(a,l);case"array":return s(a,l);default:return t(a)}}function i(a,l){if(typeof l=="function")return l(a);if(l||n(a)){const c=new a.constructor;for(let h in a)c[h]=r(a[h],l);return c}return a}function s(a,l){const c=new a.constructor(a.length);for(let h=0;h<a.length;h++)c[h]=r(a[h],l);return c}return tr=r,tr}var Qo=Ho();const Ei=zn(Qo);var an={exports:{}},Mi;function Ko(){if(Mi)return an.exports;Mi=1;var t=typeof Reflect=="object"?Reflect:null,e=t&&typeof t.apply=="function"?t.apply:function(w,E,k){return Function.prototype.apply.call(w,E,k)},n;t&&typeof t.ownKeys=="function"?n=t.ownKeys:Object.getOwnPropertySymbols?n=function(w){return Object.getOwnPropertyNames(w).concat(Object.getOwnPropertySymbols(w))}:n=function(w){return Object.getOwnPropertyNames(w)};function r(y){console&&console.warn&&console.warn(y)}var i=Number.isNaN||function(w){return w!==w};function s(){s.init.call(this)}an.exports=s,an.exports.once=C,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var a=10;function l(y){if(typeof y!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof y)}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(y){if(typeof y!="number"||y<0||i(y))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+y+".");a=y}}),s.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(w){if(typeof w!="number"||w<0||i(w))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+w+".");return this._maxListeners=w,this};function c(y){return y._maxListeners===void 0?s.defaultMaxListeners:y._maxListeners}s.prototype.getMaxListeners=function(){return c(this)},s.prototype.emit=function(w){for(var E=[],k=1;k<arguments.length;k++)E.push(arguments[k]);var P=w==="error",I=this._events;if(I!==void 0)P=P&&I.error===void 0;else if(!P)return!1;if(P){var x;if(E.length>0&&(x=E[0]),x instanceof Error)throw x;var N=new Error("Unhandled error."+(x?" ("+x.message+")":""));throw N.context=x,N}var q=I[w];if(q===void 0)return!1;if(typeof q=="function")e(q,this,E);else for(var oe=q.length,ye=_(q,oe),k=0;k<oe;++k)e(ye[k],this,E);return!0};function h(y,w,E,k){var P,I,x;if(l(E),I=y._events,I===void 0?(I=y._events=Object.create(null),y._eventsCount=0):(I.newListener!==void 0&&(y.emit("newListener",w,E.listener?E.listener:E),I=y._events),x=I[w]),x===void 0)x=I[w]=E,++y._eventsCount;else if(typeof x=="function"?x=I[w]=k?[E,x]:[x,E]:k?x.unshift(E):x.push(E),P=c(y),P>0&&x.length>P&&!x.warned){x.warned=!0;var N=new Error("Possible EventEmitter memory leak detected. "+x.length+" "+String(w)+" listeners added. Use emitter.setMaxListeners() to increase limit");N.name="MaxListenersExceededWarning",N.emitter=y,N.type=w,N.count=x.length,r(N)}return y}s.prototype.addListener=function(w,E){return h(this,w,E,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(w,E){return h(this,w,E,!0)};function p(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function m(y,w,E){var k={fired:!1,wrapFn:void 0,target:y,type:w,listener:E},P=p.bind(k);return P.listener=E,k.wrapFn=P,P}s.prototype.once=function(w,E){return l(E),this.on(w,m(this,w,E)),this},s.prototype.prependOnceListener=function(w,E){return l(E),this.prependListener(w,m(this,w,E)),this},s.prototype.removeListener=function(w,E){var k,P,I,x,N;if(l(E),P=this._events,P===void 0)return this;if(k=P[w],k===void 0)return this;if(k===E||k.listener===E)--this._eventsCount===0?this._events=Object.create(null):(delete P[w],P.removeListener&&this.emit("removeListener",w,k.listener||E));else if(typeof k!="function"){for(I=-1,x=k.length-1;x>=0;x--)if(k[x]===E||k[x].listener===E){N=k[x].listener,I=x;break}if(I<0)return this;I===0?k.shift():S(k,I),k.length===1&&(P[w]=k[0]),P.removeListener!==void 0&&this.emit("removeListener",w,N||E)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(w){var E,k,P;if(k=this._events,k===void 0)return this;if(k.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):k[w]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete k[w]),this;if(arguments.length===0){var I=Object.keys(k),x;for(P=0;P<I.length;++P)x=I[P],x!=="removeListener"&&this.removeAllListeners(x);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(E=k[w],typeof E=="function")this.removeListener(w,E);else if(E!==void 0)for(P=E.length-1;P>=0;P--)this.removeListener(w,E[P]);return this};function b(y,w,E){var k=y._events;if(k===void 0)return[];var P=k[w];return P===void 0?[]:typeof P=="function"?E?[P.listener||P]:[P]:E?L(P):_(P,P.length)}s.prototype.listeners=function(w){return b(this,w,!0)},s.prototype.rawListeners=function(w){return b(this,w,!1)},s.listenerCount=function(y,w){return typeof y.listenerCount=="function"?y.listenerCount(w):v.call(y,w)},s.prototype.listenerCount=v;function v(y){var w=this._events;if(w!==void 0){var E=w[y];if(typeof E=="function")return 1;if(E!==void 0)return E.length}return 0}s.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]};function _(y,w){for(var E=new Array(w),k=0;k<w;++k)E[k]=y[k];return E}function S(y,w){for(;w+1<y.length;w++)y[w]=y[w+1];y.pop()}function L(y){for(var w=new Array(y.length),E=0;E<w.length;++E)w[E]=y[E].listener||y[E];return w}function C(y,w){return new Promise(function(E,k){function P(x){y.removeListener(w,I),k(x)}function I(){typeof y.removeListener=="function"&&y.removeListener("error",P),E([].slice.call(arguments))}A(y,w,I,{once:!0}),w!=="error"&&T(y,P,{once:!0})})}function T(y,w,E){typeof y.on=="function"&&A(y,"error",w,E)}function A(y,w,E,k){if(typeof y.on=="function")k.once?y.once(w,E):y.on(w,E);else if(typeof y.addEventListener=="function")y.addEventListener(w,function P(I){k.once&&y.removeEventListener(w,P),E(I)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof y)}return an.exports}var Yo=Ko();const Xo=zn(Yo);for(var ie=[],nr=0;nr<256;++nr)ie.push((nr+256).toString(16).slice(1));function Zo(t,e=0){return(ie[t[e+0]]+ie[t[e+1]]+ie[t[e+2]]+ie[t[e+3]]+"-"+ie[t[e+4]]+ie[t[e+5]]+"-"+ie[t[e+6]]+ie[t[e+7]]+"-"+ie[t[e+8]]+ie[t[e+9]]+"-"+ie[t[e+10]]+ie[t[e+11]]+ie[t[e+12]]+ie[t[e+13]]+ie[t[e+14]]+ie[t[e+15]]).toLowerCase()}var on,ec=new Uint8Array(16);function tc(){if(!on&&(on=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!on))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return on(ec)}var nc=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const Ti={randomUUID:nc};function rc(t,e,n){if(Ti.randomUUID&&!e&&!t)return Ti.randomUUID();t=t||{};var r=t.random||(t.rng||tc)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){n=n||0;for(var i=0;i<16;++i)e[n+i]=r[i];return e}return Zo(r)}function te(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}function ic(t){return t&&t.__esModule?t.default:t}var sc={};te(sc,"httpActionGenerator",()=>Oi);async function Oi(t,e,n,r){try{Y.debug("[RTVI] Fetch action",t,e);const i=new Headers({...Object.fromEntries((n.headers??new Headers).entries())});i.has("Content-Type")||i.set("Content-Type","application/json"),i.set("Cache-Control","no-cache"),i.set("Connection","keep-alive");const s=await fetch(t,{method:"POST",headers:i,body:JSON.stringify({...n.requestData,actions:[e]})}),a=s.headers.get("content-type");if(!s.ok){const l=await s.text();throw new be(`Failed to resolve action: ${l}`,s.status)}if(s.body&&(a!=null&&a.includes("text/event-stream"))){const l=s.body.pipeThrough(new TextDecoderStream).getReader();let c="";for(;;){const{value:h,done:p}=await l.read();if(p)break;c+=h;let m=c.indexOf(`

`);for(;m!==-1;){const b=c.slice(0,m);c=c.slice(m+2);const v=b.split(`
`);let _="";for(const S of v){const L=S.indexOf(":");L!==-1&&(_+=S.slice(L+1).trim())}try{const S=atob(_),L=JSON.parse(S);r(L)}catch(S){throw Y.error("[RTVI] Failed to parse JSON:",S),S}m=c.indexOf(`

`)}}}else{const l=await s.json();r(l)}}catch(i){throw Y.error("[RTVI] Error during fetch:",i),i}}var ac={};te(ac,"RTVIClient",()=>De);var Ai={};Ai=JSON.parse('{"name":"@pipecat-ai/client-js","version":"0.3.2","license":"BSD-2-Clause","main":"dist/index.js","module":"dist/index.module.js","types":"dist/index.d.ts","source":"src/index.ts","repository":{"type":"git","url":"git+https://github.com/pipecat-ai/pipecat-client-web.git"},"files":["dist","package.json","README.md"],"scripts":{"build":"jest --silent && parcel build --no-cache","dev":"parcel watch","lint":"eslint src/ --report-unused-disable-directives --max-warnings 0","test":"jest"},"jest":{"preset":"ts-jest","testEnvironment":"node"},"devDependencies":{"@jest/globals":"^29.7.0","@types/clone-deep":"^4.0.4","@types/jest":"^29.5.12","@types/uuid":"^10.0.0","eslint":"^9.11.1","eslint-config-prettier":"^9.1.0","eslint-plugin-simple-import-sort":"^12.1.1","jest":"^29.7.0","ts-jest":"^29.2.5"},"dependencies":{"@types/events":"^3.0.3","clone-deep":"^4.0.1","events":"^3.3.0","typed-emitter":"^2.1.0","uuid":"^10.0.0"}}');var st={};te(st,"RTVIError",()=>be),te(st,"ConnectionTimeoutError",()=>xi),te(st,"StartBotError",()=>rr),te(st,"TransportStartError",()=>Pi),te(st,"BotNotReadyError",()=>ze),te(st,"ConfigUpdateError",()=>oc),te(st,"ActionEndpointNotSetError",()=>Li);class be extends Error{constructor(e,n){super(e),this.status=n}}class xi extends be{constructor(e){super(e??"Bot did not enter ready state within the specified timeout period.")}}class rr extends be{constructor(e,n){super(e??"Failed to connect / invalid auth bundle from base url",n??500),this.error="invalid-request-error"}}class Pi extends be{constructor(e){super(e??"Unable to connect to transport")}}class ze extends be{constructor(e){super(e??"Attempt to call action on transport when not in 'ready' state.")}}class oc extends be{constructor(e){super(e??"Unable to update configuration"),this.status=400}}class Li extends be{constructor(e){super(e??"Action endpoint is not set")}}function Et(t,e,n){const r=n.value;return n.value=function(...i){if(this.state==="ready")return r.apply(this,i);throw new ze(`Attempt to call ${e.toString()} when transport not in ready state. Await connect() first.`)},n}function cc(...t){return t=["ready",...t],function(e,n,r){const i=r.get;return r.get=function(){if(t.includes(this.state))return i==null?void 0:i.apply(this);throw new ze(`Attempt to call ${n.toString()} when transport not in ${t}. Await connect() first.`)},r}}var lc={};te(lc,"RTVIEvent",()=>R);var R;(function(t){t.MessageError="messageError",t.Error="error",t.Connected="connected",t.Disconnected="disconnected",t.TransportStateChanged="transportStateChanged",t.Config="config",t.ConfigDescribe="configDescribe",t.ActionsAvailable="actionsAvailable",t.ParticipantConnected="participantConnected",t.ParticipantLeft="participantLeft",t.TrackStarted="trackStarted",t.TrackStopped="trackStopped",t.ScreenTrackStarted="screenTrackStarted",t.ScreenTrackStopped="screenTrackStopped",t.ScreenShareError="screenShareError",t.AvailableCamsUpdated="availableCamsUpdated",t.AvailableMicsUpdated="availableMicsUpdated",t.AvailableSpeakersUpdated="availableSpeakersUpdated",t.CamUpdated="camUpdated",t.MicUpdated="micUpdated",t.SpeakerUpdated="speakerUpdated",t.BotConnected="botConnected",t.BotReady="botReady",t.BotDisconnected="botDisconnected",t.BotStartedSpeaking="botStartedSpeaking",t.BotStoppedSpeaking="botStoppedSpeaking",t.RemoteAudioLevel="remoteAudioLevel",t.UserStartedSpeaking="userStartedSpeaking",t.UserStoppedSpeaking="userStoppedSpeaking",t.LocalAudioLevel="localAudioLevel",t.Metrics="metrics",t.UserTranscript="userTranscript",t.BotTranscript="botTranscript",t.BotLlmText="botLlmText",t.BotLlmStarted="botLlmStarted",t.BotLlmStopped="botLlmStopped",t.BotTtsText="botTtsText",t.BotTtsStarted="botTtsStarted",t.BotTtsStopped="botTtsStopped",t.LLMFunctionCall="llmFunctionCall",t.LLMFunctionCallStart="llmFunctionCallStart",t.LLMJsonCompletion="llmJsonCompletion",t.StorageItemStored="storageItemStored"})(R||(R={}));var uc={};te(uc,"RTVIClientHelper",()=>ir);class ir{constructor(e){this._options=e}set client(e){this._client=e}set service(e){this._service=e}}var ji={};te(ji,"LogLevel",()=>Ge),te(ji,"logger",()=>Y);var Ge;(function(t){t[t.NONE=0]="NONE",t[t.ERROR=1]="ERROR",t[t.WARN=2]="WARN",t[t.INFO=3]="INFO",t[t.DEBUG=4]="DEBUG"})(Ge||(Ge={}));class Mt{constructor(){this.level=Ge.DEBUG}static getInstance(){return Mt.instance||(Mt.instance=new Mt),Mt.instance}setLevel(e){this.level=e}debug(...e){this.level>=Ge.DEBUG&&console.debug(...e)}info(...e){this.level>=Ge.INFO&&console.info(...e)}warn(...e){this.level>=Ge.WARN&&console.warn(...e)}error(...e){this.level>=Ge.ERROR&&console.error(...e)}}const Y=Mt.getInstance();var Tt={};te(Tt,"RTVI_MESSAGE_LABEL",()=>Di),te(Tt,"RTVIMessageType",()=>z),te(Tt,"RTVIMessage",()=>se),te(Tt,"RTVI_ACTION_TYPE",()=>Ii),te(Tt,"RTVIActionRequest",()=>Ni),te(Tt,"MessageDispatcher",()=>Ri);const Di="rtvi-ai";var z;(function(t){t.CLIENT_READY="client-ready",t.UPDATE_CONFIG="update-config",t.GET_CONFIG="get-config",t.DESCRIBE_CONFIG="describe-config",t.DESCRIBE_ACTIONS="describe-actions",t.DISCONNECT_BOT="disconnect-bot",t.BOT_READY="bot-ready",t.ERROR="error",t.ERROR_RESPONSE="error-response",t.CONFIG="config",t.CONFIG_AVAILABLE="config-available",t.CONFIG_ERROR="config-error",t.ACTIONS_AVAILABLE="actions-available",t.ACTION_RESPONSE="action-response",t.METRICS="metrics",t.USER_TRANSCRIPTION="user-transcription",t.BOT_TRANSCRIPTION="bot-transcription",t.USER_STARTED_SPEAKING="user-started-speaking",t.USER_STOPPED_SPEAKING="user-stopped-speaking",t.BOT_STARTED_SPEAKING="bot-started-speaking",t.BOT_STOPPED_SPEAKING="bot-stopped-speaking",t.USER_LLM_TEXT="user-llm-text",t.BOT_LLM_TEXT="bot-llm-text",t.BOT_LLM_STARTED="bot-llm-started",t.BOT_LLM_STOPPED="bot-llm-stopped",t.BOT_TTS_TEXT="bot-tts-text",t.BOT_TTS_STARTED="bot-tts-started",t.BOT_TTS_STOPPED="bot-tts-stopped",t.STORAGE_ITEM_STORED="storage-item-stored"})(z||(z={}));class se{constructor(e,n,r){this.label=Di,this.type=e,this.data=n,this.id=r||rc().slice(0,8)}static clientReady(){return new se(z.CLIENT_READY,{})}static updateConfig(e,n=!1){return new se(z.UPDATE_CONFIG,{config:e,interrupt:n})}static describeConfig(){return new se(z.DESCRIBE_CONFIG,{})}static getBotConfig(){return new se(z.GET_CONFIG,{})}static describeActions(){return new se(z.DESCRIBE_ACTIONS,{})}static disconnectBot(){return new se(z.DISCONNECT_BOT,{})}}const Ii="action";class Ni extends se{constructor(e){super(Ii,e)}}class Ri{constructor(e){this._queue=new Array,this._gcTime=1e4,this._queue=[],this._client=e}dispatch(e){const n=new Promise((r,i)=>{this._queue.push({message:e,timestamp:Date.now(),resolve:r,reject:i})});return Y.debug("[MessageDispatcher] dispatch",e),this._client.sendMessage(e),this._gc(),n}async dispatchAction(e,n){var i;const r=new Promise((s,a)=>{this._queue.push({message:e,timestamp:Date.now(),resolve:s,reject:a})});if(Y.debug("[MessageDispatcher] action",e),this._client.connected)this._client.sendMessage(e);else{if(!((i=this._client.params.endpoints)!=null&&i.action))throw Y.error("[MessageDispatcher] Action endpoint is required when dispatching action in disconnected state"),new Li;const s=this._client.constructUrl("action");try{await Oi(s,e,this._client.params,a=>{n(a)})}catch{n(new se(z.ERROR_RESPONSE,`Action endpoint '${s}' returned an error response`,e.id))}}return this._gc(),r}_resolveReject(e,n=!0){const r=this._queue.find(i=>i.message.id===e.id);return r&&(n?(Y.debug("[MessageDispatcher] Resolve",e),r.resolve((e.type===z.ACTION_RESPONSE,e))):(Y.debug("[MessageDispatcher] Reject",e),r.reject(e)),this._queue=this._queue.filter(i=>i.message.id!==e.id),Y.debug("[MessageDispatcher] Queue",this._queue)),e}resolve(e){return this._resolveReject(e,!0)}reject(e){return this._resolveReject(e,!1)}_gc(){this._queue=this._queue.filter(e=>Date.now()-e.timestamp<this._gcTime),Y.debug("[MessageDispatcher] GC",this._queue)}}var at=function(t,e,n,r){var i=arguments.length,s=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,n,r);else for(var l=t.length-1;l>=0;l--)(a=t[l])&&(s=(i<3?a(s):i>3?a(e,n,s):a(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s};const dc={connect:"/connect",action:"/action"};class hc extends Xo{}class De extends hc{constructor(e){super(),this.params={...e.params,endpoints:{...dc,...e.params.endpoints??{}}},this._helpers={},this._transport=e.transport;const n={...e.callbacks,onMessageError:r=>{var i,s;(s=(i=e==null?void 0:e.callbacks)==null?void 0:i.onMessageError)==null||s.call(i,r),this.emit(R.MessageError,r)},onError:r=>{var i,s;(s=(i=e==null?void 0:e.callbacks)==null?void 0:i.onError)==null||s.call(i,r),this.emit(R.Error,r)},onConnected:()=>{var r,i;(i=(r=e==null?void 0:e.callbacks)==null?void 0:r.onConnected)==null||i.call(r),this.emit(R.Connected)},onDisconnected:()=>{var r,i;(i=(r=e==null?void 0:e.callbacks)==null?void 0:r.onDisconnected)==null||i.call(r),this.emit(R.Disconnected)},onTransportStateChanged:r=>{var i,s;(s=(i=e==null?void 0:e.callbacks)==null?void 0:i.onTransportStateChanged)==null||s.call(i,r),this.emit(R.TransportStateChanged,r)},onConfig:r=>{var i,s;(s=(i=e==null?void 0:e.callbacks)==null?void 0:i.onConfig)==null||s.call(i,r),this.emit(R.Config,r)},onConfigDescribe:r=>{var i,s;(s=(i=e==null?void 0:e.callbacks)==null?void 0:i.onConfigDescribe)==null||s.call(i,r),this.emit(R.ConfigDescribe,r)},onActionsAvailable:r=>{var i,s;(s=(i=e==null?void 0:e.callbacks)==null?void 0:i.onActionsAvailable)==null||s.call(i,r),this.emit(R.ActionsAvailable,r)},onParticipantJoined:r=>{var i,s;(s=(i=e==null?void 0:e.callbacks)==null?void 0:i.onParticipantJoined)==null||s.call(i,r),this.emit(R.ParticipantConnected,r)},onParticipantLeft:r=>{var i,s;(s=(i=e==null?void 0:e.callbacks)==null?void 0:i.onParticipantLeft)==null||s.call(i,r),this.emit(R.ParticipantLeft,r)},onTrackStarted:(r,i)=>{var s,a;(a=(s=e==null?void 0:e.callbacks)==null?void 0:s.onTrackStarted)==null||a.call(s,r,i),this.emit(R.TrackStarted,r,i)},onTrackStopped:(r,i)=>{var s,a;(a=(s=e==null?void 0:e.callbacks)==null?void 0:s.onTrackStopped)==null||a.call(s,r,i),this.emit(R.TrackStopped,r,i)},onScreenTrackStarted:(r,i)=>{var s,a;(a=(s=e==null?void 0:e.callbacks)==null?void 0:s.onScreenTrackStarted)==null||a.call(s,r,i),this.emit(R.ScreenTrackStarted,r,i)},onScreenTrackStopped:(r,i)=>{var s,a;(a=(s=e==null?void 0:e.callbacks)==null?void 0:s.onScreenTrackStopped)==null||a.call(s,r,i),this.emit(R.ScreenTrackStopped,r,i)},onScreenShareError:r=>{var i,s;(s=(i=e==null?void 0:e.callbacks)==null?void 0:i.onScreenShareError)==null||s.call(i,r),this.emit(R.ScreenShareError,r)},onAvailableCamsUpdated:r=>{var i,s;(s=(i=e==null?void 0:e.callbacks)==null?void 0:i.onAvailableCamsUpdated)==null||s.call(i,r),this.emit(R.AvailableCamsUpdated,r)},onAvailableMicsUpdated:r=>{var i,s;(s=(i=e==null?void 0:e.callbacks)==null?void 0:i.onAvailableMicsUpdated)==null||s.call(i,r),this.emit(R.AvailableMicsUpdated,r)},onAvailableSpeakersUpdated:r=>{var i,s;(s=(i=e==null?void 0:e.callbacks)==null?void 0:i.onAvailableSpeakersUpdated)==null||s.call(i,r),this.emit(R.AvailableSpeakersUpdated,r)},onCamUpdated:r=>{var i,s;(s=(i=e==null?void 0:e.callbacks)==null?void 0:i.onCamUpdated)==null||s.call(i,r),this.emit(R.CamUpdated,r)},onMicUpdated:r=>{var i,s;(s=(i=e==null?void 0:e.callbacks)==null?void 0:i.onMicUpdated)==null||s.call(i,r),this.emit(R.MicUpdated,r)},onSpeakerUpdated:r=>{var i,s;(s=(i=e==null?void 0:e.callbacks)==null?void 0:i.onSpeakerUpdated)==null||s.call(i,r),this.emit(R.SpeakerUpdated,r)},onBotConnected:r=>{var i,s;(s=(i=e==null?void 0:e.callbacks)==null?void 0:i.onBotConnected)==null||s.call(i,r),this.emit(R.BotConnected,r)},onBotReady:r=>{var i,s;(s=(i=e==null?void 0:e.callbacks)==null?void 0:i.onBotReady)==null||s.call(i,r),this.emit(R.BotReady,r)},onBotDisconnected:r=>{var i,s;(s=(i=e==null?void 0:e.callbacks)==null?void 0:i.onBotDisconnected)==null||s.call(i,r),this.emit(R.BotDisconnected,r)},onBotStartedSpeaking:()=>{var r,i;(i=(r=e==null?void 0:e.callbacks)==null?void 0:r.onBotStartedSpeaking)==null||i.call(r),this.emit(R.BotStartedSpeaking)},onBotStoppedSpeaking:()=>{var r,i;(i=(r=e==null?void 0:e.callbacks)==null?void 0:r.onBotStoppedSpeaking)==null||i.call(r),this.emit(R.BotStoppedSpeaking)},onRemoteAudioLevel:(r,i)=>{var s,a;(a=(s=e==null?void 0:e.callbacks)==null?void 0:s.onRemoteAudioLevel)==null||a.call(s,r,i),this.emit(R.RemoteAudioLevel,r,i)},onUserStartedSpeaking:()=>{var r,i;(i=(r=e==null?void 0:e.callbacks)==null?void 0:r.onUserStartedSpeaking)==null||i.call(r),this.emit(R.UserStartedSpeaking)},onUserStoppedSpeaking:()=>{var r,i;(i=(r=e==null?void 0:e.callbacks)==null?void 0:r.onUserStoppedSpeaking)==null||i.call(r),this.emit(R.UserStoppedSpeaking)},onLocalAudioLevel:r=>{var i,s;(s=(i=e==null?void 0:e.callbacks)==null?void 0:i.onLocalAudioLevel)==null||s.call(i,r),this.emit(R.LocalAudioLevel,r)},onUserTranscript:r=>{var i,s;(s=(i=e==null?void 0:e.callbacks)==null?void 0:i.onUserTranscript)==null||s.call(i,r),this.emit(R.UserTranscript,r)},onBotTranscript:r=>{var i,s;(s=(i=e==null?void 0:e.callbacks)==null?void 0:i.onBotTranscript)==null||s.call(i,r),this.emit(R.BotTranscript,r)},onBotLlmText:r=>{var i,s;(s=(i=e==null?void 0:e.callbacks)==null?void 0:i.onBotLlmText)==null||s.call(i,r),this.emit(R.BotLlmText,r)},onBotLlmStarted:()=>{var r,i;(i=(r=e==null?void 0:e.callbacks)==null?void 0:r.onBotLlmStarted)==null||i.call(r),this.emit(R.BotLlmStarted)},onBotLlmStopped:()=>{var r,i;(i=(r=e==null?void 0:e.callbacks)==null?void 0:r.onBotLlmStopped)==null||i.call(r),this.emit(R.BotLlmStopped)},onBotTtsText:r=>{var i,s;(s=(i=e==null?void 0:e.callbacks)==null?void 0:i.onBotTtsText)==null||s.call(i,r),this.emit(R.BotTtsText,r)},onBotTtsStarted:()=>{var r,i;(i=(r=e==null?void 0:e.callbacks)==null?void 0:r.onBotTtsStarted)==null||i.call(r),this.emit(R.BotTtsStarted)},onBotTtsStopped:()=>{var r,i;(i=(r=e==null?void 0:e.callbacks)==null?void 0:r.onBotTtsStopped)==null||i.call(r),this.emit(R.BotTtsStopped)},onStorageItemStored:r=>{var i,s;(s=(i=e==null?void 0:e.callbacks)==null?void 0:i.onStorageItemStored)==null||s.call(i,r),this.emit(R.StorageItemStored,r)}};this._options={...e,callbacks:n,enableMic:e.enableMic??!0,enableCam:e.enableCam??!1},this._initialize(),Y.debug("[RTVI Client] Initialized",this.version)}constructUrl(e){var r;if(!this.params.baseUrl)throw new be("Base URL not set. Please set rtviClient.params.baseUrl");return this.params.baseUrl.replace(/\/+$/,"")+(((r=this.params.endpoints)==null?void 0:r[e])??"")}setLogLevel(e){Y.setLevel(e)}async initDevices(){Y.debug("[RTVI Client] Initializing devices..."),await this._transport.initDevices()}async connect(){if(["authenticating","connecting","connected","ready"].includes(this._transport.state))throw new be("Voice client has already been started. Please call disconnect() before starting again.");return this._abortController=new AbortController,new Promise((e,n)=>{(async()=>{var s,a,l;this._startResolve=e,this._transport.state==="disconnected"&&await this._transport.initDevices(),this._transport.state="authenticating",this._options.timeout&&(this._handshakeTimeout=setTimeout(async()=>{var c;(c=this._abortController)==null||c.abort(),await this.disconnect(),this._transport.state="error",n(new xi)},this._options.timeout));let r;const i=this._options.customConnectHandler;if(Y.debug("[RTVI Client] Start params",this.params),this.params={...this.params,requestData:{...this.params.requestData,rtvi_client_version:this.version}},!this.params.baseUrl&&!((s=this.params.endpoints)!=null&&s.connect))Y.debug("[RTVI Client] Connecting directly (skipping handshake / auth)..."),clearTimeout(this._handshakeTimeout);else{const c=this.constructUrl("connect");Y.debug("[RTVI Client] Connecting...",c),Y.debug("[RTVI Client] Start params",this.params);try{i?r=await i(this.params,this._handshakeTimeout,this._abortController):r=await fetch(c,{method:"POST",mode:"cors",headers:new Headers({"Content-Type":"application/json",...Object.fromEntries((this.params.headers??new Headers).entries())}),body:JSON.stringify({config:this.params.config,...this.params.services?{services:this.params.services}:{},...this.params.requestData}),signal:(a=this._abortController)==null?void 0:a.signal}).then(h=>(clearTimeout(this._handshakeTimeout),h.ok?h.json():Promise.reject(h)))}catch(h){if(clearTimeout(this._handshakeTimeout),(l=this._abortController)!=null&&l.signal.aborted)return;if(this._transport.state="error",h instanceof Response){const p=await h.json();n(new rr(p.info??p.detail??h.statusText,h.status))}else n(new rr);return}Y.debug("[RTVI Client] Auth bundle received",r)}try{await this._transport.connect(r,this._abortController)}catch(c){clearTimeout(this._handshakeTimeout),n(c);return}await this._transport.sendReadyMessage()})()})}async disconnect(){this._abortController&&this._abortController.abort(),clearTimeout(this._handshakeTimeout),await this._transport.disconnect(),this._initialize()}_initialize(){this._transport=this._options.transport,this._transport.initialize(this._options,this.handleMessage.bind(this)),this._messageDispatcher=new Ri(this)}get connected(){return["connected","ready"].includes(this._transport.state)}get state(){return this._transport.state}get version(){return ic(Ai).version}async getAllMics(){return await this._transport.getAllMics()}async getAllCams(){return await this._transport.getAllCams()}async getAllSpeakers(){return await this._transport.getAllSpeakers()}get selectedMic(){return this._transport.selectedMic}get selectedCam(){return this._transport.selectedCam}get selectedSpeaker(){return this._transport.selectedSpeaker}updateMic(e){this._transport.updateMic(e)}updateCam(e){this._transport.updateCam(e)}updateSpeaker(e){this._transport.updateSpeaker(e)}enableMic(e){this._transport.enableMic(e)}get isMicEnabled(){return this._transport.isMicEnabled}enableCam(e){this._transport.enableCam(e)}get isCamEnabled(){return this._transport.isCamEnabled}tracks(){return this._transport.tracks()}enableScreenShare(e){return this._transport.enableScreenShare(e)}get isSharingScreen(){return this._transport.isSharingScreen}async getConfig(){return(await this._messageDispatcher.dispatch(se.getBotConfig())).data.config}async updateConfig(e,n=!1){return Y.debug("[RTVI Client] Updating config",e),this._messageDispatcher.dispatch(se.updateConfig(e,n))}async describeConfig(){return this._messageDispatcher.dispatch(se.describeConfig())}async getServiceOptionsFromConfig(e,n){if(!n&&this.state!=="ready")throw new ze("getServiceOptionsFromConfig called without config array before bot is ready");return Promise.resolve().then(async()=>{if(!e){Y.debug("Target service name is required");return}const i=(n??await this.getConfig()).find(s=>s.service===e);if(!i){Y.debug("No service with name "+e+" not found in config");return}return i})}async getServiceOptionValueFromConfig(e,n,r){const i=await this.getServiceOptionsFromConfig(e,r);if(!i){Y.debug("Service with name "+e+" not found in config");return}const s=i.options.find(a=>a.name===n);return s?s.value:void 0}_updateOrAddOption(e,n){const r=e.findIndex(i=>i.name===n.name);return r!==-1?e.map((i,s)=>s===r?{...i,value:n.value}:i):[...e,{name:n.name,value:n.value}]}async setServiceOptionInConfig(e,n,r){const i=Ei(r??await this.getConfig());if(!await this.getServiceOptionsFromConfig(e,i))return Y.debug("Service with name '"+e+"' not found in config"),i;const a=Array.isArray(n)?n:[n];for(const l of a){const c=i.find(p=>p.service===e),h=c?this._updateOrAddOption(c.options,l):[{name:l.name,value:l.value}];c?c.options=h:i.push({service:e,options:h})}return i}async setConfigOptions(e,n){let r=Ei(n??await this.getConfig());for(const i of e)r=await this.setServiceOptionInConfig(i.service,i.options,r)||r;return r}async action(e){return this._messageDispatcher.dispatchAction(new Ni(e),this.handleMessage.bind(this))}async describeActions(){return this._messageDispatcher.dispatch(se.describeActions())}get transportExpiry(){return this._transport.expiry}sendMessage(e){this._transport.sendMessage(e)}disconnectBot(){this._transport.sendMessage(new se(z.DISCONNECT_BOT,{}))}handleMessage(e){var n,r,i,s,a,l,c,h,p,m,b,v,_,S,L,C,T,A,y,w,E,k,P,I,x,N,q,oe,ye,je,nt,Ae,rt,$e,kt,qe,Bt,ue,o,u,d,g,f;switch(Y.debug("[RTVI Message]",e),e.type){case z.BOT_READY:clearTimeout(this._handshakeTimeout),(n=this._startResolve)==null||n.call(this,e.data),(i=(r=this._options.callbacks)==null?void 0:r.onBotReady)==null||i.call(r,e.data);break;case z.CONFIG_AVAILABLE:this._messageDispatcher.resolve(e),(a=(s=this._options.callbacks)==null?void 0:s.onConfigDescribe)==null||a.call(s,e.data);break;case z.CONFIG:{const M=this._messageDispatcher.resolve(e);(c=(l=this._options.callbacks)==null?void 0:l.onConfig)==null||c.call(l,M.data.config);break}case z.ACTIONS_AVAILABLE:this._messageDispatcher.resolve(e),(p=(h=this._options.callbacks)==null?void 0:h.onActionsAvailable)==null||p.call(h,e.data);break;case z.ACTION_RESPONSE:this._messageDispatcher.resolve(e);break;case z.ERROR_RESPONSE:{const M=this._messageDispatcher.reject(e);(b=(m=this._options.callbacks)==null?void 0:m.onMessageError)==null||b.call(m,M);break}case z.ERROR:(_=(v=this._options.callbacks)==null?void 0:v.onError)==null||_.call(v,e);break;case z.USER_STARTED_SPEAKING:(L=(S=this._options.callbacks)==null?void 0:S.onUserStartedSpeaking)==null||L.call(S);break;case z.USER_STOPPED_SPEAKING:(T=(C=this._options.callbacks)==null?void 0:C.onUserStoppedSpeaking)==null||T.call(C);break;case z.BOT_STARTED_SPEAKING:(y=(A=this._options.callbacks)==null?void 0:A.onBotStartedSpeaking)==null||y.call(A);break;case z.BOT_STOPPED_SPEAKING:(E=(w=this._options.callbacks)==null?void 0:w.onBotStoppedSpeaking)==null||E.call(w);break;case z.USER_TRANSCRIPTION:{const M=e.data;(P=(k=this._options.callbacks)==null?void 0:k.onUserTranscript)==null||P.call(k,M);break}case z.BOT_TRANSCRIPTION:(x=(I=this._options.callbacks)==null?void 0:I.onBotTranscript)==null||x.call(I,e.data);break;case z.BOT_LLM_TEXT:(q=(N=this._options.callbacks)==null?void 0:N.onBotLlmText)==null||q.call(N,e.data);break;case z.BOT_LLM_STARTED:(ye=(oe=this._options.callbacks)==null?void 0:oe.onBotLlmStarted)==null||ye.call(oe);break;case z.BOT_LLM_STOPPED:(nt=(je=this._options.callbacks)==null?void 0:je.onBotLlmStopped)==null||nt.call(je);break;case z.BOT_TTS_TEXT:(rt=(Ae=this._options.callbacks)==null?void 0:Ae.onBotTtsText)==null||rt.call(Ae,e.data);break;case z.BOT_TTS_STARTED:(kt=($e=this._options.callbacks)==null?void 0:$e.onBotTtsStarted)==null||kt.call($e);break;case z.BOT_TTS_STOPPED:(Bt=(qe=this._options.callbacks)==null?void 0:qe.onBotTtsStopped)==null||Bt.call(qe);break;case z.METRICS:this.emit(R.Metrics,e.data),(o=(ue=this._options.callbacks)==null?void 0:ue.onMetrics)==null||o.call(ue,e.data);break;case z.STORAGE_ITEM_STORED:(d=(u=this._options.callbacks)==null?void 0:u.onStorageItemStored)==null||d.call(u,e.data);break;default:{let M=!1;for(const D of Object.values(this._helpers))D.getMessageTypes().includes(e.type)&&(M=!0,D.handleMessage(e));M||(f=(g=this._options.callbacks)==null?void 0:g.onGenericMessage)==null||f.call(g,e.data)}}}registerHelper(e,n){if(this._helpers[e])throw new Error(`Helper with name '${e}' already registered`);if(!(n instanceof ir))throw new Error("Helper must be an instance of RTVIClientHelper");return n.service=e,n.client=this,this._helpers[e]=n,this._helpers[e]}getHelper(e){const n=this._helpers[e];if(!n){Y.debug(`Helper targeting service '${e}' not found`);return}return n}unregisterHelper(e){this._helpers[e]&&delete this._helpers[e]}}at([Et],De.prototype,"getConfig",null),at([Et],De.prototype,"updateConfig",null),at([Et],De.prototype,"describeConfig",null),at([Et],De.prototype,"describeActions",null),at([cc("connected","ready")],De.prototype,"transportExpiry",null),at([Et],De.prototype,"sendMessage",null),at([Et],De.prototype,"disconnectBot",null);var Bi={};te(Bi,"LLMMessageType",()=>He),te(Bi,"LLMHelper",()=>pc);var He;(function(t){t.LLM_FUNCTION_CALL="llm-function-call",t.LLM_FUNCTION_CALL_START="llm-function-call-start",t.LLM_FUNCTION_CALL_RESULT="llm-function-call-result",t.LLM_JSON_COMPLETION="llm-json-completion"})(He||(He={}));class pc extends ir{constructor(e){super(e),this._functionCallCallback=null}getMessageTypes(){return Object.values(He)}async getContext(){if(this._client.state!=="ready")throw new ze("getContext called while transport not in ready state");return(await this._client.action({service:this._service,action:"get_context"})).data.result}async setContext(e,n=!1){if(this._client.state!=="ready")throw new ze("setContext called while transport not in ready state");return!!(await this._client.action({service:this._service,action:"set_context",arguments:[{name:"messages",value:e.messages},{name:"interrupt",value:n}]})).data.result}async appendToMessages(e,n=!1){if(this._client.state!=="ready")throw new ze("setContext called while transport not in ready state");return!!(await this._client.action({service:this._service,action:"append_to_messages",arguments:[{name:"messages",value:[e]},{name:"run_immediately",value:n}]})).data.result}async run(e=!1){if(this._client.state==="ready")return this._client.action({service:this._service,action:"run",arguments:[{name:"interrupt",value:e}]})}handleFunctionCall(e){this._functionCallCallback=e}handleMessage(e){var n,r,i,s,a,l;switch(e.type){case He.LLM_JSON_COMPLETION:(r=(n=this._options.callbacks)==null?void 0:n.onLLMJsonCompletion)==null||r.call(n,e.data),this._client.emit(R.LLMJsonCompletion,e.data);break;case He.LLM_FUNCTION_CALL:{const c=e.data;if((s=(i=this._options.callbacks)==null?void 0:i.onLLMFunctionCall)==null||s.call(i,e.data),this._client.emit(R.LLMFunctionCall,e.data),this._functionCallCallback){const h={functionName:c.function_name,arguments:c.args};if(this._client.state==="ready")this._functionCallCallback(h).then(p=>{this._client.sendMessage(new se(He.LLM_FUNCTION_CALL_RESULT,{function_name:c.function_name,tool_call_id:c.tool_call_id,arguments:c.args,result:p}))});else throw new ze("Attempted to send a function call result from bot while transport not in ready state")}break}case He.LLM_FUNCTION_CALL_START:{const c=e.data;(l=(a=this._options.callbacks)==null?void 0:a.onLLMFunctionCallStart)==null||l.call(a,c.function_name),this._client.emit(R.LLMFunctionCallStart,c.function_name);break}}}}var fc={};te(fc,"Transport",()=>Fi);class Fi{constructor(){this._state="disconnected",this._expiry=void 0}get expiry(){return this._expiry}}function Ui(t,e){if(t==null)return{};var n,r,i=function(a,l){if(a==null)return{};var c,h,p={},m=Object.keys(a);for(h=0;h<m.length;h++)c=m[h],l.indexOf(c)>=0||(p[c]=a[c]);return p}(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(r=0;r<s.length;r++)n=s[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function Se(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Q(t){return Q=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Q(t)}function $i(t){var e=function(n,r){if(Q(n)!=="object"||n===null)return n;var i=n[Symbol.toPrimitive];if(i!==void 0){var s=i.call(n,r||"default");if(Q(s)!=="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(n)}(t,"string");return Q(e)==="symbol"?e:String(e)}function qi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,$i(r.key),r)}}function ke(t,e,n){return e&&qi(t.prototype,e),n&&qi(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ie(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ut(t,e){return Ut=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},Ut(t,e)}function cn(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ut(t,e)}function ln(t,e){if(e&&(Q(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ie(t)}function Ce(t){return Ce=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ce(t)}function Ne(t,e,n){return(e=$i(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ji(t,e,n,r,i,s,a){try{var l=t[s](a),c=l.value}catch(h){return void n(h)}l.done?e(c):Promise.resolve(c).then(r,i)}function U(t){return function(){var e=this,n=arguments;return new Promise(function(r,i){var s=t.apply(e,n);function a(c){Ji(s,r,i,a,l,"next",c)}function l(c){Ji(s,r,i,a,l,"throw",c)}a(void 0)})}}function Vi(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ot(t,e){return function(n){if(Array.isArray(n))return n}(t)||function(n,r){var i=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(i!=null){var s,a,l,c,h=[],p=!0,m=!1;try{if(l=(i=i.call(n)).next,r===0){if(Object(i)!==i)return;p=!1}else for(;!(p=(s=l.call(i)).done)&&(h.push(s.value),h.length!==r);p=!0);}catch(b){m=!0,a=b}finally{try{if(!p&&i.return!=null&&(c=i.return(),Object(c)!==c))return}finally{if(m)throw a}}return h}}(t,e)||function(n,r){if(n){if(typeof n=="string")return Vi(n,r);var i=Object.prototype.toString.call(n).slice(8,-1);return i==="Object"&&n.constructor&&(i=n.constructor.name),i==="Map"||i==="Set"?Array.from(n):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Vi(n,r):void 0}}(t,e)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}var Wi,Re={},mc={get exports(){return Re},set exports(t){Re=t}},Ot=typeof Reflect=="object"?Reflect:null,zi=Ot&&typeof Ot.apply=="function"?Ot.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};Wi=Ot&&typeof Ot.ownKeys=="function"?Ot.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var Gi=Number.isNaN||function(t){return t!=t};function K(){K.init.call(this)}mc.exports=K,Re.once=function(t,e){return new Promise(function(n,r){function i(a){t.removeListener(e,s),r(a)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",i),n([].slice.call(arguments))}ts(t,e,s,{once:!0}),e!=="error"&&function(a,l,c){typeof a.on=="function"&&ts(a,"error",l,c)}(t,i,{once:!0})})},K.EventEmitter=K,K.prototype._events=void 0,K.prototype._eventsCount=0,K.prototype._maxListeners=void 0;var Hi=10;function un(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function Qi(t){return t._maxListeners===void 0?K.defaultMaxListeners:t._maxListeners}function Ki(t,e,n,r){var i,s,a,l;if(un(n),(s=t._events)===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,n.listener?n.listener:n),s=t._events),a=s[e]),a===void 0)a=s[e]=n,++t._eventsCount;else if(typeof a=="function"?a=s[e]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),(i=Qi(t))>0&&a.length>i&&!a.warned){a.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=t,c.type=e,c.count=a.length,l=c,console&&console.warn&&console.warn(l)}return t}function gc(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Yi(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},i=gc.bind(r);return i.listener=n,r.wrapFn=i,i}function Xi(t,e,n){var r=t._events;if(r===void 0)return[];var i=r[e];return i===void 0?[]:typeof i=="function"?n?[i.listener||i]:[i]:n?function(s){for(var a=new Array(s.length),l=0;l<a.length;++l)a[l]=s[l].listener||s[l];return a}(i):es(i,i.length)}function Zi(t){var e=this._events;if(e!==void 0){var n=e[t];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}function es(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}function ts(t,e,n,r){if(typeof t.on=="function")r.once?t.once(e,n):t.on(e,n);else{if(typeof t.addEventListener!="function")throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,function i(s){r.once&&t.removeEventListener(e,i),n(s)})}}Object.defineProperty(K,"defaultMaxListeners",{enumerable:!0,get:function(){return Hi},set:function(t){if(typeof t!="number"||t<0||Gi(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");Hi=t}}),K.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},K.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||Gi(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},K.prototype.getMaxListeners=function(){return Qi(this)},K.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var r=t==="error",i=this._events;if(i!==void 0)r=r&&i.error===void 0;else if(!r)return!1;if(r){var s;if(e.length>0&&(s=e[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var l=i[t];if(l===void 0)return!1;if(typeof l=="function")zi(l,this,e);else{var c=l.length,h=es(l,c);for(n=0;n<c;++n)zi(h[n],this,e)}return!0},K.prototype.addListener=function(t,e){return Ki(this,t,e,!1)},K.prototype.on=K.prototype.addListener,K.prototype.prependListener=function(t,e){return Ki(this,t,e,!0)},K.prototype.once=function(t,e){return un(e),this.on(t,Yi(this,t,e)),this},K.prototype.prependOnceListener=function(t,e){return un(e),this.prependListener(t,Yi(this,t,e)),this},K.prototype.removeListener=function(t,e){var n,r,i,s,a;if(un(e),(r=this._events)===void 0)return this;if((n=r[t])===void 0)return this;if(n===e||n.listener===e)--this._eventsCount==0?this._events=Object.create(null):(delete r[t],r.removeListener&&this.emit("removeListener",t,n.listener||e));else if(typeof n!="function"){for(i=-1,s=n.length-1;s>=0;s--)if(n[s]===e||n[s].listener===e){a=n[s].listener,i=s;break}if(i<0)return this;i===0?n.shift():function(l,c){for(;c+1<l.length;c++)l[c]=l[c+1];l.pop()}(n,i),n.length===1&&(r[t]=n[0]),r.removeListener!==void 0&&this.emit("removeListener",t,a||e)}return this},K.prototype.off=K.prototype.removeListener,K.prototype.removeAllListeners=function(t){var e,n,r;if((n=this._events)===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[t]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete n[t]),this;if(arguments.length===0){var i,s=Object.keys(n);for(r=0;r<s.length;++r)(i=s[r])!=="removeListener"&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(e=n[t])=="function")this.removeListener(t,e);else if(e!==void 0)for(r=e.length-1;r>=0;r--)this.removeListener(t,e[r]);return this},K.prototype.listeners=function(t){return Xi(this,t,!0)},K.prototype.rawListeners=function(t){return Xi(this,t,!1)},K.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):Zi.call(t,e)},K.prototype.listenerCount=Zi,K.prototype.eventNames=function(){return this._eventsCount>0?Wi(this._events):[]};var ns=Object.prototype.hasOwnProperty;function rs(t,e,n){for(n of t.keys())if(pe(n,e))return n}function pe(t,e){var n,r,i;if(t===e)return!0;if(t&&e&&(n=t.constructor)===e.constructor){if(n===Date)return t.getTime()===e.getTime();if(n===RegExp)return t.toString()===e.toString();if(n===Array){if((r=t.length)===e.length)for(;r--&&pe(t[r],e[r]););return r===-1}if(n===Set){if(t.size!==e.size)return!1;for(r of t)if((i=r)&&typeof i=="object"&&!(i=rs(e,i))||!e.has(i))return!1;return!0}if(n===Map){if(t.size!==e.size)return!1;for(r of t)if((i=r[0])&&typeof i=="object"&&!(i=rs(e,i))||!pe(r[1],e.get(i)))return!1;return!0}if(n===ArrayBuffer)t=new Uint8Array(t),e=new Uint8Array(e);else if(n===DataView){if((r=t.byteLength)===e.byteLength)for(;r--&&t.getInt8(r)===e.getInt8(r););return r===-1}if(ArrayBuffer.isView(t)){if((r=t.byteLength)===e.byteLength)for(;r--&&t[r]===e[r];);return r===-1}if(!n||typeof t=="object"){for(n in r=0,t)if(ns.call(t,n)&&++r&&!ns.call(e,n)||!(n in e)||!pe(t[n],e[n]))return!1;return Object.keys(e).length===r}}return t!=t&&e!=e}const vc={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},is={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},re={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},he={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},Qe={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"};class O{static getFirstMatch(e,n){const r=n.match(e);return r&&r.length>0&&r[1]||""}static getSecondMatch(e,n){const r=n.match(e);return r&&r.length>1&&r[2]||""}static matchAndReturnConst(e,n,r){if(e.test(n))return r}static getWindowsVersionName(e){switch(e){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}static getMacOSVersionName(e){const n=e.split(".").splice(0,2).map(r=>parseInt(r,10)||0);if(n.push(0),n[0]===10)switch(n[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}}static getAndroidVersionName(e){const n=e.split(".").splice(0,2).map(r=>parseInt(r,10)||0);if(n.push(0),!(n[0]===1&&n[1]<5))return n[0]===1&&n[1]<6?"Cupcake":n[0]===1&&n[1]>=6?"Donut":n[0]===2&&n[1]<2?"Eclair":n[0]===2&&n[1]===2?"Froyo":n[0]===2&&n[1]>2?"Gingerbread":n[0]===3?"Honeycomb":n[0]===4&&n[1]<1?"Ice Cream Sandwich":n[0]===4&&n[1]<4?"Jelly Bean":n[0]===4&&n[1]>=4?"KitKat":n[0]===5?"Lollipop":n[0]===6?"Marshmallow":n[0]===7?"Nougat":n[0]===8?"Oreo":n[0]===9?"Pie":void 0}static getVersionPrecision(e){return e.split(".").length}static compareVersions(e,n,r=!1){const i=O.getVersionPrecision(e),s=O.getVersionPrecision(n);let a=Math.max(i,s),l=0;const c=O.map([e,n],h=>{const p=a-O.getVersionPrecision(h),m=h+new Array(p+1).join(".0");return O.map(m.split("."),b=>new Array(20-b.length).join("0")+b).reverse()});for(r&&(l=a-Math.min(i,s)),a-=1;a>=l;){if(c[0][a]>c[1][a])return 1;if(c[0][a]===c[1][a]){if(a===l)return 0;a-=1}else if(c[0][a]<c[1][a])return-1}}static map(e,n){const r=[];let i;if(Array.prototype.map)return Array.prototype.map.call(e,n);for(i=0;i<e.length;i+=1)r.push(n(e[i]));return r}static find(e,n){let r,i;if(Array.prototype.find)return Array.prototype.find.call(e,n);for(r=0,i=e.length;r<i;r+=1){const s=e[r];if(n(s,r))return s}}static assign(e,...n){const r=e;let i,s;if(Object.assign)return Object.assign(e,...n);for(i=0,s=n.length;i<s;i+=1){const a=n[i];typeof a=="object"&&a!==null&&Object.keys(a).forEach(l=>{r[l]=a[l]})}return e}static getBrowserAlias(e){return vc[e]}static getBrowserTypeByAlias(e){return is[e]||""}}const X=/version\/(\d+(\.?_?\d+)+)/i,yc=[{test:[/googlebot/i],describe(t){const e={name:"Googlebot"},n=O.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,t)||O.getFirstMatch(X,t);return n&&(e.version=n),e}},{test:[/opera/i],describe(t){const e={name:"Opera"},n=O.getFirstMatch(X,t)||O.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/opr\/|opios/i],describe(t){const e={name:"Opera"},n=O.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,t)||O.getFirstMatch(X,t);return n&&(e.version=n),e}},{test:[/SamsungBrowser/i],describe(t){const e={name:"Samsung Internet for Android"},n=O.getFirstMatch(X,t)||O.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/Whale/i],describe(t){const e={name:"NAVER Whale Browser"},n=O.getFirstMatch(X,t)||O.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/MZBrowser/i],describe(t){const e={name:"MZ Browser"},n=O.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,t)||O.getFirstMatch(X,t);return n&&(e.version=n),e}},{test:[/focus/i],describe(t){const e={name:"Focus"},n=O.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,t)||O.getFirstMatch(X,t);return n&&(e.version=n),e}},{test:[/swing/i],describe(t){const e={name:"Swing"},n=O.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,t)||O.getFirstMatch(X,t);return n&&(e.version=n),e}},{test:[/coast/i],describe(t){const e={name:"Opera Coast"},n=O.getFirstMatch(X,t)||O.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe(t){const e={name:"Opera Touch"},n=O.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,t)||O.getFirstMatch(X,t);return n&&(e.version=n),e}},{test:[/yabrowser/i],describe(t){const e={name:"Yandex Browser"},n=O.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,t)||O.getFirstMatch(X,t);return n&&(e.version=n),e}},{test:[/ucbrowser/i],describe(t){const e={name:"UC Browser"},n=O.getFirstMatch(X,t)||O.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/Maxthon|mxios/i],describe(t){const e={name:"Maxthon"},n=O.getFirstMatch(X,t)||O.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/epiphany/i],describe(t){const e={name:"Epiphany"},n=O.getFirstMatch(X,t)||O.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/puffin/i],describe(t){const e={name:"Puffin"},n=O.getFirstMatch(X,t)||O.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/sleipnir/i],describe(t){const e={name:"Sleipnir"},n=O.getFirstMatch(X,t)||O.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/k-meleon/i],describe(t){const e={name:"K-Meleon"},n=O.getFirstMatch(X,t)||O.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/micromessenger/i],describe(t){const e={name:"WeChat"},n=O.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,t)||O.getFirstMatch(X,t);return n&&(e.version=n),e}},{test:[/qqbrowser/i],describe(t){const e={name:/qqbrowserlite/i.test(t)?"QQ Browser Lite":"QQ Browser"},n=O.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,t)||O.getFirstMatch(X,t);return n&&(e.version=n),e}},{test:[/msie|trident/i],describe(t){const e={name:"Internet Explorer"},n=O.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/\sedg\//i],describe(t){const e={name:"Microsoft Edge"},n=O.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/edg([ea]|ios)/i],describe(t){const e={name:"Microsoft Edge"},n=O.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/vivaldi/i],describe(t){const e={name:"Vivaldi"},n=O.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/seamonkey/i],describe(t){const e={name:"SeaMonkey"},n=O.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/sailfish/i],describe(t){const e={name:"Sailfish"},n=O.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,t);return n&&(e.version=n),e}},{test:[/silk/i],describe(t){const e={name:"Amazon Silk"},n=O.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/phantom/i],describe(t){const e={name:"PhantomJS"},n=O.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/slimerjs/i],describe(t){const e={name:"SlimerJS"},n=O.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(t){const e={name:"BlackBerry"},n=O.getFirstMatch(X,t)||O.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/(web|hpw)[o0]s/i],describe(t){const e={name:"WebOS Browser"},n=O.getFirstMatch(X,t)||O.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/bada/i],describe(t){const e={name:"Bada"},n=O.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/tizen/i],describe(t){const e={name:"Tizen"},n=O.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,t)||O.getFirstMatch(X,t);return n&&(e.version=n),e}},{test:[/qupzilla/i],describe(t){const e={name:"QupZilla"},n=O.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,t)||O.getFirstMatch(X,t);return n&&(e.version=n),e}},{test:[/firefox|iceweasel|fxios/i],describe(t){const e={name:"Firefox"},n=O.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/electron/i],describe(t){const e={name:"Electron"},n=O.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/MiuiBrowser/i],describe(t){const e={name:"Miui"},n=O.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/chromium/i],describe(t){const e={name:"Chromium"},n=O.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,t)||O.getFirstMatch(X,t);return n&&(e.version=n),e}},{test:[/chrome|crios|crmo/i],describe(t){const e={name:"Chrome"},n=O.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/GSA/i],describe(t){const e={name:"Google Search"},n=O.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test(t){const e=!t.test(/like android/i),n=t.test(/android/i);return e&&n},describe(t){const e={name:"Android Browser"},n=O.getFirstMatch(X,t);return n&&(e.version=n),e}},{test:[/playstation 4/i],describe(t){const e={name:"PlayStation 4"},n=O.getFirstMatch(X,t);return n&&(e.version=n),e}},{test:[/safari|applewebkit/i],describe(t){const e={name:"Safari"},n=O.getFirstMatch(X,t);return n&&(e.version=n),e}},{test:[/.*/i],describe(t){const e=t.search("\\(")!==-1?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:O.getFirstMatch(e,t),version:O.getSecondMatch(e,t)}}}];var bc=[{test:[/Roku\/DVP/],describe(t){const e=O.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,t);return{name:he.Roku,version:e}}},{test:[/windows phone/i],describe(t){const e=O.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,t);return{name:he.WindowsPhone,version:e}}},{test:[/windows /i],describe(t){const e=O.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,t),n=O.getWindowsVersionName(e);return{name:he.Windows,version:e,versionName:n}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe(t){const e={name:he.iOS},n=O.getSecondMatch(/(Version\/)(\d[\d.]+)/,t);return n&&(e.version=n),e}},{test:[/macintosh/i],describe(t){const e=O.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,t).replace(/[_\s]/g,"."),n=O.getMacOSVersionName(e),r={name:he.MacOS,version:e};return n&&(r.versionName=n),r}},{test:[/(ipod|iphone|ipad)/i],describe(t){const e=O.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,t).replace(/[_\s]/g,".");return{name:he.iOS,version:e}}},{test(t){const e=!t.test(/like android/i),n=t.test(/android/i);return e&&n},describe(t){const e=O.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,t),n=O.getAndroidVersionName(e),r={name:he.Android,version:e};return n&&(r.versionName=n),r}},{test:[/(web|hpw)[o0]s/i],describe(t){const e=O.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,t),n={name:he.WebOS};return e&&e.length&&(n.version=e),n}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(t){const e=O.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,t)||O.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,t)||O.getFirstMatch(/\bbb(\d+)/i,t);return{name:he.BlackBerry,version:e}}},{test:[/bada/i],describe(t){const e=O.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,t);return{name:he.Bada,version:e}}},{test:[/tizen/i],describe(t){const e=O.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,t);return{name:he.Tizen,version:e}}},{test:[/linux/i],describe:()=>({name:he.Linux})},{test:[/CrOS/],describe:()=>({name:he.ChromeOS})},{test:[/PlayStation 4/],describe(t){const e=O.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,t);return{name:he.PlayStation4,version:e}}}],_c=[{test:[/googlebot/i],describe:()=>({type:"bot",vendor:"Google"})},{test:[/huawei/i],describe(t){const e=O.getFirstMatch(/(can-l01)/i,t)&&"Nova",n={type:re.mobile,vendor:"Huawei"};return e&&(n.model=e),n}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:()=>({type:re.tablet,vendor:"Nexus"})},{test:[/ipad/i],describe:()=>({type:re.tablet,vendor:"Apple",model:"iPad"})},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:()=>({type:re.tablet,vendor:"Apple",model:"iPad"})},{test:[/kftt build/i],describe:()=>({type:re.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"})},{test:[/silk/i],describe:()=>({type:re.tablet,vendor:"Amazon"})},{test:[/tablet(?! pc)/i],describe:()=>({type:re.tablet})},{test(t){const e=t.test(/ipod|iphone/i),n=t.test(/like (ipod|iphone)/i);return e&&!n},describe(t){const e=O.getFirstMatch(/(ipod|iphone)/i,t);return{type:re.mobile,vendor:"Apple",model:e}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:()=>({type:re.mobile,vendor:"Nexus"})},{test:[/[^-]mobi/i],describe:()=>({type:re.mobile})},{test:t=>t.getBrowserName(!0)==="blackberry",describe:()=>({type:re.mobile,vendor:"BlackBerry"})},{test:t=>t.getBrowserName(!0)==="bada",describe:()=>({type:re.mobile})},{test:t=>t.getBrowserName()==="windows phone",describe:()=>({type:re.mobile,vendor:"Microsoft"})},{test(t){const e=Number(String(t.getOSVersion()).split(".")[0]);return t.getOSName(!0)==="android"&&e>=3},describe:()=>({type:re.tablet})},{test:t=>t.getOSName(!0)==="android",describe:()=>({type:re.mobile})},{test:t=>t.getOSName(!0)==="macos",describe:()=>({type:re.desktop,vendor:"Apple"})},{test:t=>t.getOSName(!0)==="windows",describe:()=>({type:re.desktop})},{test:t=>t.getOSName(!0)==="linux",describe:()=>({type:re.desktop})},{test:t=>t.getOSName(!0)==="playstation 4",describe:()=>({type:re.tv})},{test:t=>t.getOSName(!0)==="roku",describe:()=>({type:re.tv})}],wc=[{test:t=>t.getBrowserName(!0)==="microsoft edge",describe(t){if(/\sedg\//i.test(t))return{name:Qe.Blink};const e=O.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,t);return{name:Qe.EdgeHTML,version:e}}},{test:[/trident/i],describe(t){const e={name:Qe.Trident},n=O.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:t=>t.test(/presto/i),describe(t){const e={name:Qe.Presto},n=O.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test(t){const e=t.test(/gecko/i),n=t.test(/like gecko/i);return e&&!n},describe(t){const e={name:Qe.Gecko},n=O.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/(apple)?webkit\/537\.36/i],describe:()=>({name:Qe.Blink})},{test:[/(apple)?webkit/i],describe(t){const e={name:Qe.WebKit},n=O.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}}];class ss{constructor(e,n=!1){if(e==null||e==="")throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},n!==!0&&this.parse()}getUA(){return this._ua}test(e){return e.test(this._ua)}parseBrowser(){this.parsedResult.browser={};const e=O.find(yc,n=>{if(typeof n.test=="function")return n.test(this);if(n.test instanceof Array)return n.test.some(r=>this.test(r));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.browser=e.describe(this.getUA())),this.parsedResult.browser}getBrowser(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()}getBrowserName(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""}getBrowserVersion(){return this.getBrowser().version}getOS(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()}parseOS(){this.parsedResult.os={};const e=O.find(bc,n=>{if(typeof n.test=="function")return n.test(this);if(n.test instanceof Array)return n.test.some(r=>this.test(r));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.os=e.describe(this.getUA())),this.parsedResult.os}getOSName(e){const{name:n}=this.getOS();return e?String(n).toLowerCase()||"":n||""}getOSVersion(){return this.getOS().version}getPlatform(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()}getPlatformType(e=!1){const{type:n}=this.getPlatform();return e?String(n).toLowerCase()||"":n||""}parsePlatform(){this.parsedResult.platform={};const e=O.find(_c,n=>{if(typeof n.test=="function")return n.test(this);if(n.test instanceof Array)return n.test.some(r=>this.test(r));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.platform=e.describe(this.getUA())),this.parsedResult.platform}getEngine(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()}getEngineName(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""}parseEngine(){this.parsedResult.engine={};const e=O.find(wc,n=>{if(typeof n.test=="function")return n.test(this);if(n.test instanceof Array)return n.test.some(r=>this.test(r));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.engine=e.describe(this.getUA())),this.parsedResult.engine}parse(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this}getResult(){return O.assign({},this.parsedResult)}satisfies(e){const n={};let r=0;const i={};let s=0;if(Object.keys(e).forEach(a=>{const l=e[a];typeof l=="string"?(i[a]=l,s+=1):typeof l=="object"&&(n[a]=l,r+=1)}),r>0){const a=Object.keys(n),l=O.find(a,h=>this.isOS(h));if(l){const h=this.satisfies(n[l]);if(h!==void 0)return h}const c=O.find(a,h=>this.isPlatform(h));if(c){const h=this.satisfies(n[c]);if(h!==void 0)return h}}if(s>0){const a=Object.keys(i),l=O.find(a,c=>this.isBrowser(c,!0));if(l!==void 0)return this.compareVersion(i[l])}}isBrowser(e,n=!1){const r=this.getBrowserName().toLowerCase();let i=e.toLowerCase();const s=O.getBrowserTypeByAlias(i);return n&&s&&(i=s.toLowerCase()),i===r}compareVersion(e){let n=[0],r=e,i=!1;const s=this.getBrowserVersion();if(typeof s=="string")return e[0]===">"||e[0]==="<"?(r=e.substr(1),e[1]==="="?(i=!0,r=e.substr(2)):n=[],e[0]===">"?n.push(1):n.push(-1)):e[0]==="="?r=e.substr(1):e[0]==="~"&&(i=!0,r=e.substr(1)),n.indexOf(O.compareVersions(s,r,i))>-1}isOS(e){return this.getOSName(!0)===String(e).toLowerCase()}isPlatform(e){return this.getPlatformType(!0)===String(e).toLowerCase()}isEngine(e){return this.getEngineName(!0)===String(e).toLowerCase()}is(e,n=!1){return this.isBrowser(e,n)||this.isOS(e)||this.isPlatform(e)}some(e=[]){return e.some(n=>this.is(n))}}/*!
 * Bowser - a browser detector
 * https://github.com/lancedikson/bowser
 * MIT License | (c) Dustin Diaz 2012-2015
 * MIT License | (c) Denis Demchenko 2015-2019
 */class Sc{static getParser(e,n=!1){if(typeof e!="string")throw new Error("UserAgent should be a string");return new ss(e,n)}static parse(e){return new ss(e).getResult()}static get BROWSER_MAP(){return is}static get ENGINE_MAP(){return Qe}static get OS_MAP(){return he}static get PLATFORMS_MAP(){return re}}function dn(){return Date.now()+Math.random().toString()}function $t(){throw new Error("Method must be implemented in subclass")}function as(t,e){return e!=null&&e.proxyUrl?e.proxyUrl+(e.proxyUrl.slice(-1)==="/"?"":"/")+t.substring(8):t}function hn(t){return t!=null&&t.callObjectBundleUrlOverride?t.callObjectBundleUrlOverride:as("https://c.daily.co/call-machine/versioned/".concat("0.73.0","/static/call-machine-object-bundle.js"),t)}function pn(t){try{new URL(t)}catch{return!1}return!0}const os=Object.prototype.toString;function sr(t){switch(os.call(t)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return ct(t,Error)}}function At(t,e){return os.call(t)===`[object ${e}]`}function cs(t){return At(t,"ErrorEvent")}function ls(t){return At(t,"DOMError")}function Be(t){return At(t,"String")}function ar(t){return typeof t=="object"&&t!==null&&"__sentry_template_string__"in t&&"__sentry_template_values__"in t}function or(t){return t===null||ar(t)||typeof t!="object"&&typeof t!="function"}function xt(t){return At(t,"Object")}function fn(t){return typeof Event<"u"&&ct(t,Event)}function mn(t){return!!(t&&t.then&&typeof t.then=="function")}function ct(t,e){try{return t instanceof e}catch{return!1}}function us(t){return!(typeof t!="object"||t===null||!t.__isVue&&!t._isVue)}function Pt(t,e=0){return typeof t!="string"||e===0||t.length<=e?t:`${t.slice(0,e)}...`}function ds(t,e){if(!Array.isArray(t))return"";const n=[];for(let r=0;r<t.length;r++){const i=t[r];try{us(i)?n.push("[VueViewModel]"):n.push(String(i))}catch{n.push("[value cannot be serialized]")}}return n.join(e)}function kc(t,e,n=!1){return!!Be(t)&&(At(e,"RegExp")?e.test(t):!!Be(e)&&(n?t===e:t.includes(e)))}function gn(t,e=[],n=!1){return e.some(r=>kc(t,r,n))}function Cc(t,e,n=250,r,i,s,a){if(!(s.exception&&s.exception.values&&a&&ct(a.originalException,Error)))return;const l=s.exception.values.length>0?s.exception.values[s.exception.values.length-1]:void 0;var c,h;l&&(s.exception.values=(c=cr(t,e,i,a.originalException,r,s.exception.values,l,0),h=n,c.map(p=>(p.value&&(p.value=Pt(p.value,h)),p))))}function cr(t,e,n,r,i,s,a,l){if(s.length>=n+1)return s;let c=[...s];if(ct(r[i],Error)){hs(a,l);const h=t(e,r[i]),p=c.length;ps(h,i,p,l),c=cr(t,e,n,r[i],i,[h,...c],h,p)}return Array.isArray(r.errors)&&r.errors.forEach((h,p)=>{if(ct(h,Error)){hs(a,l);const m=t(e,h),b=c.length;ps(m,`errors[${p}]`,b,l),c=cr(t,e,n,h,i,[m,...c],m,b)}}),c}function hs(t,e){t.mechanism=t.mechanism||{type:"generic",handled:!0},t.mechanism={...t.mechanism,...t.type==="AggregateError"&&{is_exception_group:!0},exception_id:e}}function ps(t,e,n,r){t.mechanism=t.mechanism||{type:"generic",handled:!0},t.mechanism={...t.mechanism,type:"chained",source:e,exception_id:n,parent_id:r}}function fs(t){return t===void 0?void 0:t>=400&&t<500?"warning":t>=500?"error":void 0}const lt="8.33.1",G=globalThis;function vn(t,e,n){const r=G,i=r.__SENTRY__=r.__SENTRY__||{},s=i[lt]=i[lt]||{};return s[t]||(s[t]=e())}const lr=G;function ms(t,e={}){if(!t)return"<unknown>";try{let n=t;const r=5,i=[];let s=0,a=0;const l=" > ",c=l.length;let h;const p=Array.isArray(e)?e:e.keyAttrs,m=!Array.isArray(e)&&e.maxStringLength||80;for(;n&&s++<r&&(h=Ec(n,p),!(h==="html"||s>1&&a+i.length*c+h.length>=m));)i.push(h),a+=h.length,n=n.parentNode;return i.reverse().join(l)}catch{return"<unknown>"}}function Ec(t,e){const n=t,r=[];if(!n||!n.tagName)return"";if(lr.HTMLElement&&n instanceof HTMLElement&&n.dataset){if(n.dataset.sentryComponent)return n.dataset.sentryComponent;if(n.dataset.sentryElement)return n.dataset.sentryElement}r.push(n.tagName.toLowerCase());const i=e&&e.length?e.filter(a=>n.getAttribute(a)).map(a=>[a,n.getAttribute(a)]):null;if(i&&i.length)i.forEach(a=>{r.push(`[${a[0]}="${a[1]}"]`)});else{n.id&&r.push(`#${n.id}`);const a=n.className;if(a&&Be(a)){const l=a.split(/\s+/);for(const c of l)r.push(`.${c}`)}}const s=["aria-label","type","name","title","alt"];for(const a of s){const l=n.getAttribute(a);l&&r.push(`[${a}="${l}"]`)}return r.join("")}const qt=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,ur=["debug","info","warn","error","log","assert","trace"],yn={};function dr(t){if(!("console"in G))return t();const e=G.console,n={},r=Object.keys(yn);r.forEach(i=>{const s=yn[i];n[i]=e[i],e[i]=s});try{return t()}finally{r.forEach(i=>{e[i]=n[i]})}}const J=vn("logger",function(){let t=!1;const e={enable:()=>{t=!0},disable:()=>{t=!1},isEnabled:()=>t};return qt?ur.forEach(n=>{e[n]=(...r)=>{t&&dr(()=>{G.console[n](`Sentry Logger [${n}]:`,...r)})}}):ur.forEach(n=>{e[n]=()=>{}}),e}),Mc=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function bn(t,e=!1){const{host:n,path:r,pass:i,port:s,projectId:a,protocol:l,publicKey:c}=t;return`${l}://${c}${e&&i?`:${i}`:""}@${n}${s?`:${s}`:""}/${r&&`${r}/`}${a}`}function gs(t){return{protocol:t.protocol,publicKey:t.publicKey||"",pass:t.pass||"",host:t.host,port:t.port||"",path:t.path||"",projectId:t.projectId}}function Tc(t){const e=typeof t=="string"?function(n){const r=Mc.exec(n);if(!r)return void dr(()=>{console.error(`Invalid Sentry Dsn: ${n}`)});const[i,s,a="",l="",c="",h=""]=r.slice(1);let p="",m=h;const b=m.split("/");if(b.length>1&&(p=b.slice(0,-1).join("/"),m=b.pop()),m){const v=m.match(/^\d+/);v&&(m=v[0])}return gs({host:l,pass:a,path:p,projectId:m,port:c,protocol:i,publicKey:s})}(t):gs(t);if(e&&function(n){if(!qt)return!0;const{port:r,projectId:i,protocol:s}=n;return!(["protocol","publicKey","host","projectId"].find(a=>!n[a]&&(J.error(`Invalid Sentry Dsn: ${a} missing`),!0))||(i.match(/^\d+$/)?function(a){return a==="http"||a==="https"}(s)?r&&isNaN(parseInt(r,10))&&(J.error(`Invalid Sentry Dsn: Invalid port ${r}`),1):(J.error(`Invalid Sentry Dsn: Invalid protocol ${s}`),1):(J.error(`Invalid Sentry Dsn: Invalid projectId ${i}`),1)))}(e))return e}class xe extends Error{constructor(e,n="warn"){super(e),this.message=e,this.name=new.target.prototype.constructor.name,Object.setPrototypeOf(this,new.target.prototype),this.logLevel=n}}function ge(t,e,n){if(!(e in t))return;const r=t[e],i=n(r);typeof i=="function"&&vs(i,r),t[e]=i}function ut(t,e,n){try{Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0})}catch{qt&&J.log(`Failed to add non-enumerable property "${e}" to object`,t)}}function vs(t,e){try{const n=e.prototype||{};t.prototype=e.prototype=n,ut(t,"__sentry_original__",e)}catch{}}function hr(t){return t.__sentry_original__}function ys(t){if(sr(t))return{message:t.message,name:t.name,stack:t.stack,..._s(t)};if(fn(t)){const e={type:t.type,target:bs(t.target),currentTarget:bs(t.currentTarget),..._s(t)};return typeof CustomEvent<"u"&&ct(t,CustomEvent)&&(e.detail=t.detail),e}return t}function bs(t){try{return e=t,typeof Element<"u"&&ct(e,Element)?ms(t):Object.prototype.toString.call(t)}catch{return"<unknown>"}var e}function _s(t){if(typeof t=="object"&&t!==null){const e={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}return{}}function Ee(t){return pr(t,new Map)}function pr(t,e){if(function(n){if(!xt(n))return!1;try{const r=Object.getPrototypeOf(n).constructor.name;return!r||r==="Object"}catch{return!0}}(t)){const n=e.get(t);if(n!==void 0)return n;const r={};e.set(t,r);for(const i of Object.getOwnPropertyNames(t))t[i]!==void 0&&(r[i]=pr(t[i],e));return r}if(Array.isArray(t)){const n=e.get(t);if(n!==void 0)return n;const r=[];return e.set(t,r),t.forEach(i=>{r.push(pr(i,e))}),r}return t}const dt="?",ws=/\(error: (.*)\)/,Ss=/captureMessage|captureException/;function _n(t){return t[t.length-1]||{}}const ks="<anonymous>";function Ke(t){try{return t&&typeof t=="function"&&t.name||ks}catch{return ks}}function Cs(t){const e=t.exception;if(e){const n=[];try{return e.values.forEach(r=>{r.stacktrace.frames&&n.push(...r.stacktrace.frames)}),n}catch{return}}}const wn={},Es={};function ht(t,e){wn[t]=wn[t]||[],wn[t].push(e)}function pt(t,e){Es[t]||(e(),Es[t]=!0)}function Me(t,e){const n=t&&wn[t];if(n)for(const r of n)try{r(e)}catch(i){qt&&J.error(`Error while triggering instrumentation handler.
Type: ${t}
Name: ${Ke(r)}
Error:`,i)}}function Oc(){"console"in G&&ur.forEach(function(t){t in G.console&&ge(G.console,t,function(e){return yn[t]=e,function(...n){Me("console",{args:n,level:t});const r=yn[t];r&&r.apply(G.console,n)}})})}const fr=G;function mr(t){return t&&/^function\s+\w+\(\)\s+\{\s+\[native code\]\s+\}$/.test(t.toString())}function Ac(){if(typeof EdgeRuntime=="string")return!0;if(!function(){if(!("fetch"in fr))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch{return!1}}())return!1;if(mr(fr.fetch))return!0;let t=!1;const e=fr.document;if(e&&typeof e.createElement=="function")try{const n=e.createElement("iframe");n.hidden=!0,e.head.appendChild(n),n.contentWindow&&n.contentWindow.fetch&&(t=mr(n.contentWindow.fetch)),e.head.removeChild(n)}catch(n){qt&&J.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",n)}return t}function Jt(){return Date.now()/1e3}const Ye=function(){const{performance:t}=G;if(!t||!t.now)return Jt;const e=Date.now()-t.now(),n=t.timeOrigin==null?e:t.timeOrigin;return()=>(n+t.now())/1e3}();function xc(t,e){const n="fetch";ht(n,t),pt(n,()=>function(r,i=!1){i&&!Ac()||ge(G,"fetch",function(s){return function(...a){const{method:l,url:c}=function(m){if(m.length===0)return{method:"GET",url:""};if(m.length===2){const[v,_]=m;return{url:Ms(v),method:gr(_,"method")?String(_.method).toUpperCase():"GET"}}const b=m[0];return{url:Ms(b),method:gr(b,"method")?String(b.method).toUpperCase():"GET"}}(a),h={args:a,fetchData:{method:l,url:c},startTimestamp:1e3*Ye()};Me("fetch",{...h});const p=new Error().stack;return s.apply(G,a).then(async m=>(Me("fetch",{...h,endTimestamp:1e3*Ye(),response:m}),m),m=>{throw Me("fetch",{...h,endTimestamp:1e3*Ye(),error:m}),sr(m)&&m.stack===void 0&&(m.stack=p,ut(m,"framesToPop",1)),m})}})}(void 0,e))}function gr(t,e){return!!t&&typeof t=="object"&&!!t[e]}function Ms(t){return typeof t=="string"?t:t?gr(t,"url")?t.url:t.toString?t.toString():"":""}(()=>{const{performance:t}=G;if(!t||!t.now)return;const e=36e5,n=t.now(),r=Date.now(),i=t.timeOrigin?Math.abs(t.timeOrigin+n-r):e,s=i<e,a=t.timing&&t.timing.navigationStart,l=typeof a=="number"?Math.abs(a+n-r):e;(s||l<e)&&i<=l&&t.timeOrigin})();let Sn=null;function Pc(){Sn=G.onerror,G.onerror=function(t,e,n,r,i){return Me("error",{column:r,error:i,line:n,msg:t,url:e}),!(!Sn||Sn.__SENTRY_LOADER__)&&Sn.apply(this,arguments)},G.onerror.__SENTRY_INSTRUMENTED__=!0}let kn=null;function Lc(){kn=G.onunhandledrejection,G.onunhandledrejection=function(t){return Me("unhandledrejection",t),!(kn&&!kn.__SENTRY_LOADER__)||kn.apply(this,arguments)},G.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}function Te(){const t=G,e=t.crypto||t.msCrypto;let n=()=>16*Math.random();try{if(e&&e.randomUUID)return e.randomUUID().replace(/-/g,"");e&&e.getRandomValues&&(n=()=>{const r=new Uint8Array(1);return e.getRandomValues(r),r[0]})}catch{}return("10000000100040008000"+1e11).replace(/[018]/g,r=>(r^(15&n())>>r/4).toString(16))}function Ts(t){return t.exception&&t.exception.values?t.exception.values[0]:void 0}function Xe(t){const{message:e,event_id:n}=t;if(e)return e;const r=Ts(t);return r?r.type&&r.value?`${r.type}: ${r.value}`:r.type||r.value||n||"<unknown>":n||"<unknown>"}function vr(t,e,n){const r=t.exception=t.exception||{},i=r.values=r.values||[],s=i[0]=i[0]||{};s.value||(s.value=e||""),s.type||(s.type="Error")}function Vt(t,e){const n=Ts(t);if(!n)return;const r=n.mechanism;if(n.mechanism={type:"generic",handled:!0,...r,...e},e&&"data"in e){const i={...r&&r.data,...e.data};n.mechanism.data=i}}function Os(t){if(t&&t.__sentry_captured__)return!0;try{ut(t,"__sentry_captured__",!0)}catch{}return!1}function Ze(t,e=100,n=1/0){try{return yr("",t,e,n)}catch(r){return{ERROR:`**non-serializable** (${r})`}}}function As(t,e=3,n=102400){const r=Ze(t,e);return i=r,function(s){return~-encodeURI(s).split(/%..|./).length}(JSON.stringify(i))>n?As(t,e-1,n):r;var i}function yr(t,e,n=1/0,r=1/0,i=function(){const s=typeof WeakSet=="function",a=s?new WeakSet:[];return[function(l){if(s)return!!a.has(l)||(a.add(l),!1);for(let c=0;c<a.length;c++)if(a[c]===l)return!0;return a.push(l),!1},function(l){if(s)a.delete(l);else for(let c=0;c<a.length;c++)if(a[c]===l){a.splice(c,1);break}}]}()){const[s,a]=i;if(e==null||["boolean","string"].includes(typeof e)||typeof e=="number"&&Number.isFinite(e))return e;const l=function(v,_){try{if(v==="domain"&&_&&typeof _=="object"&&_._events)return"[Domain]";if(v==="domainEmitter")return"[DomainEmitter]";if(typeof global<"u"&&_===global)return"[Global]";if(typeof window<"u"&&_===window)return"[Window]";if(typeof document<"u"&&_===document)return"[Document]";if(us(_))return"[VueViewModel]";if(xt(S=_)&&"nativeEvent"in S&&"preventDefault"in S&&"stopPropagation"in S)return"[SyntheticEvent]";if(typeof _=="number"&&!Number.isFinite(_))return`[${_}]`;if(typeof _=="function")return`[Function: ${Ke(_)}]`;if(typeof _=="symbol")return`[${String(_)}]`;if(typeof _=="bigint")return`[BigInt: ${String(_)}]`;const L=function(C){const T=Object.getPrototypeOf(C);return T?T.constructor.name:"null prototype"}(_);return/^HTML(\w*)Element$/.test(L)?`[HTMLElement: ${L}]`:`[object ${L}]`}catch(L){return`**non-serializable** (${L})`}var S}(t,e);if(!l.startsWith("[object "))return l;if(e.__sentry_skip_normalization__)return e;const c=typeof e.__sentry_override_normalization_depth__=="number"?e.__sentry_override_normalization_depth__:n;if(c===0)return l.replace("object ","");if(s(e))return"[Circular ~]";const h=e;if(h&&typeof h.toJSON=="function")try{return yr("",h.toJSON(),c-1,r,i)}catch{}const p=Array.isArray(e)?[]:{};let m=0;const b=ys(e);for(const v in b){if(!Object.prototype.hasOwnProperty.call(b,v))continue;if(m>=r){p[v]="[MaxProperties ~]";break}const _=b[v];p[v]=yr(v,_,c-1,r,i),m++}return a(e),p}var Fe;function ft(t){return new _e(e=>{e(t)})}function Cn(t){return new _e((e,n)=>{n(t)})}(function(t){t[t.PENDING=0]="PENDING",t[t.RESOLVED=1]="RESOLVED",t[t.REJECTED=2]="REJECTED"})(Fe||(Fe={}));class _e{constructor(e){_e.prototype.__init.call(this),_e.prototype.__init2.call(this),_e.prototype.__init3.call(this),_e.prototype.__init4.call(this),this._state=Fe.PENDING,this._handlers=[];try{e(this._resolve,this._reject)}catch(n){this._reject(n)}}then(e,n){return new _e((r,i)=>{this._handlers.push([!1,s=>{if(e)try{r(e(s))}catch(a){i(a)}else r(s)},s=>{if(n)try{r(n(s))}catch(a){i(a)}else i(s)}]),this._executeHandlers()})}catch(e){return this.then(n=>n,e)}finally(e){return new _e((n,r)=>{let i,s;return this.then(a=>{s=!1,i=a,e&&e()},a=>{s=!0,i=a,e&&e()}).then(()=>{s?r(i):n(i)})})}__init(){this._resolve=e=>{this._setResult(Fe.RESOLVED,e)}}__init2(){this._reject=e=>{this._setResult(Fe.REJECTED,e)}}__init3(){this._setResult=(e,n)=>{this._state===Fe.PENDING&&(mn(n)?n.then(this._resolve,this._reject):(this._state=e,this._value=n,this._executeHandlers()))}}__init4(){this._executeHandlers=()=>{if(this._state===Fe.PENDING)return;const e=this._handlers.slice();this._handlers=[],e.forEach(n=>{n[0]||(this._state===Fe.RESOLVED&&n[1](this._value),this._state===Fe.REJECTED&&n[2](this._value),n[0]=!0)})}}}function jc(t){const e=[];function n(r){return e.splice(e.indexOf(r),1)[0]||Promise.resolve(void 0)}return{$:e,add:function(r){if(!(t===void 0||e.length<t))return Cn(new xe("Not adding Promise because buffer limit was reached."));const i=r();return e.indexOf(i)===-1&&e.push(i),i.then(()=>n(i)).then(null,()=>n(i).then(null,()=>{})),i},drain:function(r){return new _e((i,s)=>{let a=e.length;if(!a)return i(!0);const l=setTimeout(()=>{r&&r>0&&i(!1)},r);e.forEach(c=>{ft(c).then(()=>{--a||(clearTimeout(l),i(!0))},s)})})}}}function br(t){if(!t)return{};const e=t.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!e)return{};const n=e[6]||"",r=e[8]||"";return{host:e[4],path:e[5],protocol:e[2],search:n,hash:r,relative:e[5]+n+r}}const Dc=["fatal","error","warning","log","info","debug"];function Ic(t){return t==="warn"?"warning":Dc.includes(t)?t:"log"}const Nc=/^sentry-/;function Rc(t){const e=function(r){if(!(!r||!Be(r)&&!Array.isArray(r)))return Array.isArray(r)?r.reduce((i,s)=>{const a=xs(s);return Object.entries(a).forEach(([l,c])=>{i[l]=c}),i},{}):xs(r)}(t);if(!e)return;const n=Object.entries(e).reduce((r,[i,s])=>(i.match(Nc)&&(r[i.slice(7)]=s),r),{});return Object.keys(n).length>0?n:void 0}function xs(t){return t.split(",").map(e=>e.split("=").map(n=>decodeURIComponent(n.trim()))).reduce((e,[n,r])=>(n&&r&&(e[n]=r),e),{})}function Wt(t,e=[]){return[t,e]}function Bc(t,e){const[n,r]=t;return[n,[...r,e]]}function Ps(t,e){const n=t[1];for(const r of n)if(e(r,r[0].type))return!0;return!1}function _r(t){return G.__SENTRY__&&G.__SENTRY__.encodePolyfill?G.__SENTRY__.encodePolyfill(t):new TextEncoder().encode(t)}function Fc(t){const[e,n]=t;let r=JSON.stringify(e);function i(s){typeof r=="string"?r=typeof s=="string"?r+s:[_r(r),s]:r.push(typeof s=="string"?_r(s):s)}for(const s of n){const[a,l]=s;if(i(`
${JSON.stringify(a)}
`),typeof l=="string"||l instanceof Uint8Array)i(l);else{let c;try{c=JSON.stringify(l)}catch{c=JSON.stringify(Ze(l))}i(c)}}return typeof r=="string"?r:function(s){const a=s.reduce((h,p)=>h+p.length,0),l=new Uint8Array(a);let c=0;for(const h of s)l.set(h,c),c+=h.length;return l}(r)}function Uc(t){const e=typeof t.data=="string"?_r(t.data):t.data;return[Ee({type:"attachment",length:e.length,filename:t.filename,content_type:t.contentType,attachment_type:t.attachmentType}),e]}const $c={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",profile_chunk:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",statsd:"metric_bucket"};function Ls(t){return $c[t]}function js(t){if(!t||!t.sdk)return;const{name:e,version:n}=t.sdk;return{name:e,version:n}}function qc(t,{statusCode:e,headers:n},r=Date.now()){const i={...t},s=n&&n["x-sentry-rate-limits"],a=n&&n["retry-after"];if(s)for(const l of s.trim().split(",")){const[c,h,,,p]=l.split(":",5),m=parseInt(c,10),b=1e3*(isNaN(m)?60:m);if(h)for(const v of h.split(";"))v==="metric_bucket"&&p&&!p.split(";").includes("custom")||(i[v]=r+b);else i.all=r+b}else a?i.all=r+function(l,c=Date.now()){const h=parseInt(`${l}`,10);if(!isNaN(h))return 1e3*h;const p=Date.parse(`${l}`);return isNaN(p)?6e4:p-c}(a,r):e===429&&(i.all=r+6e4);return i}function Ds(){return{traceId:Te(),spanId:Te().substring(16)}}const En=G,ee=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__;function Mn(){return wr(G),G}function wr(t){const e=t.__SENTRY__=t.__SENTRY__||{};return e.version=e.version||lt,e[lt]=e[lt]||{}}function Sr(t,e={}){if(e.user&&(!t.ipAddress&&e.user.ip_address&&(t.ipAddress=e.user.ip_address),t.did||e.did||(t.did=e.user.id||e.user.email||e.user.username)),t.timestamp=e.timestamp||Ye(),e.abnormal_mechanism&&(t.abnormal_mechanism=e.abnormal_mechanism),e.ignoreDuration&&(t.ignoreDuration=e.ignoreDuration),e.sid&&(t.sid=e.sid.length===32?e.sid:Te()),e.init!==void 0&&(t.init=e.init),!t.did&&e.did&&(t.did=`${e.did}`),typeof e.started=="number"&&(t.started=e.started),t.ignoreDuration)t.duration=void 0;else if(typeof e.duration=="number")t.duration=e.duration;else{const n=t.timestamp-t.started;t.duration=n>=0?n:0}e.release&&(t.release=e.release),e.environment&&(t.environment=e.environment),!t.ipAddress&&e.ipAddress&&(t.ipAddress=e.ipAddress),!t.userAgent&&e.userAgent&&(t.userAgent=e.userAgent),typeof e.errors=="number"&&(t.errors=e.errors),e.status&&(t.status=e.status)}const kr="_sentrySpan";function Is(t,e){e?ut(t,kr,e):delete t[kr]}function Ns(t){return t[kr]}class Cr{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext=Ds()}clone(){const e=new Cr;return e._breadcrumbs=[...this._breadcrumbs],e._tags={...this._tags},e._extra={...this._extra},e._contexts={...this._contexts},e._user=this._user,e._level=this._level,e._session=this._session,e._transactionName=this._transactionName,e._fingerprint=this._fingerprint,e._eventProcessors=[...this._eventProcessors],e._requestSession=this._requestSession,e._attachments=[...this._attachments],e._sdkProcessingMetadata={...this._sdkProcessingMetadata},e._propagationContext={...this._propagationContext},e._client=this._client,e._lastEventId=this._lastEventId,Is(e,Ns(this)),e}setClient(e){this._client=e}setLastEventId(e){this._lastEventId=e}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&Sr(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(e){return this._requestSession=e,this}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,n){return this._tags={...this._tags,[e]:n},this._notifyScopeListeners(),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,n){return this._extra={...this._extra,[e]:n},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,n){return n===null?delete this._contexts[e]:this._contexts[e]=n,this._notifyScopeListeners(),this}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;const n=typeof e=="function"?e(this):e,[r,i]=n instanceof et?[n.getScopeData(),n.getRequestSession()]:xt(n)?[e,e.requestSession]:[],{tags:s,extra:a,user:l,contexts:c,level:h,fingerprint:p=[],propagationContext:m}=r||{};return this._tags={...this._tags,...s},this._extra={...this._extra,...a},this._contexts={...this._contexts,...c},l&&Object.keys(l).length&&(this._user=l),h&&(this._level=h),p.length&&(this._fingerprint=p),m&&(this._propagationContext=m),i&&(this._requestSession=i),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._session=void 0,Is(this,void 0),this._attachments=[],this._propagationContext=Ds(),this._notifyScopeListeners(),this}addBreadcrumb(e,n){const r=typeof n=="number"?n:100;if(r<=0)return this;const i={timestamp:Jt(),...e},s=this._breadcrumbs;return s.push(i),this._breadcrumbs=s.length>r?s.slice(-r):s,this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:Ns(this)}}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata={...this._sdkProcessingMetadata,...e},this}setPropagationContext(e){return this._propagationContext=e,this}getPropagationContext(){return this._propagationContext}captureException(e,n){const r=n&&n.event_id?n.event_id:Te();if(!this._client)return J.warn("No client configured on scope - will not capture exception!"),r;const i=new Error("Sentry syntheticException");return this._client.captureException(e,{originalException:e,syntheticException:i,...n,event_id:r},this),r}captureMessage(e,n,r){const i=r&&r.event_id?r.event_id:Te();if(!this._client)return J.warn("No client configured on scope - will not capture message!"),i;const s=new Error(e);return this._client.captureMessage(e,n,{originalException:e,syntheticException:s,...r,event_id:i},this),i}captureEvent(e,n){const r=n&&n.event_id?n.event_id:Te();return this._client?(this._client.captureEvent(e,{...n,event_id:r},this),r):(J.warn("No client configured on scope - will not capture event!"),r)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(e=>{e(this)}),this._notifyingListeners=!1)}}const et=Cr;class Jc{constructor(e,n){let r,i;r=e||new et,i=n||new et,this._stack=[{scope:r}],this._isolationScope=i}withScope(e){const n=this._pushScope();let r;try{r=e(n)}catch(i){throw this._popScope(),i}return mn(r)?r.then(i=>(this._popScope(),i),i=>{throw this._popScope(),i}):(this._popScope(),r)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){const e=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:e}),e}_popScope(){return!(this._stack.length<=1)&&!!this._stack.pop()}}function Lt(){const t=wr(Mn());return t.stack=t.stack||new Jc(vn("defaultCurrentScope",()=>new et),vn("defaultIsolationScope",()=>new et))}function Vc(t){return Lt().withScope(t)}function Wc(t,e){const n=Lt();return n.withScope(()=>(n.getStackTop().scope=t,e(t)))}function Rs(t){return Lt().withScope(()=>t(Lt().getIsolationScope()))}function Er(t){const e=wr(t);return e.acs?e.acs:{withIsolationScope:Rs,withScope:Vc,withSetScope:Wc,withSetIsolationScope:(n,r)=>Rs(r),getCurrentScope:()=>Lt().getScope(),getIsolationScope:()=>Lt().getIsolationScope()}}function Mr(){return Er(Mn()).getCurrentScope()}function Bs(){return Er(Mn()).getIsolationScope()}function fe(){return Mr().getClient()}function zc(t){const e=t._sentryMetrics;if(!e)return;const n={};for(const[,[r,i]]of e)(n[r]||(n[r]=[])).push(Ee(i));return n}function Gc(t){const{spanId:e,traceId:n}=t.spanContext(),{parent_span_id:r}=Tn(t);return Ee({parent_span_id:r,span_id:e,trace_id:n})}function Fs(t){return typeof t=="number"?Us(t):Array.isArray(t)?t[0]+t[1]/1e9:t instanceof Date?Us(t.getTime()):Ye()}function Us(t){return t>9999999999?t/1e3:t}function Tn(t){if(function(e){return typeof e.getSpanJSON=="function"}(t))return t.getSpanJSON();try{const{spanId:e,traceId:n}=t.spanContext();if(function(r){const i=r;return!!(i.attributes&&i.startTime&&i.name&&i.endTime&&i.status)}(t)){const{attributes:r,startTime:i,name:s,endTime:a,parentSpanId:l,status:c}=t;return Ee({span_id:e,trace_id:n,data:r,description:s,parent_span_id:l,start_timestamp:Fs(i),timestamp:Fs(a)||void 0,status:Hc(c),op:r["sentry.op"],origin:r["sentry.origin"],_metrics_summary:zc(t)})}return{span_id:e,trace_id:n}}catch{return{}}}function Hc(t){if(t&&t.code!==0)return t.code===1?"ok":t.message||"unknown_error"}function $s(t){return t._sentryRootSpan||t}const qs="production";function Js(t,e){const n=e.getOptions(),{publicKey:r}=e.getDsn()||{},i=Ee({environment:n.environment||qs,release:n.release,public_key:r,trace_id:t});return e.emit("createDsc",i),i}function Qc(t){const e=fe();if(!e)return{};const n=Js(Tn(t).trace_id||"",e),r=$s(t),i=r._frozenDsc;if(i)return i;const s=r.spanContext().traceState,a=s&&s.get("sentry.dsc"),l=a&&Rc(a);if(l)return l;const c=Tn(r),h=c.data||{},p=h["sentry.sample_rate"];p!=null&&(n.sample_rate=`${p}`);const m=h["sentry.source"],b=c.description;return m!=="url"&&b&&(n.transaction=b),function(v){if(typeof __SENTRY_TRACING__=="boolean"&&!__SENTRY_TRACING__)return!1;const _=fe(),S=_&&_.getOptions();return!!S&&(S.enableTracing||"tracesSampleRate"in S||"tracesSampler"in S)}()&&(n.sampled=String(function(v){const{traceFlags:_}=v.spanContext();return _===1}(r))),e.emit("createDsc",n,r),n}function Kc(t,e,n,r){const i=js(n),s=t.type&&t.type!=="replay_event"?t.type:"event";(function(l,c){c&&(l.sdk=l.sdk||{},l.sdk.name=l.sdk.name||c.name,l.sdk.version=l.sdk.version||c.version,l.sdk.integrations=[...l.sdk.integrations||[],...c.integrations||[]],l.sdk.packages=[...l.sdk.packages||[],...c.packages||[]])})(t,n&&n.sdk);const a=function(l,c,h,p){const m=l.sdkProcessingMetadata&&l.sdkProcessingMetadata.dynamicSamplingContext;return{event_id:l.event_id,sent_at:new Date().toISOString(),...c&&{sdk:c},...!!h&&p&&{dsn:bn(p)},...m&&{trace:Ee({...m})}}}(t,i,r,e);return delete t.sdkProcessingMetadata,Wt(a,[[{type:s},t]])}function Tr(t,e,n,r=0){return new _e((i,s)=>{const a=t[r];if(e===null||typeof a!="function")i(e);else{const l=a({...e},n);ee&&a.id&&l===null&&J.log(`Event processor "${a.id}" dropped event`),mn(l)?l.then(c=>Tr(t,c,n,r+1).then(i)).then(null,s):Tr(t,l,n,r+1).then(i).then(null,s)}})}function Yc(t,e){const{fingerprint:n,span:r,breadcrumbs:i,sdkProcessingMetadata:s}=e;(function(a,l){const{extra:c,tags:h,user:p,contexts:m,level:b,transactionName:v}=l,_=Ee(c);_&&Object.keys(_).length&&(a.extra={..._,...a.extra});const S=Ee(h);S&&Object.keys(S).length&&(a.tags={...S,...a.tags});const L=Ee(p);L&&Object.keys(L).length&&(a.user={...L,...a.user});const C=Ee(m);C&&Object.keys(C).length&&(a.contexts={...C,...a.contexts}),b&&(a.level=b),v&&a.type!=="transaction"&&(a.transaction=v)})(t,e),r&&function(a,l){a.contexts={trace:Gc(l),...a.contexts},a.sdkProcessingMetadata={dynamicSamplingContext:Qc(l),...a.sdkProcessingMetadata};const c=$s(l),h=Tn(c).description;h&&!a.transaction&&a.type==="transaction"&&(a.transaction=h)}(t,r),function(a,l){a.fingerprint=a.fingerprint?function(c){return Array.isArray(c)?c:[c]}(a.fingerprint):[],l&&(a.fingerprint=a.fingerprint.concat(l)),a.fingerprint&&!a.fingerprint.length&&delete a.fingerprint}(t,n),function(a,l){const c=[...a.breadcrumbs||[],...l];a.breadcrumbs=c.length?c:void 0}(t,i),function(a,l){a.sdkProcessingMetadata={...a.sdkProcessingMetadata,...l}}(t,s)}function Vs(t,e){const{extra:n,tags:r,user:i,contexts:s,level:a,sdkProcessingMetadata:l,breadcrumbs:c,fingerprint:h,eventProcessors:p,attachments:m,propagationContext:b,transactionName:v,span:_}=e;zt(t,"extra",n),zt(t,"tags",r),zt(t,"user",i),zt(t,"contexts",s),zt(t,"sdkProcessingMetadata",l),a&&(t.level=a),v&&(t.transactionName=v),_&&(t.span=_),c.length&&(t.breadcrumbs=[...t.breadcrumbs,...c]),h.length&&(t.fingerprint=[...t.fingerprint,...h]),p.length&&(t.eventProcessors=[...t.eventProcessors,...p]),m.length&&(t.attachments=[...t.attachments,...m]),t.propagationContext={...t.propagationContext,...b}}function zt(t,e,n){if(n&&Object.keys(n).length){t[e]={...t[e]};for(const r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[e][r]=n[r])}}function Xc(t,e,n,r,i,s){const{normalizeDepth:a=3,normalizeMaxBreadth:l=1e3}=t,c={...e,event_id:e.event_id||n.event_id||Te(),timestamp:e.timestamp||Jt()},h=n.integrations||t.integrations.map(_=>_.name);(function(_,S){const{environment:L,release:C,dist:T,maxValueLength:A=250}=S;"environment"in _||(_.environment="environment"in S?L:qs),_.release===void 0&&C!==void 0&&(_.release=C),_.dist===void 0&&T!==void 0&&(_.dist=T),_.message&&(_.message=Pt(_.message,A));const y=_.exception&&_.exception.values&&_.exception.values[0];y&&y.value&&(y.value=Pt(y.value,A));const w=_.request;w&&w.url&&(w.url=Pt(w.url,A))})(c,t),function(_,S){S.length>0&&(_.sdk=_.sdk||{},_.sdk.integrations=[..._.sdk.integrations||[],...S])}(c,h),i&&i.emit("applyFrameMetadata",e),e.type===void 0&&function(_,S){const L=G._sentryDebugIds;if(!L)return;let C;const T=Ws.get(S);T?C=T:(C=new Map,Ws.set(S,C));const A=Object.entries(L).reduce((y,[w,E])=>{let k;const P=C.get(w);P?k=P:(k=S(w),C.set(w,k));for(let I=k.length-1;I>=0;I--){const x=k[I];if(x.filename){y[x.filename]=E;break}}return y},{});try{_.exception.values.forEach(y=>{y.stacktrace.frames.forEach(w=>{w.filename&&(w.debug_id=A[w.filename])})})}catch{}}(c,t.stackParser);const p=function(_,S){if(!S)return _;const L=_?_.clone():new et;return L.update(S),L}(r,n.captureContext);n.mechanism&&Vt(c,n.mechanism);const m=i?i.getEventProcessors():[],b=vn("globalScope",()=>new et).getScopeData();s&&Vs(b,s.getScopeData()),p&&Vs(b,p.getScopeData());const v=[...n.attachments||[],...b.attachments];return v.length&&(n.attachments=v),Yc(c,b),Tr([...m,...b.eventProcessors],c,n).then(_=>(_&&function(S){const L={};try{S.exception.values.forEach(T=>{T.stacktrace.frames.forEach(A=>{A.debug_id&&(A.abs_path?L[A.abs_path]=A.debug_id:A.filename&&(L[A.filename]=A.debug_id),delete A.debug_id)})})}catch{}if(Object.keys(L).length===0)return;S.debug_meta=S.debug_meta||{},S.debug_meta.images=S.debug_meta.images||[];const C=S.debug_meta.images;Object.entries(L).forEach(([T,A])=>{C.push({type:"sourcemap",code_file:T,debug_id:A})})}(_),typeof a=="number"&&a>0?function(S,L,C){if(!S)return null;const T={...S,...S.breadcrumbs&&{breadcrumbs:S.breadcrumbs.map(A=>({...A,...A.data&&{data:Ze(A.data,L,C)}}))},...S.user&&{user:Ze(S.user,L,C)},...S.contexts&&{contexts:Ze(S.contexts,L,C)},...S.extra&&{extra:Ze(S.extra,L,C)}};return S.contexts&&S.contexts.trace&&T.contexts&&(T.contexts.trace=S.contexts.trace,S.contexts.trace.data&&(T.contexts.trace.data=Ze(S.contexts.trace.data,L,C))),S.spans&&(T.spans=S.spans.map(A=>({...A,...A.data&&{data:Ze(A.data,L,C)}}))),T}(_,a,l):_))}const Ws=new WeakMap;function Zd(t){}function zs(t,e){return Mr().captureEvent(t,e)}function Zc(t,e){return n={sentry_key:t.publicKey,sentry_version:"7",...e&&{sentry_client:`${e.name}/${e.version}`}},Object.keys(n).map(r=>`${encodeURIComponent(r)}=${encodeURIComponent(n[r])}`).join("&");var n}const Gs=[];function Hs(t,e){for(const n of e)n&&n.afterAllSetup&&n.afterAllSetup(t)}function Qs(t,e,n){if(n[e.name])ee&&J.log(`Integration skipped because it was already installed: ${e.name}`);else{if(n[e.name]=e,Gs.indexOf(e.name)===-1&&typeof e.setupOnce=="function"&&(e.setupOnce(),Gs.push(e.name)),e.setup&&typeof e.setup=="function"&&e.setup(t),typeof e.preprocessEvent=="function"){const r=e.preprocessEvent.bind(e);t.on("preprocessEvent",(i,s)=>r(i,s,t))}if(typeof e.processEvent=="function"){const r=e.processEvent.bind(e),i=Object.assign((s,a)=>r(s,a,t),{id:e.name});t.addEventProcessor(i)}ee&&J.log(`Integration installed: ${e.name}`)}}const Ks="Not capturing exception because it's already been captured.";class el{constructor(e){if(this._options=e,this._integrations={},this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],e.dsn?this._dsn=Tc(e.dsn):ee&&J.warn("No DSN provided, client will not send events."),this._dsn){const s=(n=this._dsn,r=e.tunnel,i=e._metadata?e._metadata.sdk:void 0,r||`${function(a){return`${function(l){const c=l.protocol?`${l.protocol}:`:"",h=l.port?`:${l.port}`:"";return`${c}//${l.host}${h}${l.path?`/${l.path}`:""}/api/`}(a)}${a.projectId}/envelope/`}(n)}?${Zc(n,i)}`);this._transport=e.transport({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this),...e.transportOptions,url:s})}var n,r,i}captureException(e,n,r){const i=Te();if(Os(e))return ee&&J.log(Ks),i;const s={event_id:i,...n};return this._process(this.eventFromException(e,s).then(a=>this._captureEvent(a,s,r))),s.event_id}captureMessage(e,n,r,i){const s={event_id:Te(),...r},a=ar(e)?e:String(e),l=or(e)?this.eventFromMessage(a,n,s):this.eventFromException(e,s);return this._process(l.then(c=>this._captureEvent(c,s,i))),s.event_id}captureEvent(e,n,r){const i=Te();if(n&&n.originalException&&Os(n.originalException))return ee&&J.log(Ks),i;const s={event_id:i,...n},a=(e.sdkProcessingMetadata||{}).capturedSpanScope;return this._process(this._captureEvent(e,s,a||r)),s.event_id}captureSession(e){typeof e.release!="string"?ee&&J.warn("Discarded session because of missing or non-string release"):(this.sendSession(e),Sr(e,{init:!1}))}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(e){const n=this._transport;return n?(this.emit("flush"),this._isClientDoneProcessing(e).then(r=>n.flush(e).then(i=>r&&i))):ft(!0)}close(e){return this.flush(e).then(n=>(this.getOptions().enabled=!1,this.emit("close"),n))}getEventProcessors(){return this._eventProcessors}addEventProcessor(e){this._eventProcessors.push(e)}init(){(this._isEnabled()||this._options.integrations.some(({name:e})=>e.startsWith("Spotlight")))&&this._setupIntegrations()}getIntegrationByName(e){return this._integrations[e]}addIntegration(e){const n=this._integrations[e.name];Qs(this,e,this._integrations),n||Hs(this,[e])}sendEvent(e,n={}){this.emit("beforeSendEvent",e,n);let r=Kc(e,this._dsn,this._options._metadata,this._options.tunnel);for(const s of n.attachments||[])r=Bc(r,Uc(s));const i=this.sendEnvelope(r);i&&i.then(s=>this.emit("afterSendEvent",e,s),null)}sendSession(e){const n=function(r,i,s,a){const l=js(s);return Wt({sent_at:new Date().toISOString(),...l&&{sdk:l},...!!a&&i&&{dsn:bn(i)}},["aggregates"in r?[{type:"sessions"},r]:[{type:"session"},r.toJSON()]])}(e,this._dsn,this._options._metadata,this._options.tunnel);this.sendEnvelope(n)}recordDroppedEvent(e,n,r){if(this._options.sendClientReports){const i=typeof r=="number"?r:1,s=`${e}:${n}`;ee&&J.log(`Recording outcome: "${s}"${i>1?` (${i} times)`:""}`),this._outcomes[s]=(this._outcomes[s]||0)+i}}on(e,n){const r=this._hooks[e]=this._hooks[e]||[];return r.push(n),()=>{const i=r.indexOf(n);i>-1&&r.splice(i,1)}}emit(e,...n){const r=this._hooks[e];r&&r.forEach(i=>i(...n))}sendEnvelope(e){return this.emit("beforeEnvelope",e),this._isEnabled()&&this._transport?this._transport.send(e).then(null,n=>(ee&&J.error("Error while sending event:",n),n)):(ee&&J.error("Transport disabled"),ft({}))}_setupIntegrations(){const{integrations:e}=this._options;this._integrations=function(n,r){const i={};return r.forEach(s=>{s&&Qs(n,s,i)}),i}(this,e),Hs(this,e)}_updateSessionFromEvent(e,n){let r=!1,i=!1;const s=n.exception&&n.exception.values;if(s){i=!0;for(const l of s){const c=l.mechanism;if(c&&c.handled===!1){r=!0;break}}}const a=e.status==="ok";(a&&e.errors===0||a&&r)&&(Sr(e,{...r&&{status:"crashed"},errors:e.errors||Number(i||r)}),this.captureSession(e))}_isClientDoneProcessing(e){return new _e(n=>{let r=0;const i=setInterval(()=>{this._numProcessing==0?(clearInterval(i),n(!0)):(r+=1,e&&r>=e&&(clearInterval(i),n(!1)))},1)})}_isEnabled(){return this.getOptions().enabled!==!1&&this._transport!==void 0}_prepareEvent(e,n,r,i=Bs()){const s=this.getOptions(),a=Object.keys(this._integrations);return!n.integrations&&a.length>0&&(n.integrations=a),this.emit("preprocessEvent",e,n),e.type||i.setLastEventId(e.event_id||n.event_id),Xc(s,e,n,r,this,i).then(l=>{if(l===null)return l;const c={...i.getPropagationContext(),...r?r.getPropagationContext():void 0};if(!(l.contexts&&l.contexts.trace)&&c){const{traceId:h,spanId:p,parentSpanId:m,dsc:b}=c;l.contexts={trace:Ee({trace_id:h,span_id:p,parent_span_id:m}),...l.contexts};const v=b||Js(h,this);l.sdkProcessingMetadata={dynamicSamplingContext:v,...l.sdkProcessingMetadata}}return l})}_captureEvent(e,n={},r){return this._processEvent(e,n,r).then(i=>i.event_id,i=>{if(ee){const s=i;s.logLevel==="log"?J.log(s.message):J.warn(s)}})}_processEvent(e,n,r){const i=this.getOptions(),{sampleRate:s}=i,a=Xs(e),l=Ys(e),c=e.type||"error",h=`before send for type \`${c}\``,p=s===void 0?void 0:function(v){if(typeof v=="boolean")return Number(v);const _=typeof v=="string"?parseFloat(v):v;if(!(typeof _!="number"||isNaN(_)||_<0||_>1))return _;ee&&J.warn(`[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(v)} of type ${JSON.stringify(typeof v)}.`)}(s);if(l&&typeof p=="number"&&Math.random()>p)return this.recordDroppedEvent("sample_rate","error",e),Cn(new xe(`Discarding event because it's not included in the random sample (sampling rate = ${s})`,"log"));const m=c==="replay_event"?"replay":c,b=(e.sdkProcessingMetadata||{}).capturedSpanIsolationScope;return this._prepareEvent(e,n,r,b).then(v=>{if(v===null)throw this.recordDroppedEvent("event_processor",m,e),new xe("An event processor returned `null`, will not send event.","log");if(n.data&&n.data.__sentry__===!0)return v;const _=function(S,L,C,T){const{beforeSend:A,beforeSendTransaction:y,beforeSendSpan:w}=L;if(Ys(C)&&A)return A(C,T);if(Xs(C)){if(C.spans&&w){const E=[];for(const k of C.spans){const P=w(k);P?E.push(P):S.recordDroppedEvent("before_send","span")}C.spans=E}if(y){if(C.spans){const E=C.spans.length;C.sdkProcessingMetadata={...C.sdkProcessingMetadata,spanCountBeforeProcessing:E}}return y(C,T)}}return C}(this,i,v,n);return function(S,L){const C=`${L} must return \`null\` or a valid event.`;if(mn(S))return S.then(T=>{if(!xt(T)&&T!==null)throw new xe(C);return T},T=>{throw new xe(`${L} rejected with ${T}`)});if(!xt(S)&&S!==null)throw new xe(C);return S}(_,h)}).then(v=>{if(v===null){if(this.recordDroppedEvent("before_send",m,e),a){const L=1+(e.spans||[]).length;this.recordDroppedEvent("before_send","span",L)}throw new xe(`${h} returned \`null\`, will not send event.`,"log")}const _=r&&r.getSession();if(!a&&_&&this._updateSessionFromEvent(_,v),a){const L=(v.sdkProcessingMetadata&&v.sdkProcessingMetadata.spanCountBeforeProcessing||0)-(v.spans?v.spans.length:0);L>0&&this.recordDroppedEvent("before_send","span",L)}const S=v.transaction_info;if(a&&S&&v.transaction!==e.transaction){const L="custom";v.transaction_info={...S,source:L}}return this.sendEvent(v,n),v}).then(null,v=>{throw v instanceof xe?v:(this.captureException(v,{data:{__sentry__:!0},originalException:v}),new xe(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.
Reason: ${v}`))})}_process(e){this._numProcessing++,e.then(n=>(this._numProcessing--,n),n=>(this._numProcessing--,n))}_clearOutcomes(){const e=this._outcomes;return this._outcomes={},Object.entries(e).map(([n,r])=>{const[i,s]=n.split(":");return{reason:i,category:s,quantity:r}})}_flushOutcomes(){ee&&J.log("Flushing outcomes...");const e=this._clearOutcomes();if(e.length===0)return void(ee&&J.log("No outcomes to send"));if(!this._dsn)return void(ee&&J.log("No dsn provided, will not send outcomes"));ee&&J.log("Sending outcomes:",e);const n=(r=e,Wt((i=this._options.tunnel&&bn(this._dsn))?{dsn:i}:{},[[{type:"client_report"},{timestamp:s||Jt(),discarded_events:r}]]));var r,i,s;this.sendEnvelope(n)}}function Ys(t){return t.type===void 0}function Xs(t){return t.type==="transaction"}function tl(t,e,n=jc(t.bufferSize||64)){let r={};return{send:function(i){const s=[];if(Ps(i,(c,h)=>{const p=Ls(h);if(function(m,b,v=Date.now()){return function(_,S){return _[S]||_.all||0}(m,b)>v}(r,p)){const m=Zs(c,h);t.recordDroppedEvent("ratelimit_backoff",p,m)}else s.push(c)}),s.length===0)return ft({});const a=Wt(i[0],s),l=c=>{Ps(a,(h,p)=>{const m=Zs(h,p);t.recordDroppedEvent(c,Ls(p),m)})};return n.add(()=>e({body:Fc(a)}).then(c=>(c.statusCode!==void 0&&(c.statusCode<200||c.statusCode>=300)&&ee&&J.warn(`Sentry responded with status code ${c.statusCode} to sent event.`),r=qc(r,c),c),c=>{throw l("network_error"),c})).then(c=>c,c=>{if(c instanceof xe)return ee&&J.error("Skipped sending event because buffer is full."),l("queue_overflow"),ft({});throw c})},flush:i=>n.drain(i)}}function Zs(t,e){if(e==="event"||e==="transaction")return Array.isArray(t)?t[1]:void 0}const nl=100;function mt(t,e){const n=fe(),r=Bs();if(!n)return;const{beforeBreadcrumb:i=null,maxBreadcrumbs:s=nl}=n.getOptions();if(s<=0)return;const a={timestamp:Jt(),...t},l=i?dr(()=>i(a,e)):a;l!==null&&(n.emit&&n.emit("beforeAddBreadcrumb",l,e),r.addBreadcrumb(l,s))}let ea;const ta=new WeakMap,rl=()=>({name:"FunctionToString",setupOnce(){ea=Function.prototype.toString;try{Function.prototype.toString=function(...t){const e=hr(this),n=ta.has(fe())&&e!==void 0?e:this;return ea.apply(n,t)}}catch{}},setup(t){ta.set(t,!0)}}),il=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/,/^ResizeObserver loop completed with undelivered notifications.$/,/^Cannot redefine property: googletag$/,"undefined is not an object (evaluating 'a.L')",`can't redefine non-configurable property "solana"`,"vv().getRestrictions is not a function. (In 'vv().getRestrictions(1,a)', 'vv().getRestrictions' is undefined)","Can't find variable: _AutofillCallbackHandler"],sl=(t={})=>({name:"InboundFilters",processEvent(e,n,r){const i=r.getOptions(),s=function(a={},l={}){return{allowUrls:[...a.allowUrls||[],...l.allowUrls||[]],denyUrls:[...a.denyUrls||[],...l.denyUrls||[]],ignoreErrors:[...a.ignoreErrors||[],...l.ignoreErrors||[],...a.disableErrorDefaults?[]:il],ignoreTransactions:[...a.ignoreTransactions||[],...l.ignoreTransactions||[]],ignoreInternal:a.ignoreInternal===void 0||a.ignoreInternal}}(t,i);return function(a,l){return l.ignoreInternal&&function(c){try{return c.exception.values[0].type==="SentryError"}catch{}return!1}(a)?(ee&&J.warn(`Event dropped due to being internal Sentry Error.
Event: ${Xe(a)}`),!0):function(c,h){return c.type||!h||!h.length?!1:function(p){const m=[];p.message&&m.push(p.message);let b;try{b=p.exception.values[p.exception.values.length-1]}catch{}return b&&b.value&&(m.push(b.value),b.type&&m.push(`${b.type}: ${b.value}`)),m}(c).some(p=>gn(p,h))}(a,l.ignoreErrors)?(ee&&J.warn(`Event dropped due to being matched by \`ignoreErrors\` option.
Event: ${Xe(a)}`),!0):function(c){return c.type||!c.exception||!c.exception.values||c.exception.values.length===0?!1:!c.message&&!c.exception.values.some(h=>h.stacktrace||h.type&&h.type!=="Error"||h.value)}(a)?(ee&&J.warn(`Event dropped due to not having an error message, error type or stacktrace.
Event: ${Xe(a)}`),!0):function(c,h){if(c.type!=="transaction"||!h||!h.length)return!1;const p=c.transaction;return!!p&&gn(p,h)}(a,l.ignoreTransactions)?(ee&&J.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.
Event: ${Xe(a)}`),!0):function(c,h){if(!h||!h.length)return!1;const p=On(c);return!!p&&gn(p,h)}(a,l.denyUrls)?(ee&&J.warn(`Event dropped due to being matched by \`denyUrls\` option.
Event: ${Xe(a)}.
Url: ${On(a)}`),!0):function(c,h){if(!h||!h.length)return!0;const p=On(c);return!p||gn(p,h)}(a,l.allowUrls)?!1:(ee&&J.warn(`Event dropped due to not being matched by \`allowUrls\` option.
Event: ${Xe(a)}.
Url: ${On(a)}`),!0)}(e,s)?null:e}});function On(t){try{let e;try{e=t.exception.values[0].stacktrace.frames}catch{}return e?function(n=[]){for(let r=n.length-1;r>=0;r--){const i=n[r];if(i&&i.filename!=="<anonymous>"&&i.filename!=="[native code]")return i.filename||null}return null}(e):null}catch{return ee&&J.error(`Cannot extract url for event ${Xe(t)}`),null}}const al=()=>{let t;return{name:"Dedupe",processEvent(e){if(e.type)return e;try{if(function(n,r){return r?!!(function(i,s){const a=i.message,l=s.message;return!(!a&&!l||a&&!l||!a&&l||a!==l||!ra(i,s)||!na(i,s))}(n,r)||function(i,s){const a=ia(s),l=ia(i);return!(!a||!l||a.type!==l.type||a.value!==l.value||!ra(i,s)||!na(i,s))}(n,r)):!1}(e,t))return ee&&J.warn("Event dropped due to being a duplicate of previously captured event."),null}catch{}return t=e}}};function na(t,e){let n=Cs(t),r=Cs(e);if(!n&&!r)return!0;if(n&&!r||!n&&r||r.length!==n.length)return!1;for(let i=0;i<r.length;i++){const s=r[i],a=n[i];if(s.filename!==a.filename||s.lineno!==a.lineno||s.colno!==a.colno||s.function!==a.function)return!1}return!0}function ra(t,e){let n=t.fingerprint,r=e.fingerprint;if(!n&&!r)return!0;if(n&&!r||!n&&r)return!1;try{return n.join("")===r.join("")}catch{return!1}}function ia(t){return t.exception&&t.exception.values&&t.exception.values[0]}const ae=G;let Or=0;function sa(){return Or>0}function jt(t,e={},n){if(typeof t!="function")return t;try{const i=t.__sentry_wrapped__;if(i)return typeof i=="function"?i:t;if(hr(t))return t}catch{return t}const r=function(){const i=Array.prototype.slice.call(arguments);try{n&&typeof n=="function"&&n.apply(this,arguments);const s=i.map(a=>jt(a,e));return t.apply(this,s)}catch(s){throw Or++,setTimeout(()=>{Or--}),function(...a){const l=Er(Mn());if(a.length===2){const[c,h]=a;return c?l.withSetScope(c,h):l.withScope(h)}l.withScope(a[0])}(a=>{var l;a.addEventProcessor(c=>(e.mechanism&&(vr(c,void 0),Vt(c,e.mechanism)),c.extra={...c.extra,arguments:i},c)),l=s,Mr().captureException(l,void 0)}),s}};try{for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=t[i])}catch{}vs(r,t),ut(t,"__sentry_wrapped__",r);try{Object.getOwnPropertyDescriptor(r,"name").configurable&&Object.defineProperty(r,"name",{get:()=>t.name})}catch{}return r}const Ar=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__;function xr(t,e){const n=Lr(t,e),r={type:e&&e.name,value:ll(e)};return n.length&&(r.stacktrace={frames:n}),r.type===void 0&&r.value===""&&(r.value="Unrecoverable error caught"),r}function ol(t,e,n,r){const i=fe(),s=i&&i.getOptions().normalizeDepth,a=function(h){for(const p in h)if(Object.prototype.hasOwnProperty.call(h,p)){const m=h[p];if(m instanceof Error)return m}}(e),l={__serialized__:As(e,s)};if(a)return{exception:{values:[xr(t,a)]},extra:l};const c={exception:{values:[{type:fn(e)?e.constructor.name:r?"UnhandledRejection":"Error",value:ul(e,{isUnhandledRejection:r})}]},extra:l};if(n){const h=Lr(t,n);h.length&&(c.exception.values[0].stacktrace={frames:h})}return c}function Pr(t,e){return{exception:{values:[xr(t,e)]}}}function Lr(t,e){const n=e.stacktrace||e.stack||"",r=function(s){return s&&cl.test(s.message)?1:0}(e),i=function(s){return typeof s.framesToPop=="number"?s.framesToPop:0}(e);try{return t(n,r,i)}catch{}return[]}const cl=/Minified React error #\d+;/i;function ll(t){const e=t&&t.message;return e?e.error&&typeof e.error.message=="string"?e.error.message:e:"No error message"}function jr(t,e,n,r,i){let s;if(cs(e)&&e.error)return Pr(t,e.error);if(ls(e)||At(e,"DOMException")){const a=e;if("stack"in e)s=Pr(t,e);else{const l=a.name||(ls(a)?"DOMError":"DOMException"),c=a.message?`${l}: ${a.message}`:l;s=Dr(t,c,n,r),vr(s,c)}return"code"in a&&(s.tags={...s.tags,"DOMException.code":`${a.code}`}),s}return sr(e)?Pr(t,e):xt(e)||fn(e)?(s=ol(t,e,n,i),Vt(s,{synthetic:!0}),s):(s=Dr(t,e,n,r),vr(s,`${e}`),Vt(s,{synthetic:!0}),s)}function Dr(t,e,n,r){const i={};if(r&&n){const s=Lr(t,n);s.length&&(i.exception={values:[{value:e,stacktrace:{frames:s}}]})}if(ar(e)){const{__sentry_template_string__:s,__sentry_template_values__:a}=e;return i.logentry={message:s,params:a},i}return i.message=e,i}function ul(t,{isUnhandledRejection:e}){const n=function(i,s=40){const a=Object.keys(ys(i));a.sort();const l=a[0];if(!l)return"[object has no keys]";if(l.length>=s)return Pt(l,s);for(let c=a.length;c>0;c--){const h=a.slice(0,c).join(", ");if(!(h.length>s))return c===a.length?h:Pt(h,s)}return""}(t),r=e?"promise rejection":"exception";return cs(t)?`Event \`ErrorEvent\` captured as ${r} with message \`${t.message}\``:fn(t)?`Event \`${function(i){try{const s=Object.getPrototypeOf(i);return s?s.constructor.name:void 0}catch{}}(t)}\` (type=${t.type}) captured as ${r}`:`Object captured as ${r} with keys: ${n}`}class dl extends el{constructor(e){const n={parentSpanIsAlwaysRootSpan:!0,...e};(function(r,i,s=[i],a="npm"){const l=r._metadata||{};l.sdk||(l.sdk={name:`sentry.javascript.${i}`,packages:s.map(c=>({name:`${a}:@sentry/${c}`,version:lt})),version:lt}),r._metadata=l})(n,"browser",["browser"],ae.SENTRY_SDK_SOURCE||"npm"),super(n),n.sendClientReports&&ae.document&&ae.document.addEventListener("visibilitychange",()=>{ae.document.visibilityState==="hidden"&&this._flushOutcomes()})}eventFromException(e,n){return function(r,i,s,a){const l=jr(r,i,s&&s.syntheticException||void 0,a);return Vt(l),l.level="error",s&&s.event_id&&(l.event_id=s.event_id),ft(l)}(this._options.stackParser,e,n,this._options.attachStacktrace)}eventFromMessage(e,n="info",r){return function(i,s,a="info",l,c){const h=Dr(i,s,l&&l.syntheticException||void 0,c);return h.level=a,l&&l.event_id&&(h.event_id=l.event_id),ft(h)}(this._options.stackParser,e,n,r,this._options.attachStacktrace)}captureUserFeedback(e){if(!this._isEnabled())return void(Ar&&J.warn("SDK not enabled, will not capture user feedback."));const n=function(r,{metadata:i,tunnel:s,dsn:a}){const l={event_id:r.event_id,sent_at:new Date().toISOString(),...i&&i.sdk&&{sdk:{name:i.sdk.name,version:i.sdk.version}},...!!s&&!!a&&{dsn:bn(a)}};return Wt(l,[function(h){return[{type:"user_report"},h]}(r)])}(e,{metadata:this.getSdkMetadata(),dsn:this.getDsn(),tunnel:this.getOptions().tunnel});this.sendEnvelope(n)}_prepareEvent(e,n,r){return e.platform=e.platform||"javascript",super._prepareEvent(e,n,r)}}const hl=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,le=G;let aa,Ir,Nr,An;function pl(){if(!le.document)return;const t=Me.bind(null,"dom"),e=oa(t,!0);le.document.addEventListener("click",e,!1),le.document.addEventListener("keypress",e,!1),["EventTarget","Node"].forEach(n=>{const r=le[n]&&le[n].prototype;r&&r.hasOwnProperty&&r.hasOwnProperty("addEventListener")&&(ge(r,"addEventListener",function(i){return function(s,a,l){if(s==="click"||s=="keypress")try{const c=this,h=c.__sentry_instrumentation_handlers__=c.__sentry_instrumentation_handlers__||{},p=h[s]=h[s]||{refCount:0};if(!p.handler){const m=oa(t);p.handler=m,i.call(this,s,m,l)}p.refCount++}catch{}return i.call(this,s,a,l)}}),ge(r,"removeEventListener",function(i){return function(s,a,l){if(s==="click"||s=="keypress")try{const c=this,h=c.__sentry_instrumentation_handlers__||{},p=h[s];p&&(p.refCount--,p.refCount<=0&&(i.call(this,s,p.handler,l),p.handler=void 0,delete h[s]),Object.keys(h).length===0&&delete c.__sentry_instrumentation_handlers__)}catch{}return i.call(this,s,a,l)}}))})}function oa(t,e=!1){return n=>{if(!n||n._sentryCaptured)return;const r=function(s){try{return s.target}catch{return null}}(n);if(function(s,a){return s==="keypress"&&(!a||!a.tagName||a.tagName!=="INPUT"&&a.tagName!=="TEXTAREA"&&!a.isContentEditable)}(n.type,r))return;ut(n,"_sentryCaptured",!0),r&&!r._sentryId&&ut(r,"_sentryId",Te());const i=n.type==="keypress"?"input":n.type;(function(s){if(s.type!==Ir)return!1;try{if(!s.target||s.target._sentryId!==Nr)return!1}catch{}return!0})(n)||(t({event:n,name:i,global:e}),Ir=n.type,Nr=r?r._sentryId:void 0),clearTimeout(aa),aa=le.setTimeout(()=>{Nr=void 0,Ir=void 0},1e3)}}function fl(){if(!function(){const n=En.chrome,r=n&&n.app&&n.app.runtime,i="history"in En&&!!En.history.pushState&&!!En.history.replaceState;return!r&&i}())return;const t=le.onpopstate;function e(n){return function(...r){const i=r.length>2?r[2]:void 0;if(i){const s=An,a=String(i);An=a,Me("history",{from:s,to:a})}return n.apply(this,r)}}le.onpopstate=function(...n){const r=le.location.href,i=An;if(An=r,Me("history",{from:i,to:r}),t)try{return t.apply(this,n)}catch{}},ge(le.history,"pushState",e),ge(le.history,"replaceState",e)}const xn={};function ca(t){xn[t]=void 0}const Gt="__sentry_xhr_v3__";function ml(){if(!le.XMLHttpRequest)return;const t=XMLHttpRequest.prototype;t.open=new Proxy(t.open,{apply(e,n,r){const i=1e3*Ye(),s=Be(r[0])?r[0].toUpperCase():void 0,a=function(c){if(Be(c))return c;try{return c.toString()}catch{}}(r[1]);if(!s||!a)return e.apply(n,r);n[Gt]={method:s,url:a,request_headers:{}},s==="POST"&&a.match(/sentry_key/)&&(n.__sentry_own_request__=!0);const l=()=>{const c=n[Gt];if(c&&n.readyState===4){try{c.status_code=n.status}catch{}Me("xhr",{endTimestamp:1e3*Ye(),startTimestamp:i,xhr:n})}};return"onreadystatechange"in n&&typeof n.onreadystatechange=="function"?n.onreadystatechange=new Proxy(n.onreadystatechange,{apply:(c,h,p)=>(l(),c.apply(h,p))}):n.addEventListener("readystatechange",l),n.setRequestHeader=new Proxy(n.setRequestHeader,{apply(c,h,p){const[m,b]=p,v=h[Gt];return v&&Be(m)&&Be(b)&&(v.request_headers[m.toLowerCase()]=b),c.apply(h,p)}}),e.apply(n,r)}}),t.send=new Proxy(t.send,{apply(e,n,r){const i=n[Gt];return i?(r[0]!==void 0&&(i.body=r[0]),Me("xhr",{startTimestamp:1e3*Ye(),xhr:n}),e.apply(n,r)):e.apply(n,r)}})}function gl(t,e=function(n){const r=xn[n];if(r)return r;let i=le[n];if(mr(i))return xn[n]=i.bind(le);const s=le.document;if(s&&typeof s.createElement=="function")try{const a=s.createElement("iframe");a.hidden=!0,s.head.appendChild(a);const l=a.contentWindow;l&&l[n]&&(i=l[n]),s.head.removeChild(a)}catch(a){hl&&J.warn(`Could not create sandbox iframe for ${n} check, bailing to window.${n}: `,a)}return i&&(xn[n]=i.bind(le))}("fetch")){let n=0,r=0;return tl(t,function(i){const s=i.body.length;n+=s,r++;const a={body:i.body,method:"POST",referrerPolicy:"origin",headers:t.headers,keepalive:n<=6e4&&r<15,...t.fetchOptions};if(!e)return ca("fetch"),Cn("No fetch implementation available");try{return e(t.url,a).then(l=>(n-=s,r--,{statusCode:l.status,headers:{"x-sentry-rate-limits":l.headers.get("X-Sentry-Rate-Limits"),"retry-after":l.headers.get("Retry-After")}}))}catch(l){return ca("fetch"),n-=s,r--,Cn(l)}})}function Rr(t,e,n,r){const i={filename:t,function:e==="<anonymous>"?dt:e,in_app:!0};return n!==void 0&&(i.lineno=n),r!==void 0&&(i.colno=r),i}const vl=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,yl=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,bl=/\((\S*)(?::(\d+))(?::(\d+))\)/,_l=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,wl=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,Sl=function(...t){const e=t.sort((n,r)=>n[0]-r[0]).map(n=>n[1]);return(n,r=0,i=0)=>{const s=[],a=n.split(`
`);for(let l=r;l<a.length;l++){const c=a[l];if(c.length>1024)continue;const h=ws.test(c)?c.replace(ws,"$1"):c;if(!h.match(/\S*Error: /)){for(const p of e){const m=p(h);if(m){s.push(m);break}}if(s.length>=50+i)break}}return function(l){if(!l.length)return[];const c=Array.from(l);return/sentryWrapped/.test(_n(c).function||"")&&c.pop(),c.reverse(),Ss.test(_n(c).function||"")&&(c.pop(),Ss.test(_n(c).function||"")&&c.pop()),c.slice(0,50).map(h=>({...h,filename:h.filename||_n(c).filename,function:h.function||dt}))}(s.slice(i))}}([30,t=>{const e=vl.exec(t);if(e){const[,r,i,s]=e;return Rr(r,dt,+i,+s)}const n=yl.exec(t);if(n){if(n[2]&&n[2].indexOf("eval")===0){const s=bl.exec(n[2]);s&&(n[2]=s[1],n[3]=s[2],n[4]=s[3])}const[r,i]=la(n[1]||dt,n[2]);return Rr(i,r,n[3]?+n[3]:void 0,n[4]?+n[4]:void 0)}}],[50,t=>{const e=_l.exec(t);if(e){if(e[3]&&e[3].indexOf(" > eval")>-1){const i=wl.exec(e[3]);i&&(e[1]=e[1]||"eval",e[3]=i[1],e[4]=i[2],e[5]="")}let n=e[3],r=e[1]||dt;return[r,n]=la(r,n),Rr(n,r,e[4]?+e[4]:void 0,e[5]?+e[5]:void 0)}}]),la=(t,e)=>{const n=t.indexOf("safari-extension")!==-1,r=t.indexOf("safari-web-extension")!==-1;return n||r?[t.indexOf("@")!==-1?t.split("@")[0]:dt,n?`safari-extension:${e}`:`safari-web-extension:${e}`]:[t,e]},ua=1024,kl=(t={})=>{const e={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...t};return{name:"Breadcrumbs",setup(n){var r;e.console&&function(i){const s="console";ht(s,i),pt(s,Oc)}(function(i){return function(s){if(fe()!==i)return;const a={category:"console",data:{arguments:s.args,logger:"console"},level:Ic(s.level),message:ds(s.args," ")};if(s.level==="assert"){if(s.args[0]!==!1)return;a.message=`Assertion failed: ${ds(s.args.slice(1)," ")||"console.assert"}`,a.data.arguments=s.args.slice(1)}mt(a,{input:s.args,level:s.level})}}(n)),e.dom&&(r=function(i,s){return function(a){if(fe()!==i)return;let l,c,h=typeof s=="object"?s.serializeAttribute:void 0,p=typeof s=="object"&&typeof s.maxStringLength=="number"?s.maxStringLength:void 0;p&&p>ua&&(Ar&&J.warn(`\`dom.maxStringLength\` cannot exceed 1024, but a value of ${p} was configured. Sentry will use 1024 instead.`),p=ua),typeof h=="string"&&(h=[h]);try{const b=a.event,v=function(_){return!!_&&!!_.target}(b)?b.target:b;l=ms(v,{keyAttrs:h,maxStringLength:p}),c=function(_){if(!lr.HTMLElement)return null;let S=_;for(let L=0;L<5;L++){if(!S)return null;if(S instanceof HTMLElement){if(S.dataset.sentryComponent)return S.dataset.sentryComponent;if(S.dataset.sentryElement)return S.dataset.sentryElement}S=S.parentNode}return null}(v)}catch{l="<unknown>"}if(l.length===0)return;const m={category:`ui.${a.name}`,message:l};c&&(m.data={"ui.component_name":c}),mt(m,{event:a.event,name:a.name,global:a.global})}}(n,e.dom),ht("dom",r),pt("dom",pl)),e.xhr&&function(i){ht("xhr",i),pt("xhr",ml)}(function(i){return function(s){if(fe()!==i)return;const{startTimestamp:a,endTimestamp:l}=s,c=s.xhr[Gt];if(!a||!l||!c)return;const{method:h,url:p,status_code:m,body:b}=c,v={method:h,url:p,status_code:m},_={xhr:s.xhr,input:b,startTimestamp:a,endTimestamp:l};mt({category:"xhr",data:v,type:"http",level:fs(m)},_)}}(n)),e.fetch&&xc(function(i){return function(s){if(fe()!==i)return;const{startTimestamp:a,endTimestamp:l}=s;if(l&&(!s.fetchData.url.match(/sentry_key/)||s.fetchData.method!=="POST"))if(s.error)mt({category:"fetch",data:s.fetchData,level:"error",type:"http"},{data:s.error,input:s.args,startTimestamp:a,endTimestamp:l});else{const c=s.response,h={...s.fetchData,status_code:c&&c.status},p={input:s.args,response:c,startTimestamp:a,endTimestamp:l};mt({category:"fetch",data:h,type:"http",level:fs(h.status_code)},p)}}}(n)),e.history&&function(i){const s="history";ht(s,i),pt(s,fl)}(function(i){return function(s){if(fe()!==i)return;let a=s.from,l=s.to;const c=br(ae.location.href);let h=a?br(a):void 0;const p=br(l);h&&h.path||(h=c),c.protocol===p.protocol&&c.host===p.host&&(l=p.relative),c.protocol===h.protocol&&c.host===h.host&&(a=h.relative),mt({category:"navigation",data:{from:a,to:l}})}}(n)),e.sentry&&n.on("beforeSendEvent",function(i){return function(s){fe()===i&&mt({category:"sentry."+(s.type==="transaction"?"transaction":"event"),event_id:s.event_id,level:s.level,message:Xe(s)},{event:s})}}(n))}}},Cl=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],El=(t={})=>{const e={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,...t};return{name:"BrowserApiErrors",setupOnce(){e.setTimeout&&ge(ae,"setTimeout",da),e.setInterval&&ge(ae,"setInterval",da),e.requestAnimationFrame&&ge(ae,"requestAnimationFrame",Ml),e.XMLHttpRequest&&"XMLHttpRequest"in ae&&ge(XMLHttpRequest.prototype,"send",Tl);const n=e.eventTarget;n&&(Array.isArray(n)?n:Cl).forEach(Ol)}}};function da(t){return function(...e){const n=e[0];return e[0]=jt(n,{mechanism:{data:{function:Ke(t)},handled:!1,type:"instrument"}}),t.apply(this,e)}}function Ml(t){return function(e){return t.apply(this,[jt(e,{mechanism:{data:{function:"requestAnimationFrame",handler:Ke(t)},handled:!1,type:"instrument"}})])}}function Tl(t){return function(...e){const n=this;return["onload","onerror","onprogress","onreadystatechange"].forEach(r=>{r in n&&typeof n[r]=="function"&&ge(n,r,function(i){const s={mechanism:{data:{function:r,handler:Ke(i)},handled:!1,type:"instrument"}},a=hr(i);return a&&(s.mechanism.data.handler=Ke(a)),jt(i,s)})}),t.apply(this,e)}}function Ol(t){const e=ae,n=e[t]&&e[t].prototype;n&&n.hasOwnProperty&&n.hasOwnProperty("addEventListener")&&(ge(n,"addEventListener",function(r){return function(i,s,a){try{typeof s.handleEvent=="function"&&(s.handleEvent=jt(s.handleEvent,{mechanism:{data:{function:"handleEvent",handler:Ke(s),target:t},handled:!1,type:"instrument"}}))}catch{}return r.apply(this,[i,jt(s,{mechanism:{data:{function:"addEventListener",handler:Ke(s),target:t},handled:!1,type:"instrument"}}),a])}}),ge(n,"removeEventListener",function(r){return function(i,s,a){const l=s;try{const c=l&&l.__sentry_wrapped__;c&&r.call(this,i,c,a)}catch{}return r.call(this,i,l,a)}}))}const Al=(t={})=>{const e={onerror:!0,onunhandledrejection:!0,...t};return{name:"GlobalHandlers",setupOnce(){Error.stackTraceLimit=50},setup(n){e.onerror&&(function(r){(function(i){const s="error";ht(s,i),pt(s,Pc)})(i=>{const{stackParser:s,attachStacktrace:a}=pa();if(fe()!==r||sa())return;const{msg:l,url:c,line:h,column:p,error:m}=i,b=function(v,_,S,L){const C=v.exception=v.exception||{},T=C.values=C.values||[],A=T[0]=T[0]||{},y=A.stacktrace=A.stacktrace||{},w=y.frames=y.frames||[],E=isNaN(parseInt(L,10))?void 0:L,k=isNaN(parseInt(S,10))?void 0:S,P=Be(_)&&_.length>0?_:function(){try{return lr.document.location.href}catch{return""}}();return w.length===0&&w.push({colno:E,filename:P,function:dt,in_app:!0,lineno:k}),v}(jr(s,m||l,void 0,a,!1),c,h,p);b.level="error",zs(b,{originalException:m,mechanism:{handled:!1,type:"onerror"}})})}(n),ha("onerror")),e.onunhandledrejection&&(function(r){(function(i){const s="unhandledrejection";ht(s,i),pt(s,Lc)})(i=>{const{stackParser:s,attachStacktrace:a}=pa();if(fe()!==r||sa())return;const l=function(h){if(or(h))return h;try{if("reason"in h)return h.reason;if("detail"in h&&"reason"in h.detail)return h.detail.reason}catch{}return h}(i),c=or(l)?{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(l)}`}]}}:jr(s,l,void 0,a,!0);c.level="error",zs(c,{originalException:l,mechanism:{handled:!1,type:"onunhandledrejection"}})})}(n),ha("onunhandledrejection"))}}};function ha(t){Ar&&J.log(`Global Handler attached: ${t}`)}function pa(){const t=fe();return t&&t.getOptions()||{stackParser:()=>[],attachStacktrace:!1}}const xl=()=>({name:"HttpContext",preprocessEvent(t){if(!ae.navigator&&!ae.location&&!ae.document)return;const e=t.request&&t.request.url||ae.location&&ae.location.href,{referrer:n}=ae.document||{},{userAgent:r}=ae.navigator||{},i={...t.request&&t.request.headers,...n&&{Referer:n},...r&&{"User-Agent":r}},s={...t.request,...e&&{url:e},headers:i};t.request=s}}),Pl=(t={})=>{const e=t.limit||5,n=t.key||"cause";return{name:"LinkedErrors",preprocessEvent(r,i,s){const a=s.getOptions();Cc(xr,a.stackParser,a.maxValueLength,n,e,r,i)}}};var fa="new",ma="loading",ga="loaded",Br="joining-meeting",gt="joined-meeting",vt="left-meeting",tt="error",Fr="unknown",Ll="full",jl="base",va="no-room",Dl="end-of-life",Il="connection-error",Nl="iframe-ready-for-launch-config",Rl="iframe-launch-config",Bl="theme-updated",Fl="loading",Ul="load-attempt-failed",ya="loaded",$l="started-camera",ql="camera-error",Jl="joining-meeting",Vl="joined-meeting",Wl="left-meeting",zl="participant-joined",Gl="participant-updated",Hl="participant-left",Ql="participant-counts-updated",Kl="access-state-updated",Yl="meeting-session-summary-updated",Xl="meeting-session-state-updated",Zl="waiting-participant-added",eu="waiting-participant-updated",tu="waiting-participant-removed",nu="track-started",ru="track-stopped",iu="transcription-started",su="transcription-stopped",au="transcription-error",ba="recording-started",_a="recording-stopped",ou="recording-stats",cu="recording-error",lu="recording-upload-completed",uu="recording-data",du="app-message",hu="transcription-message",pu="remote-media-player-started",fu="remote-media-player-updated",mu="remote-media-player-stopped",gu="local-screen-share-started",vu="local-screen-share-stopped",yu="local-screen-share-canceled",bu="active-speaker-change",_u="active-speaker-mode-change",wu="network-quality-change",Su="network-connection",ku="cpu-load-change",Cu="face-counts-updated",Pn="fullscreen",Ln="exited-fullscreen",Eu="live-streaming-started",Mu="live-streaming-updated",Tu="live-streaming-stopped",Ou="live-streaming-error",Au="lang-updated",xu="receive-settings-updated",Pu="input-settings-updated",wa="nonfatal-error",Sa="error",Ur=4096,ka=102400,$r="iframe-call-message",Ca="local-screen-start",Ea="daily-method-update-live-streaming-endpoints",jn="transmit-log",Ht="daily-custom-track",Dn={NONE:"none",BGBLUR:"background-blur",BGIMAGE:"background-image",FACE_DETECTION:"face-detection"},Ma={NONE:"none",NOISE_CANCELLATION:"noise-cancellation"},qr={PLAY:"play",PAUSE:"pause"},Jr=["jpg","png","jpeg"],Lu="add-endpoints",ju="remove-endpoints",Ta="sip-call-transfer";function we(){return!H()&&typeof window<"u"&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:""}function H(){return typeof navigator<"u"&&navigator.product&&navigator.product==="ReactNative"}function Oa(){return navigator&&navigator.mediaDevices&&navigator.mediaDevices.getUserMedia}function Du(){return!!(navigator&&navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)&&(function(t,e){if(!t||!e)return!0;switch(t){case"Chrome":return e.major>=75;case"Safari":return RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection")&&!(e.major===13&&e.minor===0&&e.point===0);case"Firefox":return e.major>=67}return!0}(yt(),Qt())||H())}function Aa(){if(H()||!document)return!1;var t=document.createElement("iframe");return!!t.requestFullscreen||!!t.webkitRequestFullscreen}var Iu=function(){try{var t=document.createElement("canvas"),e=t.getContext("webgl2")!=null;return t.remove(),e}catch{return!1}}();function xa(){var t=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return!H()&&!!Iu&&(t?function(){return Da()?!1:["Chrome","Firefox"].includes(yt())}():function(){if(Da())return!1;var e=yt();if(e==="Safari"){var n=Wr();if(n.major<15||n.major===15&&n.minor<4)return!1}return e==="Chrome"?Vr().major>=77:e==="Firefox"?zr().major>=97:["Chrome","Firefox","Safari"].includes(e)}())}function Pa(){if(H()||ja()||typeof AudioWorkletNode>"u")return!1;switch(yt()){case"Chrome":case"Firefox":return!0;case"Safari":return Qt().major>=17&&Qt().minor>=4}return!1}function La(){return Oa()&&!function(){var t,e=yt();if(!we())return!0;switch(e){case"Chrome":return(t=Vr()).major&&t.major>0&&t.major<75;case"Firefox":return(t=zr()).major<91;case"Safari":return(t=Wr()).major<13||t.major===13&&t.minor<1;default:return!0}}()}function ja(){return we().match(/Linux; Android/)}function Da(){var t,e,n=we(),r=n.match(/Mac/)&&(!H()&&typeof window<"u"&&(t=window)!==null&&t!==void 0&&(e=t.navigator)!==null&&e!==void 0&&e.maxTouchPoints?window.navigator.maxTouchPoints:0)>=5;return!!(n.match(/Mobi/)||n.match(/Android/)||r)||!!we().match(/DailyAnd\//)||void 0}function yt(){if(typeof window<"u"){var t=we();return Ia()?"Safari":t.indexOf("Edge")>-1?"Edge":t.match(/Chrome\//)?"Chrome":t.indexOf("Safari")>-1||Na()?"Safari":t.indexOf("Firefox")>-1?"Firefox":t.indexOf("MSIE")>-1||t.indexOf(".NET")>-1?"IE":"Unknown Browser"}}function Qt(){switch(yt()){case"Chrome":return Vr();case"Safari":return Wr();case"Firefox":return zr();case"Edge":return function(){var t=0,e=0;if(typeof window<"u"){var n=we().match(/Edge\/(\d+).(\d+)/);if(n)try{t=parseInt(n[1]),e=parseInt(n[2])}catch{}}return{major:t,minor:e}}()}}function Vr(){var t=0,e=0,n=0,r=0,i=!1;if(typeof window<"u"){var s=we(),a=s.match(/Chrome\/(\d+).(\d+).(\d+).(\d+)/);if(a)try{t=parseInt(a[1]),e=parseInt(a[2]),n=parseInt(a[3]),r=parseInt(a[4]),i=s.indexOf("OPR/")>-1}catch{}}return{major:t,minor:e,build:n,patch:r,opera:i}}function Ia(){return!!we().match(/iPad|iPhone|iPod/i)&&Oa()}function Na(){return we().indexOf("AppleWebKit/605.1.15")>-1}function Wr(){var t=0,e=0,n=0;if(typeof window<"u"){var r=we().match(/Version\/(\d+).(\d+)(.(\d+))?/);if(r)try{t=parseInt(r[1]),e=parseInt(r[2]),n=parseInt(r[4])}catch{}else(Ia()||Na())&&(t=14,e=0,n=3)}return{major:t,minor:e,point:n}}function zr(){var t=0,e=0;if(typeof window<"u"){var n=we().match(/Firefox\/(\d+).(\d+)/);if(n)try{t=parseInt(n[1]),e=parseInt(n[2])}catch{}}return{major:t,minor:e}}var Ra=function(){function t(){Se(this,t)}return ke(t,[{key:"addListenerForMessagesFromCallMachine",value:function(e,n,r){$t()}},{key:"addListenerForMessagesFromDailyJs",value:function(e,n,r){$t()}},{key:"sendMessageToCallMachine",value:function(e,n,r,i){$t()}},{key:"sendMessageToDailyJs",value:function(e,n){$t()}},{key:"removeListener",value:function(e){$t()}}]),t}();function Ba(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Gr(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Ba(Object(n),!0).forEach(function(r){Ne(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ba(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Nu(t){var e=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var n,r=Ce(t);if(e){var i=Ce(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ln(this,n)}}var Ru=function(){cn(e,Ra);var t=Nu(e);function e(){var n;return Se(this,e),(n=t.call(this))._wrappedListeners={},n._messageCallbacks={},n}return ke(e,[{key:"addListenerForMessagesFromCallMachine",value:function(n,r,i){var s=this,a=function(l){if(l.data&&l.data.what==="iframe-call-message"&&(!l.data.callClientId||l.data.callClientId===r)&&(!l.data.from||l.data.from!=="module")){var c=Gr({},l.data);if(delete c.from,c.callbackStamp&&s._messageCallbacks[c.callbackStamp]){var h=c.callbackStamp;s._messageCallbacks[h].call(i,c),delete s._messageCallbacks[h]}delete c.what,delete c.callbackStamp,n.call(i,c)}};this._wrappedListeners[n]=a,window.addEventListener("message",a)}},{key:"addListenerForMessagesFromDailyJs",value:function(n,r,i){var s=function(a){var l;if(!(!a.data||a.data.what!==$r||!a.data.action||a.data.from&&a.data.from!=="module"||a.data.callClientId&&r&&a.data.callClientId!==r||a!=null&&(l=a.data)!==null&&l!==void 0&&l.callFrameId)){var c=a.data;n.call(i,c)}};this._wrappedListeners[n]=s,window.addEventListener("message",s)}},{key:"sendMessageToCallMachine",value:function(n,r,i,s){if(!i)throw new Error("undefined callClientId. Are you trying to use a DailyCall instance previously destroyed?");var a=Gr({},n);if(a.what=$r,a.from="module",a.callClientId=i,r){var l=dn();this._messageCallbacks[l]=r,a.callbackStamp=l}var c=s?s.contentWindow:window,h=this._callMachineTargetOrigin(s);h&&c.postMessage(a,h)}},{key:"sendMessageToDailyJs",value:function(n,r){n.what=$r,n.callClientId=r,n.from="embedded",window.postMessage(n,this._targetOriginFromWindowLocation())}},{key:"removeListener",value:function(n){var r=this._wrappedListeners[n];r&&(window.removeEventListener("message",r),delete this._wrappedListeners[n])}},{key:"forwardPackagedMessageToCallMachine",value:function(n,r,i){var s=Gr({},n);s.callClientId=i;var a=r?r.contentWindow:window,l=this._callMachineTargetOrigin(r);l&&a.postMessage(s,l)}},{key:"addListenerForPackagedMessagesFromCallMachine",value:function(n,r){var i=function(s){if(s.data&&s.data.what==="iframe-call-message"&&(!s.data.callClientId||s.data.callClientId===r)&&(!s.data.from||s.data.from!=="module")){var a=s.data;n(a)}};return this._wrappedListeners[n]=i,window.addEventListener("message",i),n}},{key:"removeListenerForPackagedMessagesFromCallMachine",value:function(n){var r=this._wrappedListeners[n];r&&(window.removeEventListener("message",r),delete this._wrappedListeners[n])}},{key:"_callMachineTargetOrigin",value:function(n){return n?n.src?new URL(n.src).origin:void 0:this._targetOriginFromWindowLocation()}},{key:"_targetOriginFromWindowLocation",value:function(){return window.location.protocol==="file:"?"*":window.location.origin}}]),e}();function Fa(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Bu(t){var e=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var n,r=Ce(t);if(e){var i=Ce(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ln(this,n)}}var Fu=function(){cn(e,Ra);var t=Bu(e);function e(){var n;return Se(this,e),n=t.call(this),global.callMachineToDailyJsEmitter=global.callMachineToDailyJsEmitter||new Re.EventEmitter,global.dailyJsToCallMachineEmitter=global.dailyJsToCallMachineEmitter||new Re.EventEmitter,n._wrappedListeners={},n._messageCallbacks={},n}return ke(e,[{key:"addListenerForMessagesFromCallMachine",value:function(n,r,i){this._addListener(n,global.callMachineToDailyJsEmitter,r,i,"received call machine message")}},{key:"addListenerForMessagesFromDailyJs",value:function(n,r,i){this._addListener(n,global.dailyJsToCallMachineEmitter,r,i,"received daily-js message")}},{key:"sendMessageToCallMachine",value:function(n,r,i){this._sendMessage(n,global.dailyJsToCallMachineEmitter,i,r,"sending message to call machine")}},{key:"sendMessageToDailyJs",value:function(n,r){this._sendMessage(n,global.callMachineToDailyJsEmitter,r,null,"sending message to daily-js")}},{key:"removeListener",value:function(n){var r=this._wrappedListeners[n];r&&(global.callMachineToDailyJsEmitter.removeListener("message",r),global.dailyJsToCallMachineEmitter.removeListener("message",r),delete this._wrappedListeners[n])}},{key:"_addListener",value:function(n,r,i,s,a){var l=this,c=function(h){if(h.callClientId===i){if(h.callbackStamp&&l._messageCallbacks[h.callbackStamp]){var p=h.callbackStamp;l._messageCallbacks[p].call(s,h),delete l._messageCallbacks[p]}n.call(s,h)}};this._wrappedListeners[n]=c,r.addListener("message",c)}},{key:"_sendMessage",value:function(n,r,i,s,a){var l=function(h){for(var p=1;p<arguments.length;p++){var m=arguments[p]!=null?arguments[p]:{};p%2?Fa(Object(m),!0).forEach(function(b){Ne(h,b,m[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(m)):Fa(Object(m)).forEach(function(b){Object.defineProperty(h,b,Object.getOwnPropertyDescriptor(m,b))})}return h}({},n);if(l.callClientId=i,s){var c=dn();this._messageCallbacks[c]=s,l.callbackStamp=c}r.emit("message",l)}}]),e}(),Hr="replace",Qr="shallow-merge",Ua=[Hr,Qr],Uu=function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.data,r=e.mergeStrategy,i=r===void 0?Hr:r;Se(this,t),t._validateMergeStrategy(i),t._validateData(n,i),this.mergeStrategy=i,this.data=n}return ke(t,[{key:"isNoOp",value:function(){return t.isNoOpUpdate(this.data,this.mergeStrategy)}}],[{key:"isNoOpUpdate",value:function(e,n){return Object.keys(e).length===0&&n===Qr}},{key:"_validateMergeStrategy",value:function(e){if(!Ua.includes(e))throw Error("Unrecognized mergeStrategy provided. Options are: [".concat(Ua,"]"))}},{key:"_validateData",value:function(e,n){if(!function(l){if(l==null||Q(l)!=="object")return!1;var c=Object.getPrototypeOf(l);return c==null||c===Object.prototype}(e))throw Error("Meeting session data must be a plain (map-like) object");var r;try{if(r=JSON.stringify(e),n===Hr){var i=JSON.parse(r);pe(i,e)||console.warn("The meeting session data provided will be modified when serialized.",i,e)}else if(n===Qr){for(var s in e)if(Object.hasOwnProperty.call(e,s)&&e[s]!==void 0){var a=JSON.parse(JSON.stringify(e[s]));pe(e[s],a)||console.warn("At least one key in the meeting session data provided will be modified when serialized.",a,e[s])}}}catch(l){throw Error("Meeting session data must be serializable to JSON: ".concat(l))}if(r.length>ka)throw Error("Meeting session data is too large (".concat(r.length," characters). Maximum size suppported is ").concat(ka,"."))}}]),t}();function Kr(t,e,n){return Kr=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}()?Reflect.construct.bind():function(r,i,s){var a=[null];a.push.apply(a,i);var l=new(Function.bind.apply(r,a));return s&&Ut(l,s.prototype),l},Kr.apply(null,arguments)}function Yr(t){var e=typeof Map=="function"?new Map:void 0;return Yr=function(n){if(n===null||(r=n,Function.toString.call(r).indexOf("[native code]")===-1))return n;var r;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(e!==void 0){if(e.has(n))return e.get(n);e.set(n,i)}function i(){return Kr(n,arguments,Ce(this).constructor)}return i.prototype=Object.create(n.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),Ut(i,n)},Yr(t)}function $u(t){var e=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var n,r=Ce(t);if(e){var i=Ce(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ln(this,n)}}function $a(t){var e,n=(e=window._daily)===null||e===void 0?void 0:e.pendings;if(n){var r=n.indexOf(t);r!==-1&&n.splice(r,1)}}var qu=function(){function t(e){Se(this,t),this._currentLoad=null,this._callClientId=e}return ke(t,[{key:"load",value:function(){var e,n=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0,s=arguments.length>2?arguments[2]:void 0;if(this.loaded)return window._daily.instances[this._callClientId].callMachine.reset(),void i(!0);e=this._callClientId,window._daily.pendings.push(e),this._currentLoad&&this._currentLoad.cancel(),this._currentLoad=new Ju(r,function(){i(!1)},function(a,l){l||$a(n._callClientId),s(a,l)}),this._currentLoad.start()}},{key:"cancel",value:function(){this._currentLoad&&this._currentLoad.cancel(),$a(this._callClientId)}},{key:"loaded",get:function(){return this._currentLoad&&this._currentLoad.succeeded}}]),t}(),Ju=function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;Se(this,t),this._attemptsRemaining=3,this._currentAttempt=null,this._dailyConfig=e,this._successCallback=n,this._failureCallback=r}return ke(t,[{key:"start",value:function(){var e=this;this._currentAttempt||(this._currentAttempt=new qa(this._dailyConfig,this._successCallback,function n(r){e._currentAttempt.cancelled||(e._attemptsRemaining--,e._failureCallback(r,e._attemptsRemaining>0),e._attemptsRemaining<=0||setTimeout(function(){e._currentAttempt.cancelled||(e._currentAttempt=new qa(e._dailyConfig,e._successCallback,n),e._currentAttempt.start())},3e3))}),this._currentAttempt.start())}},{key:"cancel",value:function(){this._currentAttempt&&this._currentAttempt.cancel()}},{key:"cancelled",get:function(){return this._currentAttempt&&this._currentAttempt.cancelled}},{key:"succeeded",get:function(){return this._currentAttempt&&this._currentAttempt.succeeded}}]),t}(),Xr=function(){cn(e,Yr(Error));var t=$u(e);function e(){return Se(this,e),t.apply(this,arguments)}return ke(e)}(),In=2e4,qa=function(){function t(n,r,i){Se(this,t),this._loadAttemptImpl=H()||!n.avoidEval?new Vu(n,r,i):new Wu(n,r,i)}var e;return ke(t,[{key:"start",value:(e=U(function*(){return this._loadAttemptImpl.start()}),function(){return e.apply(this,arguments)})},{key:"cancel",value:function(){this._loadAttemptImpl.cancel()}},{key:"cancelled",get:function(){return this._loadAttemptImpl.cancelled}},{key:"succeeded",get:function(){return this._loadAttemptImpl.succeeded}}]),t}(),Vu=function(){function t(s,a,l){Se(this,t),this.cancelled=!1,this.succeeded=!1,this._networkTimedOut=!1,this._networkTimeout=null,this._iosCache=typeof iOSCallObjectBundleCache<"u"&&iOSCallObjectBundleCache,this._refetchHeaders=null,this._dailyConfig=s,this._successCallback=a,this._failureCallback=l}var e,n,r,i;return ke(t,[{key:"start",value:(i=U(function*(){var s=hn(this._dailyConfig);!(yield this._tryLoadFromIOSCache(s))&&this._loadFromNetwork(s)}),function(){return i.apply(this,arguments)})},{key:"cancel",value:function(){clearTimeout(this._networkTimeout),this.cancelled=!0}},{key:"_tryLoadFromIOSCache",value:(r=U(function*(s){if(!this._iosCache)return!1;try{var a=yield this._iosCache.get(s);return!!this.cancelled||!!a&&(a.code?(Function('"use strict";'+a.code)(),this.succeeded=!0,this._successCallback(),!0):(this._refetchHeaders=a.refetchHeaders,!1))}catch{return!1}}),function(s){return r.apply(this,arguments)})},{key:"_loadFromNetwork",value:(n=U(function*(s){var a=this;this._networkTimeout=setTimeout(function(){a._networkTimedOut=!0,a._failureCallback({msg:"Timed out (>".concat(In," ms) when loading call object bundle ").concat(s),type:"timeout"})},In);try{var l=this._refetchHeaders?{headers:this._refetchHeaders}:{},c=yield fetch(s,l);if(clearTimeout(this._networkTimeout),this.cancelled||this._networkTimedOut)throw new Xr;var h=yield this._getBundleCodeFromResponse(s,c);if(this.cancelled)throw new Xr;Function('"use strict";'+h)(),this._iosCache&&this._iosCache.set(s,h,c.headers),this.succeeded=!0,this._successCallback()}catch(p){if(clearTimeout(this._networkTimeout),p instanceof Xr||this.cancelled||this._networkTimedOut)return;this._failureCallback({msg:"Failed to load call object bundle ".concat(s,": ").concat(p),type:p.message})}}),function(s){return n.apply(this,arguments)})},{key:"_getBundleCodeFromResponse",value:(e=U(function*(s,a){if(a.ok)return yield a.text();if(this._iosCache&&a.status===304)return(yield this._iosCache.renew(s,a.headers)).code;throw new Error("Received ".concat(a.status," response"))}),function(s,a){return e.apply(this,arguments)})}]),t}(),Wu=function(){function t(e,n,r){Se(this,t),this.cancelled=!1,this.succeeded=!1,this._dailyConfig=e,this._successCallback=n,this._failureCallback=r,this._attemptId=dn(),this._networkTimeout=null,this._scriptElement=null}return ke(t,[{key:"start",value:function(){window._dailyCallMachineLoadWaitlist||(window._dailyCallMachineLoadWaitlist=new Set);var e=hn(this._dailyConfig);(typeof document>"u"?"undefined":Q(document))==="object"?this._startLoading(e):this._failureCallback({msg:"Call object bundle must be loaded in a DOM/web context",type:"missing context"})}},{key:"cancel",value:function(){this._stopLoading(),this.cancelled=!0}},{key:"_startLoading",value:function(e){var n=this;this._signUpForCallMachineLoadWaitlist(),this._networkTimeout=setTimeout(function(){n._stopLoading(),n._failureCallback({msg:"Timed out (>".concat(In," ms) when loading call object bundle ").concat(e),type:"timeout"})},In);var r=document.getElementsByTagName("head")[0],i=document.createElement("script");this._scriptElement=i,i.onload=function(){n._stopLoading(),n.succeeded=!0,n._successCallback()},i.onerror=function(s){n._stopLoading(),n._failureCallback({msg:"Failed to load call object bundle ".concat(s.target.src),type:s.message})},i.src=e,r.appendChild(i)}},{key:"_stopLoading",value:function(){this._withdrawFromCallMachineLoadWaitlist(),clearTimeout(this._networkTimeout),this._scriptElement&&(this._scriptElement.onload=null,this._scriptElement.onerror=null)}},{key:"_signUpForCallMachineLoadWaitlist",value:function(){window._dailyCallMachineLoadWaitlist.add(this._attemptId)}},{key:"_withdrawFromCallMachineLoadWaitlist",value:function(){window._dailyCallMachineLoadWaitlist.delete(this._attemptId)}}]),t}(),Nn=function(t,e,n){return Gu(t.local,e,n)===!0},zu=function(t,e,n){return t.local.streams&&t.local.streams[e]&&t.local.streams[e].stream&&t.local.streams[e].stream["get".concat(n==="video"?"Video":"Audio","Tracks")]()[0]},Dt=function(t,e,n,r){var i=Hu(t,e,n,r);return i&&i.pendingTrack},Gu=function(t,e,n){if(!t)return!1;var r=function(s){switch(s){case"avatar":return!0;case"staged":return s;default:return!!s}},i=t.public.subscribedTracks;return i&&i[e]?["cam-audio","cam-video","screen-video","screen-audio","rmpAudio","rmpVideo"].indexOf(n)===-1&&i[e].custom?[!0,"staged"].includes(i[e].custom)?r(i[e].custom):r(i[e].custom[n]):r(i[e][n]):!i||r(i.ALL)},Hu=function(t,e,n,r){var i=Object.values(t.streams||{}).filter(function(s){return s.participantId===e&&s.type===n&&s.pendingTrack&&s.pendingTrack.kind===r}).sort(function(s,a){return new Date(a.starttime)-new Date(s.starttime)});return i&&i[0]},Qu=function(t,e){var n=t.local.public.customTracks;if(n&&n[e])return n[e].track};function Ja(t,e){for(var n=e.getState(),r=0,i=["cam","screen"];r<i.length;r++)for(var s=i[r],a=0,l=["video","audio"];a<l.length;a++){var c=l[a],h=s==="cam"?c:"screen".concat(c.charAt(0).toUpperCase()+c.slice(1)),p=t.tracks[h];if(p){var m=t.local?zu(n,s,c):Dt(n,t.session_id,s,c);p.state==="playable"&&(p.track=m),p.persistentTrack=m}}}function Va(t,e){try{var n=e.getState();for(var r in t.tracks)if(!Ku(r)){var i=t.tracks[r].kind;if(i){var s=t.tracks[r];if(s){var a=t.local?Qu(n,r):Dt(n,t.session_id,r,i);s.state==="playable"&&(t.tracks[r].track=a),s.persistentTrack=a}}else console.error("unknown type for custom track")}}catch(l){console.error(l)}}function Ku(t){return["video","audio","screenVideo","screenAudio"].includes(t)}function Wa(t,e,n){var r=n.getState();if(t.local){if(t.audio)try{t.audioTrack=r.local.streams.cam.stream.getAudioTracks()[0],t.audioTrack||(t.audio=!1)}catch{}if(t.video)try{t.videoTrack=r.local.streams.cam.stream.getVideoTracks()[0],t.videoTrack||(t.video=!1)}catch{}if(t.screen)try{t.screenVideoTrack=r.local.streams.screen.stream.getVideoTracks()[0],t.screenAudioTrack=r.local.streams.screen.stream.getAudioTracks()[0],t.screenVideoTrack||t.screenAudioTrack||(t.screen=!1)}catch{}}else{var i=!0;try{var s=r.participants[t.session_id];s&&s.public&&s.public.rtcType&&s.public.rtcType.impl==="peer-to-peer"&&s.private&&!["connected","completed"].includes(s.private.peeringState)&&(i=!1)}catch(p){console.error(p)}if(!i)return t.audio=!1,t.audioTrack=!1,t.video=!1,t.videoTrack=!1,t.screen=!1,void(t.screenTrack=!1);try{if(r.streams,t.audio&&Nn(r,t.session_id,"cam-audio")){var a=Dt(r,t.session_id,"cam","audio");a&&(e&&e.audioTrack&&e.audioTrack.id===a.id?t.audioTrack=a:a.muted||(t.audioTrack=a)),t.audioTrack||(t.audio=!1)}if(t.video&&Nn(r,t.session_id,"cam-video")){var l=Dt(r,t.session_id,"cam","video");l&&(e&&e.videoTrack&&e.videoTrack.id===l.id?t.videoTrack=l:l.muted||(t.videoTrack=l)),t.videoTrack||(t.video=!1)}if(t.screen&&Nn(r,t.session_id,"screen-audio")){var c=Dt(r,t.session_id,"screen","audio");c&&(e&&e.screenAudioTrack&&e.screenAudioTrack.id===c.id?t.screenAudioTrack=c:c.muted||(t.screenAudioTrack=c))}if(t.screen&&Nn(r,t.session_id,"screen-video")){var h=Dt(r,t.session_id,"screen","video");h&&(e&&e.screenVideoTrack&&e.screenVideoTrack.id===h.id?t.screenVideoTrack=h:h.muted||(t.screenVideoTrack=h))}t.screenVideoTrack||t.screenAudioTrack||(t.screen=!1)}catch(p){console.error("unexpected error matching up tracks",p)}}}function Yu(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(c,h){if(c){if(typeof c=="string")return za(c,h);var p=Object.prototype.toString.call(c).slice(8,-1);if(p==="Object"&&c.constructor&&(p=c.constructor.name),p==="Map"||p==="Set")return Array.from(c);if(p==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(p))return za(c,h)}}(t))||e){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s,a=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var c=n.next();return a=c.done,c},e:function(c){l=!0,s=c},f:function(){try{a||n.return==null||n.return()}finally{if(l)throw s}}}}function za(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Pe=new Map,It=null;function Xu(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(c,h){if(c){if(typeof c=="string")return Ga(c,h);var p=Object.prototype.toString.call(c).slice(8,-1);if(p==="Object"&&c.constructor&&(p=c.constructor.name),p==="Map"||p==="Set")return Array.from(c);if(p==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(p))return Ga(c,h)}}(t))||e){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s,a=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var c=n.next();return a=c.done,c},e:function(c){l=!0,s=c},f:function(){try{a||n.return==null||n.return()}finally{if(l)throw s}}}}function Ga(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Le=new Map,Kt=null;function Zu(t){Ha()?function(e){Pe.has(e)||(Pe.set(e,{}),navigator.mediaDevices.enumerateDevices().then(function(n){Pe.has(e)&&(Pe.get(e).lastDevicesString=JSON.stringify(n),It||(It=function(){var r=U(function*(){var i,s=yield navigator.mediaDevices.enumerateDevices(),a=Yu(Pe.keys());try{for(a.s();!(i=a.n()).done;){var l=i.value,c=JSON.stringify(s);c!==Pe.get(l).lastDevicesString&&(Pe.get(l).lastDevicesString=c,l(s))}}catch(h){a.e(h)}finally{a.f()}});return function(){return r.apply(this,arguments)}}(),navigator.mediaDevices.addEventListener("devicechange",It)))}).catch(function(){}))}(t):function(e){Le.has(e)||(Le.set(e,{}),navigator.mediaDevices.enumerateDevices().then(function(n){Le.has(e)&&(Le.get(e).lastDevicesString=JSON.stringify(n),Kt||(Kt=setInterval(U(function*(){var r,i=yield navigator.mediaDevices.enumerateDevices(),s=Xu(Le.keys());try{for(s.s();!(r=s.n()).done;){var a=r.value,l=JSON.stringify(i);l!==Le.get(a).lastDevicesString&&(Le.get(a).lastDevicesString=l,a(i))}}catch(c){s.e(c)}finally{s.f()}}),3e3)))}))}(t)}function ed(t){Ha()?function(e){Pe.has(e)&&(Pe.delete(e),Pe.size===0&&It&&(navigator.mediaDevices.removeEventListener("devicechange",It),It=null))}(t):function(e){Le.has(e)&&(Le.delete(e),Le.size===0&&Kt&&(clearInterval(Kt),Kt=null))}(t)}function Ha(){return H()||navigator.mediaDevices.ondevicechange!==void 0}var td=new Set;function nd(t,e){return t&&t.readyState==="live"&&!function(n,r){return n.muted&&!td.has(n.id)}(t)}var rd=["result"],id=["preserveIframe"];function Qa(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function $(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Qa(Object(n),!0).forEach(function(r){Ne(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Qa(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function sd(t){var e=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var n,r=Ce(t);if(e){var i=Ce(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ln(this,n)}}function Ka(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(c,h){if(c){if(typeof c=="string")return Ya(c,h);var p=Object.prototype.toString.call(c).slice(8,-1);if(p==="Object"&&c.constructor&&(p=c.constructor.name),p==="Map"||p==="Set")return Array.from(c);if(p==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(p))return Ya(c,h)}}(t))||e){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s,a=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var c=n.next();return a=c.done,c},e:function(c){l=!0,s=c},f:function(){try{a||n.return==null||n.return()}finally{if(l)throw s}}}}function Ya(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var bt={},Xa="video",ad="voice",Za=H()?{data:{}}:{data:{},topology:"none"},eo={present:0,hidden:0},to={maxBitrate:{min:1e5,max:25e5},maxFramerate:{min:1,max:30},scaleResolutionDownBy:{min:1,max:8}},Zr=Object.keys(to),no=["state","volume","simulcastEncodings"],ro={androidInCallNotification:{title:"string",subtitle:"string",iconName:"string",disableForCustomOverride:"boolean"},disableAutoDeviceManagement:{audio:"boolean",video:"boolean"}},Rn={id:{iconPath:"string",iconPathDarkMode:"string",label:"string",tooltip:"string",visualState:"'default' | 'sidebar-open' | 'active'"}},ei={id:{allow:"string",controlledBy:"'*' | 'owners' | string[]",csp:"string",iconURL:"string",label:"string",loading:"'eager' | 'lazy'",location:"'main' | 'sidebar'",name:"string",referrerPolicy:"string",sandbox:"string",src:"string",srcdoc:"string",shared:"string[] | 'owners' | boolean"}},_t={customIntegrations:{validate:po,help:uo()},customTrayButtons:{validate:ho,help:"customTrayButtons should be a dictionary of the type ".concat(JSON.stringify(Rn))},url:{validate:function(t){return typeof t=="string"},help:"url should be a string"},baseUrl:{validate:function(t){return typeof t=="string"},help:"baseUrl should be a string"},token:{validate:function(t){return typeof t=="string"},help:"token should be a string",queryString:"t"},dailyConfig:{validate:function(t,e){try{return e.validateDailyConfig(t),!0}catch(n){console.error("Failed to validate dailyConfig",n)}return!1},help:"Unsupported dailyConfig. Check error logs for detailed info."},reactNativeConfig:{validate:function(t){return fo(t,ro)},help:"reactNativeConfig should look like ".concat(JSON.stringify(ro),", all fields optional")},lang:{validate:function(t){return["da","de","en-us","en","es","fi","fr","it","jp","ka","nl","no","pl","pt","pt-BR","ru","sv","tr","user"].includes(t)},help:"language not supported. Options are: da, de, en-us, en, es, fi, fr, it, jp, ka, nl, no, pl, pt, pt-BR, ru, sv, tr, user"},userName:!0,userData:{validate:function(t){try{return so(t),!0}catch(e){return console.error(e),!1}},help:"invalid userData type provided"},startVideoOff:!0,startAudioOff:!0,activeSpeakerMode:!0,showLeaveButton:!0,showLocalVideo:!0,showParticipantsBar:!0,showFullscreenButton:!0,showUserNameChangeUI:!0,iframeStyle:!0,customLayout:!0,cssFile:!0,cssText:!0,bodyClass:!0,videoSource:{validate:function(t,e){return t instanceof MediaStreamTrack&&(e._sharedTracks.videoDeviceId=t),e._preloadCache.videoDeviceId=t,!0}},audioSource:{validate:function(t,e){return t instanceof MediaStreamTrack&&(e._sharedTracks.audioDeviceId=t),e._preloadCache.audioDeviceId=t,!0}},subscribeToTracksAutomatically:{validate:function(t,e){return e._preloadCache.subscribeToTracksAutomatically=t,!0}},theme:{validate:function(t){var e=["accent","accentText","background","backgroundAccent","baseText","border","mainAreaBg","mainAreaBgAccent","mainAreaText","supportiveText"],n=function(r){for(var i=0,s=Object.keys(r);i<s.length;i++){var a=s[i];if(!e.includes(a))return console.error('unsupported color "'.concat(a,'". Valid colors: ').concat(e.join(", "))),!1;if(!r[a].match(/^#[0-9a-f]{6}|#[0-9a-f]{3}$/i))return console.error("".concat(a,' theme color should be provided in valid hex color format. Received: "').concat(r[a],'"')),!1}return!0};return Q(t)==="object"&&("light"in t&&"dark"in t||"colors"in t)?"light"in t&&"dark"in t?"colors"in t.light?"colors"in t.dark?n(t.light.colors)&&n(t.dark.colors):(console.error('Dark theme is missing "colors" property.',t),!1):(console.error('Light theme is missing "colors" property.',t),!1):n(t.colors):(console.error('Theme must contain either both "light" and "dark" properties, or "colors".',t),!1)},help:"unsupported theme configuration. Check error logs for detailed info."},layoutConfig:{validate:function(t){if("grid"in t){var e=t.grid;if("maxTilesPerPage"in e){if(!Number.isInteger(e.maxTilesPerPage))return console.error("grid.maxTilesPerPage should be an integer. You passed ".concat(e.maxTilesPerPage,".")),!1;if(e.maxTilesPerPage>49)return console.error("grid.maxTilesPerPage can't be larger than 49 without sacrificing browser performance. Please contact us at https://www.daily.co/contact to talk about your use case."),!1}if("minTilesPerPage"in e){if(!Number.isInteger(e.minTilesPerPage))return console.error("grid.minTilesPerPage should be an integer. You passed ".concat(e.minTilesPerPage,".")),!1;if(e.minTilesPerPage<1)return console.error("grid.minTilesPerPage can't be lower than 1."),!1;if("maxTilesPerPage"in e&&e.minTilesPerPage>e.maxTilesPerPage)return console.error("grid.minTilesPerPage can't be higher than grid.maxTilesPerPage."),!1}}return!0},help:"unsupported layoutConfig. Check error logs for detailed info."},receiveSettings:{validate:function(t){return ao(t,{allowAllParticipantsKey:!1})},help:lo({allowAllParticipantsKey:!1})},sendSettings:{validate:function(t,e){return!!function(n,r){try{return r.validateUpdateSendSettings(n),!0}catch(i){return console.error("Failed to validate send settings",i),!1}}(t,e)&&(e._preloadCache.sendSettings=t,!0)},help:"Invalid sendSettings provided. Check error logs for detailed info."},inputSettings:{validate:function(t,e){var n;return!!oo(t)&&(e._preloadCache.inputSettings||(e._preloadCache.inputSettings={}),co(t,(n=e.properties)===null||n===void 0?void 0:n.dailyConfig),t.audio&&(e._preloadCache.inputSettings.audio=t.audio),t.video&&(e._preloadCache.inputSettings.video=t.video),!0)},help:ri()},layout:{validate:function(t){return t==="custom-v1"||t==="browser"||t==="none"},help:'layout may only be set to "custom-v1"',queryString:"layout"},emb:{queryString:"emb"},embHref:{queryString:"embHref"},dailyJsVersion:{queryString:"dailyJsVersion"},proxy:{queryString:"proxy"},strictMode:!0,allowMultipleCallInstances:!0},Bn={styles:{validate:function(t){for(var e in t)if(e!=="cam"&&e!=="screen")return!1;if(t.cam){for(var n in t.cam)if(n!=="div"&&n!=="video")return!1}if(t.screen){for(var r in t.screen)if(r!=="div"&&r!=="video")return!1}return!0},help:"styles format should be a subset of: { cam: {div: {}, video: {}}, screen: {div: {}, video: {}} }"},setSubscribedTracks:{validate:function(t,e){if(e._preloadCache.subscribeToTracksAutomatically)return!1;var n=[!0,!1,"staged"];if(n.includes(t)||!H()&&t==="avatar")return!0;var r=["audio","video","screenAudio","screenVideo","rmpAudio","rmpVideo"];return function i(s){var a=arguments.length>1&&arguments[1]!==void 0&&arguments[1];for(var l in s)if(l==="custom"){if(!n.includes(s[l])&&!i(s[l],!0))return!1}else{var c=!a&&!r.includes(l),h=!n.includes(s[l]);if(c||h)return!1}return!0}(t)},help:"setSubscribedTracks cannot be used when setSubscribeToTracksAutomatically is enabled, and should be of the form: "+"true".concat(H()?"":" | 'avatar'"," | false | 'staged' | { [audio: true|false|'staged'], [video: true|false|'staged'], [screenAudio: true|false|'staged'], [screenVideo: true|false|'staged'] }")},setAudio:!0,setVideo:!0,setScreenShare:{validate:function(t){return t===!1},help:"setScreenShare must be false, as it's only meant for stopping remote participants' screen shares"},eject:!0,updatePermissions:{validate:function(t){for(var e=0,n=Object.entries(t);e<n.length;e++){var r=ot(n[e],2),i=r[0],s=r[1];switch(i){case"hasPresence":if(typeof s!="boolean")return!1;break;case"canSend":if(s instanceof Set||s instanceof Array||Array.isArray(s)){var a,l=["video","audio","screenVideo","screenAudio","customVideo","customAudio"],c=Ka(s);try{for(c.s();!(a=c.n()).done;){var h=a.value;if(!l.includes(h))return!1}}catch(_){c.e(_)}finally{c.f()}}else if(typeof s!="boolean")return!1;(s instanceof Array||Array.isArray(s))&&(t.canSend=new Set(s));break;case"canAdmin":if(s instanceof Set||s instanceof Array||Array.isArray(s)){var p,m=["participants","streaming","transcription"],b=Ka(s);try{for(b.s();!(p=b.n()).done;){var v=p.value;if(!m.includes(v))return!1}}catch(_){b.e(_)}finally{b.f()}}else if(typeof s!="boolean")return!1;(s instanceof Array||Array.isArray(s))&&(t.canAdmin=new Set(s));break;default:return!1}}return!0},help:"updatePermissions can take hasPresence, canSend, and canAdmin permissions. hasPresence must be a boolean. canSend can be a boolean or an Array or Set of media types (video, audio, screenVideo, screenAudio, customVideo, customAudio). canAdmin can be a boolean or an Array or Set of admin types (participants, streaming, transcription)."}};Promise.any||(Promise.any=function(){var t=U(function*(e){return new Promise(function(n,r){var i=[];e.forEach(function(s){return Promise.resolve(s).then(function(a){n(a)}).catch(function(a){i.push(a),i.length===e.length&&r(i)})})})});return function(e){return t.apply(this,arguments)}}());var io=function(){cn(ue,Re);var t,e,n,r,i,s,a,l,c,h,p,m,b,v,_,S,L,C,T,A,y,w,E,k,P,I,x,N,q,oe,ye,je,nt,Ae,rt,$e,kt,qe,Bt=sd(ue);function ue(o){var u,d,g,f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(Se(this,ue),Ne(Ie(d=Bt.call(this)),"startListeningForDeviceChanges",function(){Zu(d.handleDeviceChange)}),Ne(Ie(d),"stopListeningForDeviceChanges",function(){ed(d.handleDeviceChange)}),Ne(Ie(d),"handleDeviceChange",function(D){D=D.map(function(B){return JSON.parse(JSON.stringify(B))}),d.emitDailyJSEvent({action:"available-devices-updated",availableDevices:D})}),Ne(Ie(d),"handleNativeAppStateChange",function(){var D=U(function*(B){if(B==="destroyed")return console.warn("App has been destroyed before leaving the meeting. Cleaning up all the resources!"),void(yield d.destroy());var W=B==="active";d.disableReactNativeAutoDeviceManagement("video")||(W?d.camUnmutedBeforeLosingNativeActiveState&&d.setLocalVideo(!0):(d.camUnmutedBeforeLosingNativeActiveState=d.localVideo(),d.camUnmutedBeforeLosingNativeActiveState&&d.setLocalVideo(!1)))});return function(B){return D.apply(this,arguments)}}()),Ne(Ie(d),"handleNativeAudioFocusChange",function(D){d.disableReactNativeAutoDeviceManagement("audio")||(d._hasNativeAudioFocus=D,d.toggleParticipantAudioBasedOnNativeAudioFocus(),d._hasNativeAudioFocus?d.micUnmutedBeforeLosingNativeAudioFocus&&d.setLocalAudio(!0):(d.micUnmutedBeforeLosingNativeAudioFocus=d.localAudio(),d.setLocalAudio(!1)))}),Ne(Ie(d),"handleNativeSystemScreenCaptureStop",function(){d.stopScreenShare()}),d.strictMode=f.strictMode===void 0||f.strictMode,d.allowMultipleCallInstances=(u=f.allowMultipleCallInstances)!==null&&u!==void 0&&u,Object.keys(bt).length&&(d._logDuplicateInstanceAttempt(),!d.allowMultipleCallInstances)){if(d.strictMode)throw new Error("Duplicate DailyIframe instances are not allowed");console.warn("Using strictMode: false to allow multiple call instances is now deprecated. Set `allowMultipleCallInstances: true`")}if(window._daily||(window._daily={pendings:[],instances:{}}),d.callClientId=dn(),g=Ie(d),bt[g.callClientId]=g,window._daily.instances[d.callClientId]={},d._sharedTracks={},window._daily.instances[d.callClientId].tracks=d._sharedTracks,f.dailyJsVersion=ue.version(),d._iframe=o,d._callObjectMode=f.layout==="none"&&!d._iframe,d._preloadCache={subscribeToTracksAutomatically:!0,audioDeviceId:null,videoDeviceId:null,outputDeviceId:null,inputSettings:null,sendSettings:null,videoTrackForNetworkConnectivityTest:null,videoTrackForConnectionQualityTest:null},f.showLocalVideo!==void 0?d._callObjectMode?console.error("showLocalVideo is not available in call object mode"):d._showLocalVideo=!!f.showLocalVideo:d._showLocalVideo=!0,f.showParticipantsBar!==void 0?d._callObjectMode?console.error("showParticipantsBar is not available in call object mode"):d._showParticipantsBar=!!f.showParticipantsBar:d._showParticipantsBar=!0,f.customIntegrations!==void 0?d._callObjectMode?console.error("customIntegrations is not available in call object mode"):d._customIntegrations=f.customIntegrations:d._customIntegrations={},f.customTrayButtons!==void 0?d._callObjectMode?console.error("customTrayButtons is not available in call object mode"):d._customTrayButtons=f.customTrayButtons:d._customTrayButtons={},f.activeSpeakerMode!==void 0?d._callObjectMode?console.error("activeSpeakerMode is not available in call object mode"):d._activeSpeakerMode=!!f.activeSpeakerMode:d._activeSpeakerMode=!1,f.receiveSettings?d._callObjectMode?d._receiveSettings=f.receiveSettings:console.error("receiveSettings is only available in call object mode"):d._receiveSettings={},d.validateProperties(f),d.properties=$({},f),d._preloadCache.inputSettings||(d._preloadCache.inputSettings={}),f.inputSettings&&f.inputSettings.audio&&(d._preloadCache.inputSettings.audio=f.inputSettings.audio),f.inputSettings&&f.inputSettings.video&&(d._preloadCache.inputSettings.video=f.inputSettings.video),d._callObjectLoader=d._callObjectMode?new qu(d.callClientId):null,d._callState=fa,d._isPreparingToJoin=!1,d._accessState={access:Fr},d._meetingSessionSummary={},d._finalSummaryOfPrevSession={},d._meetingSessionState=ii(Za,d._callObjectMode),d._nativeInCallAudioMode=Xa,d._participants={},d._isScreenSharing=!1,d._participantCounts=eo,d._rmpPlayerState={},d._waitingParticipants={},d._network={threshold:"good",quality:100},d._activeSpeaker={},d._localAudioLevel=0,d._isLocalAudioLevelObserverRunning=!1,d._remoteParticipantsAudioLevel={},d._isRemoteParticipantsAudioLevelObserverRunning=!1,d._maxAppMessageSize=Ur,d._messageChannel=H()?new Fu:new Ru,d._iframe&&(d._iframe.requestFullscreen?d._iframe.addEventListener("fullscreenchange",function(){document.fullscreenElement===d._iframe?(d.emitDailyJSEvent({action:Pn}),d.sendMessageToCallMachine({action:Pn})):(d.emitDailyJSEvent({action:Ln}),d.sendMessageToCallMachine({action:Ln}))}):d._iframe.webkitRequestFullscreen&&d._iframe.addEventListener("webkitfullscreenchange",function(){document.webkitFullscreenElement===d._iframe?(d.emitDailyJSEvent({action:Pn}),d.sendMessageToCallMachine({action:Pn})):(d.emitDailyJSEvent({action:Ln}),d.sendMessageToCallMachine({action:Ln}))})),H()){var M=d.nativeUtils();M.addAudioFocusChangeListener&&M.removeAudioFocusChangeListener&&M.addAppStateChangeListener&&M.removeAppStateChangeListener&&M.addSystemScreenCaptureStopListener&&M.removeSystemScreenCaptureStopListener||console.warn("expected (add|remove)(AudioFocusChange|AppActiveStateChange|SystemScreenCaptureStop)Listener to be available in React Native"),d._hasNativeAudioFocus=!0,M.addAudioFocusChangeListener(d.handleNativeAudioFocusChange),M.addAppStateChangeListener(d.handleNativeAppStateChange),M.addSystemScreenCaptureStopListener(d.handleNativeSystemScreenCaptureStop)}return d._callObjectMode&&d.startListeningForDeviceChanges(),d._messageChannel.addListenerForMessagesFromCallMachine(d.handleMessageFromCallMachine,d.callClientId,Ie(d)),d}return ke(ue,[{key:"destroy",value:(qe=U(function*(){var o,u;try{yield this.leave()}catch{}var d=this._iframe;if(d){var g=d.parentElement;g&&g.removeChild(d)}if(this._messageChannel.removeListener(this.handleMessageFromCallMachine),H()){var f=this.nativeUtils();f.removeAudioFocusChangeListener(this.handleNativeAudioFocusChange),f.removeAppStateChangeListener(this.handleNativeAppStateChange),f.removeSystemScreenCaptureStopListener(this.handleNativeSystemScreenCaptureStop)}this._callObjectMode&&this.stopListeningForDeviceChanges(),this.resetMeetingDependentVars(),this._destroyed=!0,this.emitDailyJSEvent({action:"call-instance-destroyed"}),delete bt[this.callClientId],!((o=window)===null||o===void 0||(u=o._daily)===null||u===void 0)&&u.instances&&delete window._daily.instances[this.callClientId],this.strictMode&&(this.callClientId=void 0)}),function(){return qe.apply(this,arguments)})},{key:"isDestroyed",value:function(){return!!this._destroyed}},{key:"loadCss",value:function(o){var u=o.bodyClass,d=o.cssFile,g=o.cssText;return V(),this.sendMessageToCallMachine({action:"load-css",cssFile:this.absoluteUrl(d),bodyClass:u,cssText:g}),this}},{key:"iframe",value:function(){return V(),this._iframe}},{key:"meetingState",value:function(){return this._callState}},{key:"accessState",value:function(){return Oe(this._callObjectMode,"accessState()"),this._accessState}},{key:"participants",value:function(){return this._participants}},{key:"participantCounts",value:function(){return this._participantCounts}},{key:"waitingParticipants",value:function(){return Oe(this._callObjectMode,"waitingParticipants()"),this._waitingParticipants}},{key:"validateParticipantProperties",value:function(o,u){for(var d in u){if(!Bn[d])throw new Error("unrecognized updateParticipant property ".concat(d));if(Bn[d].validate&&!Bn[d].validate(u[d],this,this._participants[o]))throw new Error(Bn[d].help)}}},{key:"updateParticipant",value:function(o,u){return this._participants.local&&this._participants.local.session_id===o&&(o="local"),o&&u&&(this.validateParticipantProperties(o,u),this.sendMessageToCallMachine({action:"update-participant",id:o,properties:u})),this}},{key:"updateParticipants",value:function(o){var u=this._participants.local&&this._participants.local.session_id;for(var d in o)d===u&&(d="local"),d&&o[d]&&this.validateParticipantProperties(d,o[d]);return this.sendMessageToCallMachine({action:"update-participants",participants:o}),this}},{key:"updateWaitingParticipant",value:(kt=U(function*(){var o=this,u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(Oe(this._callObjectMode,"updateWaitingParticipant()"),Z(this._callState,"updateWaitingParticipant()"),typeof u!="string"||Q(d)!=="object")throw new Error("updateWaitingParticipant() must take an id string and a updates object");return new Promise(function(g,f){o.sendMessageToCallMachine({action:"daily-method-update-waiting-participant",id:u,updates:d},function(M){M.error&&f(M.error),M.id||f(new Error("unknown error in updateWaitingParticipant()")),g({id:M.id})})})}),function(){return kt.apply(this,arguments)})},{key:"updateWaitingParticipants",value:($e=U(function*(){var o=this,u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Oe(this._callObjectMode,"updateWaitingParticipants()"),Z(this._callState,"updateWaitingParticipants()"),Q(u)!=="object")throw new Error("updateWaitingParticipants() must take a mapping between ids and update objects");return new Promise(function(d,g){o.sendMessageToCallMachine({action:"daily-method-update-waiting-participants",updatesById:u},function(f){f.error&&g(f.error),f.ids||g(new Error("unknown error in updateWaitingParticipants()")),d({ids:f.ids})})})}),function(){return $e.apply(this,arguments)})},{key:"requestAccess",value:(rt=U(function*(){var o=this,u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},d=u.access,g=d===void 0?{level:Ll}:d,f=u.name,M=f===void 0?"":f;return Oe(this._callObjectMode,"requestAccess()"),Z(this._callState,"requestAccess()"),new Promise(function(D,B){o.sendMessageToCallMachine({action:"daily-method-request-access",access:g,name:M},function(W){W.error&&B(W.error),W.access||B(new Error("unknown error in requestAccess()")),D({access:W.access,granted:W.granted})})})}),function(){return rt.apply(this,arguments)})},{key:"localAudio",value:function(){return this._participants.local?!["blocked","off"].includes(this._participants.local.tracks.audio.state):null}},{key:"localVideo",value:function(){return this._participants.local?!["blocked","off"].includes(this._participants.local.tracks.video.state):null}},{key:"setLocalAudio",value:function(o){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return"forceDiscardTrack"in u&&(H()?(console.warn("forceDiscardTrack option not supported in React Native; ignoring"),u={}):o&&(console.warn("forceDiscardTrack option only supported when calling setLocalAudio(false); ignoring"),u={})),this.sendMessageToCallMachine({action:"local-audio",state:o,options:u}),this}},{key:"localScreenAudio",value:function(){return this._participants.local?!["blocked","off"].includes(this._participants.local.tracks.screenAudio.state):null}},{key:"localScreenVideo",value:function(){return this._participants.local?!["blocked","off"].includes(this._participants.local.tracks.screenVideo.state):null}},{key:"updateScreenShare",value:function(o){if(this._isScreenSharing)return this.sendMessageToCallMachine({action:"local-screen-update",options:o}),this;console.warn("There is no screen share in progress. Try calling startScreenShare first.")}},{key:"setLocalVideo",value:function(o){return this.sendMessageToCallMachine({action:"local-video",state:o}),this}},{key:"getReceiveSettings",value:(Ae=U(function*(o){var u=this,d=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).showInheritedValues,g=d!==void 0&&d;if(Oe(this._callObjectMode,"getReceiveSettings()"),!this._callMachineInitialized)return this._receiveSettings;switch(Q(o)){case"string":return new Promise(function(f){u.sendMessageToCallMachine({action:"get-single-participant-receive-settings",id:o,showInheritedValues:g},function(M){f(M.receiveSettings)})});case"undefined":return this._receiveSettings;default:throw new Error('first argument to getReceiveSettings() must be a participant id (or "base"), or there should be no arguments')}}),function(o){return Ae.apply(this,arguments)})},{key:"updateReceiveSettings",value:(nt=U(function*(o){var u=this;if(Oe(this._callObjectMode,"updateReceiveSettings()"),!ao(o,{allowAllParticipantsKey:!0}))throw new Error(lo({allowAllParticipantsKey:!0}));return Z(this._callState,"updateReceiveSettings()","To specify receive settings earlier, use the receiveSettings config property."),new Promise(function(d){u.sendMessageToCallMachine({action:"update-receive-settings",receiveSettings:o},function(g){d({receiveSettings:g.receiveSettings})})})}),function(o){return nt.apply(this,arguments)})},{key:"_prepInputSettingsToPresentToUser",value:function(o){var u,d,g,f,M,D,B,W;if(o){var ce={},ne=((u=o.audio)===null||u===void 0||(d=u.processor)===null||d===void 0?void 0:d.type)==="none"&&((g=o.audio)===null||g===void 0||(f=g.processor)===null||f===void 0?void 0:f._isDefaultWhenNone);if(o.audio&&!ne){var Je=$({},o.audio.processor);delete Je._isDefaultWhenNone,ce.audio=$($({},o.audio),{},{processor:Je})}var it=((M=o.video)===null||M===void 0||(D=M.processor)===null||D===void 0?void 0:D.type)==="none"&&((B=o.video)===null||B===void 0||(W=B.processor)===null||W===void 0?void 0:W._isDefaultWhenNone);if(o.video&&!it){var Ve=$({},o.video.processor);delete Ve._isDefaultWhenNone,ce.video=$($({},o.video),{},{processor:Ve})}return ce}}},{key:"getInputSettings",value:function(){var o=this;return V(),new Promise(function(u){u(o._getInputSettings())})}},{key:"_getInputSettings",value:function(){var o,u,d,g,f,M,D,B,W={processor:{type:"none",_isDefaultWhenNone:!0}};this._inputSettings?(o=((d=this._inputSettings)===null||d===void 0?void 0:d.video)||W,u=((g=this._inputSettings)===null||g===void 0?void 0:g.audio)||W):(o=((f=this._preloadCache)===null||f===void 0||(M=f.inputSettings)===null||M===void 0?void 0:M.video)||W,u=((D=this._preloadCache)===null||D===void 0||(B=D.inputSettings)===null||B===void 0?void 0:B.audio)||W);var ce={audio:u,video:o};return this._prepInputSettingsToPresentToUser(ce)}},{key:"updateInputSettings",value:(je=U(function*(o){var u=this;return V(),oo(o)?(o&&(this._preloadCache.inputSettings||(this._preloadCache.inputSettings={}),co(o,this.properties.dailyConfig),o.audio&&(this._preloadCache.inputSettings.audio=o.audio),o.video&&(this._preloadCache.inputSettings.video=o.video)),o.video||o.audio?this._callObjectMode&&!this._callMachineInitialized?this._getInputSettings():new Promise(function(d,g){u.sendMessageToCallMachine({action:"update-input-settings",inputSettings:o},function(f){f.error?g(f.error):d({inputSettings:u._prepInputSettingsToPresentToUser(f.inputSettings)})})}):this._getInputSettings()):(console.error(ri()),Promise.reject(ri()))}),function(o){return je.apply(this,arguments)})},{key:"setBandwidth",value:function(o){var u=o.kbs,d=o.trackConstraints;if(V(),this._callMachineInitialized)return this.sendMessageToCallMachine({action:"set-bandwidth",kbs:u,trackConstraints:d}),this}},{key:"getDailyLang",value:function(){var o=this;if(V(),this._callMachineInitialized)return new Promise(function(u){o.sendMessageToCallMachine({action:"get-daily-lang"},function(d){delete d.action,delete d.callbackStamp,u(d)})})}},{key:"setDailyLang",value:function(o){return V(),this.sendMessageToCallMachine({action:"set-daily-lang",lang:o}),this}},{key:"setProxyUrl",value:function(o){return this.sendMessageToCallMachine({action:"set-proxy-url",proxyUrl:o}),this}},{key:"setIceConfig",value:function(o){return this.sendMessageToCallMachine({action:"set-ice-config",iceConfig:o}),this}},{key:"meetingSessionSummary",value:function(){return[vt,tt].includes(this._callState)?this._finalSummaryOfPrevSession:this._meetingSessionSummary}},{key:"getMeetingSession",value:(ye=U(function*(){var o=this;return console.warn("getMeetingSession() is deprecated: use meetingSessionSummary(), which will return immediately"),Z(this._callState,"getMeetingSession()"),new Promise(function(u){o.sendMessageToCallMachine({action:"get-meeting-session"},function(d){delete d.action,delete d.callbackStamp,u(d)})})}),function(){return ye.apply(this,arguments)})},{key:"meetingSessionState",value:function(){return Z(this._callState,"meetingSessionState"),this._meetingSessionState}},{key:"setMeetingSessionData",value:function(o){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"replace";Oe(this._callObjectMode,"setMeetingSessionData()"),Z(this._callState,"setMeetingSessionData");try{(function(d,g){new Uu({data:d,mergeStrategy:g})})(o,u)}catch(d){throw console.error(d),d}try{this.sendMessageToCallMachine({action:"set-session-data",data:o,mergeStrategy:u})}catch(d){throw new Error("Error setting meeting session data: ".concat(d))}}},{key:"setUserName",value:function(o,u){var d=this;return this.properties.userName=o,new Promise(function(g){d.sendMessageToCallMachine({action:"set-user-name",name:o??"",thisMeetingOnly:H()||!!u&&!!u.thisMeetingOnly},function(f){delete f.action,delete f.callbackStamp,g(f)})})}},{key:"setUserData",value:(oe=U(function*(o){var u=this;try{so(o)}catch(d){throw console.error(d),d}if(this.properties.userData=o,this._callMachineInitialized)return new Promise(function(d){try{u.sendMessageToCallMachine({action:"set-user-data",userData:o},function(g){delete g.action,delete g.callbackStamp,d(g)})}catch(g){throw new Error("Error setting user data: ".concat(g))}})}),function(o){return oe.apply(this,arguments)})},{key:"validateAudioLevelInterval",value:function(o){if(o&&(o<100||typeof o!="number"))throw new Error("The interval must be a number greater than or equal to 100 milliseconds.")}},{key:"startLocalAudioLevelObserver",value:function(o){var u=this;if(typeof AudioWorkletNode>"u"&&!H())throw new Error("startLocalAudioLevelObserver() is not supported on this browser");if(this.validateAudioLevelInterval(o),this._callMachineInitialized)return this._isLocalAudioLevelObserverRunning=!0,new Promise(function(d,g){u.sendMessageToCallMachine({action:"start-local-audio-level-observer",interval:o},function(f){u._isLocalAudioLevelObserverRunning=!f.error,f.error?g({error:f.error}):d()})});this._preloadCache.localAudioLevelObserver={enabled:!0,interval:o}}},{key:"isLocalAudioLevelObserverRunning",value:function(){return this._isLocalAudioLevelObserverRunning}},{key:"stopLocalAudioLevelObserver",value:function(){this._preloadCache.localAudioLevelObserver=null,this._localAudioLevel=0,this._isLocalAudioLevelObserverRunning=!1,this.sendMessageToCallMachine({action:"stop-local-audio-level-observer"})}},{key:"startRemoteParticipantsAudioLevelObserver",value:function(o){var u=this;if(this.validateAudioLevelInterval(o),this._callMachineInitialized)return this._isRemoteParticipantsAudioLevelObserverRunning=!0,new Promise(function(d,g){u.sendMessageToCallMachine({action:"start-remote-participants-audio-level-observer",interval:o},function(f){u._isRemoteParticipantsAudioLevelObserverRunning=!f.error,f.error?g({error:f.error}):d()})});this._preloadCache.remoteParticipantsAudioLevelObserver={enabled:!0,interval:o}}},{key:"isRemoteParticipantsAudioLevelObserverRunning",value:function(){return this._isRemoteParticipantsAudioLevelObserverRunning}},{key:"stopRemoteParticipantsAudioLevelObserver",value:function(){this._preloadCache.remoteParticipantsAudioLevelObserver=null,this._remoteParticipantsAudioLevel={},this._isRemoteParticipantsAudioLevelObserverRunning=!1,this.sendMessageToCallMachine({action:"stop-remote-participants-audio-level-observer"})}},{key:"startCamera",value:(q=U(function*(){var o=this,u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Oe(this._callObjectMode,"startCamera()"),ti(this._callState,this._isPreparingToJoin,"startCamera()","Did you mean to use setLocalAudio() and/or setLocalVideo() instead?"),this.needsLoad())try{yield this.load(u)}catch(d){return Promise.reject(d)}else{if(this._didPreAuth){if(u.url&&u.url!==this.properties.url)return console.error("url in startCamera() is different than the one used in preAuth()"),Promise.reject();if(u.token&&u.token!==this.properties.token)return console.error("token in startCamera() is different than the one used in preAuth()"),Promise.reject()}this.validateProperties(u),this.properties=$($({},this.properties),u)}return new Promise(function(d){o.sendMessageToCallMachine({action:"start-camera",properties:Nt(o.properties,o.callClientId),preloadCache:Nt(o._preloadCache,o.callClientId)},function(g){delete g.action,delete g.callbackStamp,d(g)})})}),function(){return q.apply(this,arguments)})},{key:"validateCustomTrack",value:function(o,u,d){if(d&&d.length>50)throw new Error("Custom track `trackName` must not be more than 50 characters");if(u&&u!=="music"&&u!=="speech"&&!(u instanceof Object))throw new Error("Custom track `mode` must be either `music` | `speech` | `DailyMicAudioModeSettings` or `undefined`");if(d&&["cam-audio","cam-video","screen-video","screen-audio","rmpAudio","rmpVideo","customVideoDefaults"].includes(d))throw new Error("Custom track `trackName` must not match a track name already used by daily: cam-audio, cam-video, customVideoDefaults, screen-video, screen-audio, rmpAudio, rmpVideo");if(!(o instanceof MediaStreamTrack))throw new Error("Custom tracks provided must be instances of MediaStreamTrack")}},{key:"startCustomTrack",value:function(){var o=this,u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{track,mode,trackName};return V(),Z(this._callState,"startCustomTrack()"),this.validateCustomTrack(u.track,u.mode,u.trackName),new Promise(function(d,g){o._sharedTracks.customTrack=u.track,u.track=Ht,o.sendMessageToCallMachine({action:"start-custom-track",properties:u},function(f){f.error?g({error:f.error}):d(f.mediaTag)})})}},{key:"stopCustomTrack",value:function(o){var u=this;return V(),Z(this._callState,"stopCustomTrack()"),new Promise(function(d){u.sendMessageToCallMachine({action:"stop-custom-track",mediaTag:o},function(g){d(g.mediaTag)})})}},{key:"setCamera",value:function(o){var u=this;return Yt(),Un(this._callMachineInitialized,"setCamera()"),new Promise(function(d){u.sendMessageToCallMachine({action:"set-camera",cameraDeviceId:o},function(g){d({device:g.device})})})}},{key:"setAudioDevice",value:(N=U(function*(o){return Yt(),this.nativeUtils().setAudioDevice(o),{deviceId:yield this.nativeUtils().getAudioDevice()}}),function(o){return N.apply(this,arguments)})},{key:"cycleCamera",value:function(){var o=this,u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return new Promise(function(d){o.sendMessageToCallMachine({action:"cycle-camera",properties:u},function(g){d({device:g.device})})})}},{key:"cycleMic",value:function(){var o=this;return V(),new Promise(function(u){o.sendMessageToCallMachine({action:"cycle-mic"},function(d){u({device:d.device})})})}},{key:"getCameraFacingMode",value:function(){var o=this;return Yt(),new Promise(function(u){o.sendMessageToCallMachine({action:"get-camera-facing-mode"},function(d){u(d.facingMode)})})}},{key:"setInputDevicesAsync",value:(x=U(function*(o){var u=this,d=o.audioDeviceId,g=o.videoDeviceId,f=o.audioSource,M=o.videoSource;return V(),f!==void 0&&(d=f),M!==void 0&&(g=M),d&&(this._preloadCache.audioDeviceId=d,this._sharedTracks.audioDeviceId=d),g&&(this._preloadCache.videoDeviceId=g,this._sharedTracks.videoDeviceId=g),this._callObjectMode&&this.needsLoad()?{camera:{deviceId:this._preloadCache.videoDeviceId},mic:{deviceId:this._preloadCache.audioDeviceId},speaker:{deviceId:this._preloadCache.outputDeviceId}}:(d instanceof MediaStreamTrack&&(d=Ht),g instanceof MediaStreamTrack&&(g=Ht),new Promise(function(D){u.sendMessageToCallMachine({action:"set-input-devices",audioDeviceId:d,videoDeviceId:g},function(B){delete B.action,delete B.callbackStamp,B.returnPreloadCache?D({camera:{deviceId:u._preloadCache.videoDeviceId},mic:{deviceId:u._preloadCache.audioDeviceId},speaker:{deviceId:u._preloadCache.outputDeviceId}}):D(B)})}))}),function(o){return x.apply(this,arguments)})},{key:"setOutputDeviceAsync",value:(I=U(function*(o){var u=this,d=o.outputDeviceId;return V(),d&&(this._preloadCache.outputDeviceId=d),this._callObjectMode&&this.needsLoad()?{camera:{deviceId:this._preloadCache.videoDeviceId},mic:{deviceId:this._preloadCache.audioDeviceId},speaker:{deviceId:this._preloadCache.outputDeviceId}}:new Promise(function(g){u.sendMessageToCallMachine({action:"set-output-device",outputDeviceId:d},function(f){delete f.action,delete f.callbackStamp,f.returnPreloadCache?g({camera:{deviceId:u._preloadCache.videoDeviceId},mic:{deviceId:u._preloadCache.audioDeviceId},speaker:{deviceId:u._preloadCache.outputDeviceId}}):g(f)})})}),function(o){return I.apply(this,arguments)})},{key:"getInputDevices",value:(P=U(function*(){var o=this;return this._callObjectMode&&this.needsLoad()?{camera:{deviceId:this._preloadCache.videoDeviceId},mic:{deviceId:this._preloadCache.audioDeviceId},speaker:{deviceId:this._preloadCache.outputDeviceId}}:new Promise(function(u){o.sendMessageToCallMachine({action:"get-input-devices"},function(d){delete d.action,delete d.callbackStamp,d.returnPreloadCache?u({camera:{deviceId:o._preloadCache.videoDeviceId},mic:{deviceId:o._preloadCache.audioDeviceId},speaker:{deviceId:o._preloadCache.outputDeviceId}}):u(d)})})}),function(){return P.apply(this,arguments)})},{key:"nativeInCallAudioMode",value:function(){return Yt(),this._nativeInCallAudioMode}},{key:"setNativeInCallAudioMode",value:function(o){if(Yt(),[Xa,ad].includes(o)){if(o!==this._nativeInCallAudioMode)return this._nativeInCallAudioMode=o,!this.disableReactNativeAutoDeviceManagement("audio")&&Fn(this._callState,this._isPreparingToJoin)&&this.nativeUtils().setAudioMode(this._nativeInCallAudioMode),this}else console.error("invalid in-call audio mode specified: ",o)}},{key:"preAuth",value:(k=U(function*(){var o=this,u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Oe(this._callObjectMode,"preAuth()"),ti(this._callState,this._isPreparingToJoin,"preAuth()"),this.needsLoad()&&(yield this.load(u)),!u.url)throw new Error("preAuth() requires at least a url to be provided");return this.validateProperties(u),this.properties=$($({},this.properties),u),new Promise(function(d,g){o.sendMessageToCallMachine({action:"daily-method-preauth",properties:Nt(o.properties,o.callClientId),preloadCache:Nt(o._preloadCache,o.callClientId)},function(f){return f.error?g(f.error):f.access?(o._didPreAuth=!0,void d({access:f.access})):g(new Error("unknown error in preAuth()"))})})}),function(){return k.apply(this,arguments)})},{key:"load",value:(E=U(function*(o){var u=this;if(this.needsLoad()){if(this._destroyed&&(this._logUseAfterDestroy(),this.strictMode))throw new Error("Use after destroy");if(o&&(this.validateProperties(o),this.properties=$($({},this.properties),o)),!this._callObjectMode&&!this.properties.url)throw new Error("can't load iframe meeting because url property isn't set");return this._updateCallState(ma),this.emitDailyJSEvent({action:Fl}),this._callObjectMode?new Promise(function(d,g){u._callObjectLoader.cancel();var f=Date.now();u._callObjectLoader.load(u.properties.dailyConfig,function(M){u._bundleLoadTime=M?"no-op":Date.now()-f,u._updateCallState(ga),M&&u.emitDailyJSEvent({action:ya}),d()},function(M,D){if(u.emitDailyJSEvent({action:Ul}),!D){u._updateCallState(tt),u.resetMeetingDependentVars();var B={action:Sa,errorMsg:M.msg,error:{type:"connection-error",msg:"Failed to load call object bundle.",details:{on:"load",sourceError:M,bundleUrl:hn(u.properties.dailyConfig)}}};u._maybeSendToSentry(B),u.emitDailyJSEvent(B),g(M.msg)}})}):(this._iframe.src=as(this.assembleMeetingUrl(),this.properties.dailyConfig),new Promise(function(d,g){u._loadedCallback=function(f){u._callState!==tt?(u._updateCallState(ga),(u.properties.cssFile||u.properties.cssText)&&u.loadCss(u.properties),d()):g(f)}}))}}),function(o){return E.apply(this,arguments)})},{key:"join",value:(w=U(function*(){var o=this,u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._testCallInProgress&&this.stopTestCallQuality();var d=!1;if(this.needsLoad()){this.updateIsPreparingToJoin(!0);try{yield this.load(u)}catch(g){return this.updateIsPreparingToJoin(!1),Promise.reject(g)}}else{if(d=!(!this.properties.cssFile&&!this.properties.cssText),this._didPreAuth){if(u.url&&u.url!==this.properties.url)return console.error("url in join() is different than the one used in preAuth()"),this.updateIsPreparingToJoin(!1),Promise.reject();if(u.token&&u.token!==this.properties.token)return console.error("token in join() is different than the one used in preAuth()"),this.updateIsPreparingToJoin(!1),Promise.reject()}if(u.url&&!this._callObjectMode&&u.url&&u.url!==this.properties.url)return console.error("url in join() is different than the one used in load() (".concat(this.properties.url," -> ").concat(u.url,")")),this.updateIsPreparingToJoin(!1),Promise.reject();this.validateProperties(u),this.properties=$($({},this.properties),u)}return u.showLocalVideo!==void 0&&(this._callObjectMode?console.error("showLocalVideo is not available in callObject mode"):this._showLocalVideo=!!u.showLocalVideo),u.showParticipantsBar!==void 0&&(this._callObjectMode?console.error("showParticipantsBar is not available in callObject mode"):this._showParticipantsBar=!!u.showParticipantsBar),this._callState===gt||this._callState===Br?(console.warn("already joined meeting, call leave() before joining again"),void this.updateIsPreparingToJoin(!1)):(this._updateCallState(Br,!1),this.emitDailyJSEvent({action:Jl}),this._preloadCache.inputSettings||(this._preloadCache.inputSettings={}),u.inputSettings&&u.inputSettings.audio&&(this._preloadCache.inputSettings.audio=u.inputSettings.audio),u.inputSettings&&u.inputSettings.video&&(this._preloadCache.inputSettings.video=u.inputSettings.video),this.sendMessageToCallMachine({action:"join-meeting",properties:Nt(this.properties,this.callClientId),preloadCache:Nt(this._preloadCache,this.callClientId)}),new Promise(function(g,f){o._joinedCallback=function(M,D){if(o._callState!==tt){if(o._updateCallState(gt),M)for(var B in M){if(o._callObjectMode){var W=o._callMachine().store;Ja(M[B],W),Va(M[B],W),Wa(M[B],o._participants[B],W)}o._participants[B]=$({},M[B]),o.toggleParticipantAudioBasedOnNativeAudioFocus()}d&&o.loadCss(o.properties),g(M)}else f(D)}}))}),function(){return w.apply(this,arguments)})},{key:"leave",value:(y=U(function*(){var o=this;return this._testCallInProgress&&this.stopTestCallQuality(),new Promise(function(u){o._callState===vt||o._callState===tt?u():o._callObjectLoader&&!o._callObjectLoader.loaded?(o._callObjectLoader.cancel(),o._updateCallState(vt),o.resetMeetingDependentVars(),o.emitDailyJSEvent({action:vt}),u()):(o._resolveLeave=u,o.sendMessageToCallMachine({action:"leave-meeting"}))})}),function(){return y.apply(this,arguments)})},{key:"startScreenShare",value:(A=U(function*(){var o=this,u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Un(this._callMachineInitialized,"startScreenShare()"),u.screenVideoSendSettings&&this._validateVideoSendSettings("screenVideo",u.screenVideoSendSettings),u.mediaStream&&(this._sharedTracks.screenMediaStream=u.mediaStream,u.mediaStream=Ht),typeof DailyNativeUtils<"u"&&DailyNativeUtils.isIOS!==void 0&&DailyNativeUtils.isIOS){var d=this.nativeUtils();if(yield d.isScreenBeingCaptured())return void this.emitDailyJSEvent({action:wa,type:"screen-share-error",errorMsg:"Could not start the screen sharing. The screen is already been captured!"});d.setSystemScreenCaptureStartCallback(function(){d.setSystemScreenCaptureStartCallback(null),o.sendMessageToCallMachine({action:Ca,captureOptions:u})}),d.presentSystemScreenCapturePrompt()}else this.sendMessageToCallMachine({action:Ca,captureOptions:u})}),function(){return A.apply(this,arguments)})},{key:"stopScreenShare",value:function(){Un(this._callMachineInitialized,"stopScreenShare()"),this.sendMessageToCallMachine({action:"local-screen-stop"})}},{key:"startRecording",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.sendMessageToCallMachine($({action:"local-recording-start"},o))}},{key:"updateRecording",value:function(o){var u=o.layout,d=u===void 0?{preset:"default"}:u,g=o.instanceId;this.sendMessageToCallMachine({action:"daily-method-update-recording",layout:d,instanceId:g})}},{key:"stopRecording",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.sendMessageToCallMachine($({action:"local-recording-stop"},o))}},{key:"startLiveStreaming",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.sendMessageToCallMachine($({action:"daily-method-start-live-streaming"},o))}},{key:"updateLiveStreaming",value:function(o){var u=o.layout,d=u===void 0?{preset:"default"}:u,g=o.instanceId;this.sendMessageToCallMachine({action:"daily-method-update-live-streaming",layout:d,instanceId:g})}},{key:"addLiveStreamingEndpoints",value:function(o){var u=o.endpoints,d=o.instanceId;this.sendMessageToCallMachine({action:Ea,endpointsOp:Lu,endpoints:u,instanceId:d})}},{key:"removeLiveStreamingEndpoints",value:function(o){var u=o.endpoints,d=o.instanceId;this.sendMessageToCallMachine({action:Ea,endpointsOp:ju,endpoints:u,instanceId:d})}},{key:"stopLiveStreaming",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.sendMessageToCallMachine($({action:"daily-method-stop-live-streaming"},o))}},{key:"validateDailyConfig",value:function(o){o.camSimulcastEncodings&&(console.warn("camSimulcastEncodings is deprecated. Use sendSettings, found in DailyCallOptions, to provide camera simulcast settings."),this.validateSimulcastEncodings(o.camSimulcastEncodings)),o.screenSimulcastEncodings&&console.warn("screenSimulcastEncodings is deprecated. Use sendSettings, found in DailyCallOptions, to provide screen simulcast settings."),ja()&&o.noAutoDefaultDeviceChange&&console.warn("noAutoDefaultDeviceChange is not supported on Android, and will be ignored.")}},{key:"validateSimulcastEncodings",value:function(o){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,d=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(o){if(!(o instanceof Array||Array.isArray(o)))throw new Error("encodings must be an Array");if(!vo(o.length,1,3))throw new Error("encodings must be an Array with between 1 to ".concat(3," layers"));for(var g=0;g<o.length;g++){var f=o[g];for(var M in this._validateEncodingLayerHasValidProperties(f),f)if(Zr.includes(M)){if(typeof f[M]!="number")throw new Error("".concat(M," must be a number"));if(u){var D=u[M],B=D.min,W=D.max;if(!vo(f[M],B,W))throw new Error("".concat(M," value not in range. valid range: ").concat(B," to ").concat(W))}}else if(!["active","scalabilityMode"].includes(M))throw new Error("Invalid key ".concat(M,", valid keys are:")+Object.values(Zr));if(d&&!f.hasOwnProperty("maxBitrate"))throw new Error("maxBitrate is not specified")}}}},{key:"startRemoteMediaPlayer",value:(T=U(function*(o){var u=this,d=o.url,g=o.settings,f=g===void 0?{state:qr.PLAY}:g;try{(function(M){if(typeof M!="string")throw new Error('url parameter must be "string" type')})(d),go(f),function(M){for(var D in M)if(!no.includes(D))throw new Error("Invalid key ".concat(D,", valid keys are: ").concat(no));M.simulcastEncodings&&this.validateSimulcastEncodings(M.simulcastEncodings,to,!0)}(f)}catch(M){throw console.error("invalid argument Error: ".concat(M)),console.error(`startRemoteMediaPlayer arguments must be of the form:
  { url: "playback url",
  settings?:
  {state: "play"|"pause", simulcastEncodings?: [{}] } }`),M}return new Promise(function(M,D){u.sendMessageToCallMachine({action:"daily-method-start-remote-media-player",url:d,settings:f},function(B){B.error?D({error:B.error,errorMsg:B.errorMsg}):M({session_id:B.session_id,remoteMediaPlayerState:{state:B.state,settings:B.settings}})})})}),function(o){return T.apply(this,arguments)})},{key:"stopRemoteMediaPlayer",value:(C=U(function*(o){var u=this;if(typeof o!="string")throw new Error(" remotePlayerID must be of type string");return new Promise(function(d,g){u.sendMessageToCallMachine({action:"daily-method-stop-remote-media-player",session_id:o},function(f){f.error?g({error:f.error,errorMsg:f.errorMsg}):d()})})}),function(o){return C.apply(this,arguments)})},{key:"updateRemoteMediaPlayer",value:(L=U(function*(o){var u=this,d=o.session_id,g=o.settings;try{go(g)}catch(f){throw console.error("invalid argument Error: ".concat(f)),console.error(`updateRemoteMediaPlayer arguments must be of the form:
  session_id: "participant session",
  { settings?: {state: "play"|"pause"} }`),f}return new Promise(function(f,M){u.sendMessageToCallMachine({action:"daily-method-update-remote-media-player",session_id:d,settings:g},function(D){D.error?M({error:D.error,errorMsg:D.errorMsg}):f({session_id:D.session_id,remoteMediaPlayerState:{state:D.state,settings:D.settings}})})})}),function(o){return L.apply(this,arguments)})},{key:"startTranscription",value:function(o){Z(this._callState,"startTranscription()"),this.sendMessageToCallMachine($({action:"daily-method-start-transcription"},o))}},{key:"updateTranscription",value:function(o){if(Z(this._callState,"updateTranscription()"),!o)throw new Error("updateTranscription Error: options is mandatory");if(Q(o)!=="object")throw new Error("updateTranscription Error: options must be object type");if(o.participants&&!Array.isArray(o.participants))throw new Error("updateTranscription Error: participants must be an array");this.sendMessageToCallMachine($({action:"daily-method-update-transcription"},o))}},{key:"stopTranscription",value:function(o){if(Z(this._callState,"stopTranscription()"),o&&Q(o)!=="object")throw new Error("stopTranscription Error: options must be object type");if(o&&!o.instanceId)throw new Error('"instanceId" not provided');this.sendMessageToCallMachine($({action:"daily-method-stop-transcription"},o))}},{key:"startDialOut",value:(S=U(function*(o){var u=this;Z(this._callState,"startDialOut()");var d=function(g){if(g){if(!Array.isArray(g))throw new Error("Error starting dial out: audio codec must be an array");if(g.length<=0)throw new Error("Error starting dial out: audio codec array specified but empty");g.forEach(function(f){if(typeof f!="string")throw new Error("Error starting dial out: audio codec must be a string");if(f!=="OPUS"&&f!=="PCMU"&&f!=="PCMA"&&f!=="G722")throw new Error("Error starting dial out: audio codec must be one of OPUS, PCMU, PCMA, G722")})}};if(!o.sipUri&&!o.phoneNumber)throw new Error("Error starting dial out: either a sip uri or phone number must be provided");if(o.sipUri&&o.phoneNumber)throw new Error("Error starting dial out: only one of sip uri or phone number must be provided");if(o.sipUri){if(typeof o.sipUri!="string")throw new Error("Error starting dial out: sipUri must be a string");if(!o.sipUri.startsWith("sip:"))throw new Error("Error starting dial out: Invalid SIP URI, must start with 'sip:'");if(o.video&&typeof o.video!="boolean")throw new Error("Error starting dial out: video must be a boolean value");(function(g){if(g&&(d(g.audio),g.video)){if(!Array.isArray(g.video))throw new Error("Error starting dial out: video codec must be an array");if(g.video.length<=0)throw new Error("Error starting dial out: video codec array specified but empty");g.video.forEach(function(f){if(typeof f!="string")throw new Error("Error starting dial out: video codec must be a string");if(f!=="H264"&&f!=="VP8")throw new Error("Error starting dial out: video codec must be H264 or VP8")})}})(o.codecs)}if(o.phoneNumber){if(typeof o.phoneNumber!="string")throw new Error("Error starting dial out: phoneNumber must be a string");if(!/^\+\d{1,}$/.test(o.phoneNumber))throw new Error("Error starting dial out: Invalid phone number, must be valid phone number as per E.164");o.codecs&&d(o.codecs.audio)}if(o.callerId){if(typeof o.callerId!="string")throw new Error("Error starting dial out: callerId must be a string");if(o.sipUri)throw new Error("Error starting dial out: callerId not allowed with sipUri")}if(o.displayName){if(typeof o.displayName!="string")throw new Error("Error starting dial out: displayName must be a string");if(o.displayName.length>=200)throw new Error("Error starting dial out: displayName length must be less than 200")}if(o.userId){if(typeof o.userId!="string")throw new Error("Error starting dial out: userId must be a string");if(o.userId.length>36)throw new Error("Error starting dial out: userId length must be less than or equal to 36")}return new Promise(function(g,f){u.sendMessageToCallMachine($({action:"dialout-start"},o),function(M){M.error?f(M.error):g(M)})})}),function(o){return S.apply(this,arguments)})},{key:"stopDialOut",value:function(o){var u=this;return Z(this._callState,"stopDialOut()"),new Promise(function(d,g){u.sendMessageToCallMachine($({action:"dialout-stop"},o),function(f){f.error?g(f.error):d(f)})})}},{key:"sipCallTransfer",value:(_=U(function*(o){var u=this;if(Z(this._callState,"sipCallTransfer()"),!o)throw new Error("sipCallTransfer() requires a sessionId and toEndPoint");return o.useSipRefer=!1,mo(o,"sipCallTransfer"),new Promise(function(d,g){u.sendMessageToCallMachine($({action:Ta},o),function(f){f.error?g(f.error):d(f)})})}),function(o){return _.apply(this,arguments)})},{key:"sipRefer",value:(v=U(function*(o){var u=this;if(Z(this._callState,"sipRefer()"),!o)throw new Error("sessionId and toEndPoint are mandatory parameter");return o.useSipRefer=!0,mo(o,"sipRefer"),new Promise(function(d,g){u.sendMessageToCallMachine($({action:Ta},o),function(f){f.error?g(f.error):d(f)})})}),function(o){return v.apply(this,arguments)})},{key:"sendDTMF",value:(b=U(function*(o){var u=this;return Z(this._callState,"sendDTMF()"),function(d){var g=d.sessionId,f=d.tones;if(!g||!f)throw new Error("sessionId and tones are mandatory parameter");if(typeof g!="string"||typeof f!="string")throw new Error("sessionId and tones should be of string type");if(f.length>20)throw new Error("tones string must be upto 20 characters");var M=/[^0-9A-D*#]/g,D=f.match(M);if(D&&D[0])throw new Error("".concat(D[0]," is not valid DTMF tone"))}(o),new Promise(function(d,g){u.sendMessageToCallMachine($({action:"send-dtmf"},o),function(f){f.error?g(f.error):d(f)})})}),function(o){return b.apply(this,arguments)})},{key:"getNetworkStats",value:function(){var o=this;return this._callState!==gt?{stats:{latest:{}}}:new Promise(function(u){o.sendMessageToCallMachine({action:"get-calc-stats"},function(d){u($({stats:d.stats},o._network))})})}},{key:"testWebsocketConnectivity",value:(m=U(function*(){var o=this;if(ni(this._testCallInProgress,"testWebsocketConnectivity()"),this.needsLoad())try{yield this.load()}catch(u){return Promise.reject(u)}return new Promise(function(u,d){o.sendMessageToCallMachine({action:"test-websocket-connectivity"},function(g){g.error?d(g.error):u(g.results)})})}),function(){return m.apply(this,arguments)})},{key:"abortTestWebsocketConnectivity",value:function(){this.sendMessageToCallMachine({action:"abort-test-websocket-connectivity"})}},{key:"_validateVideoTrackForNetworkTests",value:function(o){return o?o instanceof MediaStreamTrack?!!nd(o)||(console.error("Video track is not playable. This test needs a live video track."),!1):(console.error("Video track needs to be of type `MediaStreamTrack`."),!1):(console.error("Missing video track. You must provide a video track in order to run this test."),!1)}},{key:"testCallQuality",value:(p=U(function*(){var o=this;V(),Oe(this._callObjectMode,"testCallQuality()"),Un(this._callMachineInitialized,"testCallQuality()",null,!0),ti(this._callState,this._isPreparingToJoin,"testCallQuality()");var u=this._testCallAlreadyInProgress,d=function(f){u||(o._testCallInProgress=f)};if(d(!0),this.needsLoad())try{var g=this._callState;yield this.load(),this._callState=g}catch(f){return d(!1),Promise.reject(f)}return new Promise(function(f){o.sendMessageToCallMachine({action:"test-call-quality",dailyJsVersion:o.properties.dailyJsVersion},function(M){var D=M.results,B=D.result,W=Ui(D,rd);if(B==="failed"){var ce,ne=$({},W);(ce=W.error)!==null&&ce!==void 0&&ce.details?(W.error.details=JSON.parse(W.error.details),ne.error=$($({},ne.error),{},{details:$({},ne.error.details)}),ne.error.details.duringTest="testCallQuality"):(ne.error=ne.error?$({},ne.error):{},ne.error.details={duringTest:"testCallQuality"}),o._maybeSendToSentry(ne)}d(!1),f($({result:B},W))})})}),function(){return p.apply(this,arguments)})},{key:"stopTestCallQuality",value:function(){this.sendMessageToCallMachine({action:"stop-test-call-quality"})}},{key:"testConnectionQuality",value:(h=U(function*(o){var u;H()?(console.warn("testConnectionQuality() is deprecated: use testPeerToPeerCallQuality() instead"),u=yield this.testPeerToPeerCallQuality(o)):(console.warn("testConnectionQuality() is deprecated: use testCallQuality() instead"),u=yield this.testCallQuality());var d={result:u.result,secondsElapsed:u.secondsElapsed};return u.data&&(d.data={maxRTT:u.data.maxRoundTripTime,packetLoss:u.data.avgRecvPacketLoss}),d}),function(o){return h.apply(this,arguments)})},{key:"testPeerToPeerCallQuality",value:(c=U(function*(o){var u=this;if(ni(this._testCallInProgress,"testPeerToPeerCallQuality()"),this.needsLoad())try{yield this.load()}catch(f){return Promise.reject(f)}var d=o.videoTrack,g=o.duration;if(!this._validateVideoTrackForNetworkTests(d))throw new Error("Video track error");return this._sharedTracks.videoTrackForConnectionQualityTest=d,new Promise(function(f,M){u.sendMessageToCallMachine({action:"test-p2p-call-quality",duration:g},function(D){D.error?M(D.error):f(D.results)})})}),function(o){return c.apply(this,arguments)})},{key:"stopTestConnectionQuality",value:function(){H()?(console.warn("stopTestConnectionQuality() is deprecated: use testPeerToPeerCallQuality() and stopTestPeerToPeerCallQuality() instead"),this.stopTestPeerToPeerCallQuality()):(console.warn("stopTestConnectionQuality() is deprecated: use testCallQuality() and stopTestCallQuality() instead"),this.stopTestCallQuality())}},{key:"stopTestPeerToPeerCallQuality",value:function(){this.sendMessageToCallMachine({action:"stop-test-p2p-call-quality"})}},{key:"testNetworkConnectivity",value:(l=U(function*(o){var u=this;if(ni(this._testCallInProgress,"testNetworkConnectivity()"),this.needsLoad())try{yield this.load()}catch(d){return Promise.reject(d)}if(!this._validateVideoTrackForNetworkTests(o))throw new Error("Video track error");return this._sharedTracks.videoTrackForNetworkConnectivityTest=o,new Promise(function(d,g){u.sendMessageToCallMachine({action:"test-network-connectivity"},function(f){f.error?g(f.error):d(f.results)})})}),function(o){return l.apply(this,arguments)})},{key:"abortTestNetworkConnectivity",value:function(){this.sendMessageToCallMachine({action:"abort-test-network-connectivity"})}},{key:"getCpuLoadStats",value:function(){var o=this;return new Promise(function(u){o._callState===gt?o.sendMessageToCallMachine({action:"get-cpu-load-stats"},function(d){u(d.cpuStats)}):u({cpuLoadState:void 0,cpuLoadStateReason:void 0,stats:{}})})}},{key:"_validateEncodingLayerHasValidProperties",value:function(o){var u;if(!(((u=Object.keys(o))===null||u===void 0?void 0:u.length)>0))throw new Error("Empty encoding is not allowed. At least one of these valid keys should be specified:"+Object.values(Zr))}},{key:"_validateVideoSendSettings",value:function(o,u){var d=o==="screenVideo"?["default-screen-video","detail-optimized","motion-optimized","motion-and-detail-balanced"]:["default-video","bandwidth-optimized","bandwidth-and-quality-balanced","quality-optimized","adaptive-2-layers","adaptive-3-layers"],g="Video send settings should be either an object or one of the supported presets: ".concat(d.join());if(typeof u=="string"){if(!d.includes(u))throw new Error(g)}else{if(Q(u)!=="object")throw new Error(g);if(!u.maxQuality&&!u.encodings&&u.allowAdaptiveLayers===void 0)throw new Error("Video send settings must contain at least maxQuality, allowAdaptiveLayers or encodings attribute");if(u.maxQuality&&["low","medium","high"].indexOf(u.maxQuality)===-1)throw new Error("maxQuality must be either low, medium or high");if(u.encodings){var f=!1;switch(Object.keys(u.encodings).length){case 1:f=!u.encodings.low;break;case 2:f=!u.encodings.low||!u.encodings.medium;break;case 3:f=!u.encodings.low||!u.encodings.medium||!u.encodings.high;break;default:f=!0}if(f)throw new Error("Encodings must be defined as: low, low and medium, or low, medium and high.");u.encodings.low&&this._validateEncodingLayerHasValidProperties(u.encodings.low),u.encodings.medium&&this._validateEncodingLayerHasValidProperties(u.encodings.medium),u.encodings.high&&this._validateEncodingLayerHasValidProperties(u.encodings.high)}}}},{key:"validateUpdateSendSettings",value:function(o){var u=this;if(!o||Object.keys(o).length===0)throw new Error("Send settings must contain at least information for one track!");Object.entries(o).forEach(function(d){var g=ot(d,2),f=g[0],M=g[1];u._validateVideoSendSettings(f,M)})}},{key:"updateSendSettings",value:function(o){var u=this;return this.validateUpdateSendSettings(o),this.needsLoad()?(this._preloadCache.sendSettings=o,{sendSettings:this._preloadCache.sendSettings}):new Promise(function(d,g){u.sendMessageToCallMachine({action:"update-send-settings",sendSettings:o},function(f){f.error?g(f.error):d(f.sendSettings)})})}},{key:"getSendSettings",value:function(){return this._sendSettings||this._preloadCache.sendSettings}},{key:"getLocalAudioLevel",value:function(){return this._localAudioLevel}},{key:"getRemoteParticipantsAudioLevel",value:function(){return this._remoteParticipantsAudioLevel}},{key:"getActiveSpeaker",value:function(){return V(),this._activeSpeaker}},{key:"setActiveSpeakerMode",value:function(o){return V(),this.sendMessageToCallMachine({action:"set-active-speaker-mode",enabled:o}),this}},{key:"activeSpeakerMode",value:function(){return V(),this._activeSpeakerMode}},{key:"subscribeToTracksAutomatically",value:function(){return this._preloadCache.subscribeToTracksAutomatically}},{key:"setSubscribeToTracksAutomatically",value:function(o){return Z(this._callState,"setSubscribeToTracksAutomatically()","Use the subscribeToTracksAutomatically configuration property."),this._preloadCache.subscribeToTracksAutomatically=o,this.sendMessageToCallMachine({action:"daily-method-subscribe-to-tracks-automatically",enabled:o}),this}},{key:"enumerateDevices",value:(a=U(function*(){var o=this;if(this._callObjectMode){var u=yield navigator.mediaDevices.enumerateDevices();return yt()==="Firefox"&&Qt().major>115&&Qt().major<123&&(u=u.filter(function(d){return d.kind!=="audiooutput"})),{devices:u.map(function(d){var g=JSON.parse(JSON.stringify(d));if(!H()&&d.kind==="videoinput"&&d.getCapabilities){var f,M=d.getCapabilities();g.facing=(M==null||(f=M.facingMode)===null||f===void 0?void 0:f.length)>=1?M.facingMode[0]:void 0}return g})}}return new Promise(function(d){o.sendMessageToCallMachine({action:"enumerate-devices"},function(g){d({devices:g.devices})})})}),function(){return a.apply(this,arguments)})},{key:"sendAppMessage",value:function(o){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"*";if(Z(this._callState,"sendAppMessage()"),JSON.stringify(o).length>this._maxAppMessageSize)throw new Error("Message data too large. Max size is "+this._maxAppMessageSize);return this.sendMessageToCallMachine({action:"app-msg",data:o,to:u}),this}},{key:"addFakeParticipant",value:function(o){return V(),Z(this._callState,"addFakeParticipant()"),this.sendMessageToCallMachine($({action:"add-fake-participant"},o)),this}},{key:"setShowNamesMode",value:function(o){return ve(this._callObjectMode,"setShowNamesMode()"),V(),o&&o!=="always"&&o!=="never"?(console.error('setShowNamesMode argument should be "always", "never", or false'),this):(this.sendMessageToCallMachine({action:"set-show-names",mode:o}),this)}},{key:"setShowLocalVideo",value:function(){var o=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];return ve(this._callObjectMode,"setShowLocalVideo()"),V(),Z(this._callState,"setShowLocalVideo()"),typeof o!="boolean"?(console.error("setShowLocalVideo only accepts a boolean value"),this):(this.sendMessageToCallMachine({action:"set-show-local-video",show:o}),this._showLocalVideo=o,this)}},{key:"showLocalVideo",value:function(){return ve(this._callObjectMode,"showLocalVideo()"),V(),this._showLocalVideo}},{key:"setShowParticipantsBar",value:function(){var o=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];return ve(this._callObjectMode,"setShowParticipantsBar()"),V(),Z(this._callState,"setShowParticipantsBar()"),typeof o!="boolean"?(console.error("setShowParticipantsBar only accepts a boolean value"),this):(this.sendMessageToCallMachine({action:"set-show-participants-bar",show:o}),this._showParticipantsBar=o,this)}},{key:"showParticipantsBar",value:function(){return ve(this._callObjectMode,"showParticipantsBar()"),V(),this._showParticipantsBar}},{key:"customIntegrations",value:function(){return V(),ve(this._callObjectMode,"customIntegrations()"),this._customIntegrations}},{key:"setCustomIntegrations",value:function(o){return V(),ve(this._callObjectMode,"setCustomIntegrations()"),Z(this._callState,"setCustomIntegrations()"),po(o)?(this.sendMessageToCallMachine({action:"set-custom-integrations",integrations:o}),this._customIntegrations=o,this):this}},{key:"startCustomIntegrations",value:function(o){var u=this;if(V(),ve(this._callObjectMode,"startCustomIntegrations()"),Z(this._callState,"startCustomIntegrations()"),Array.isArray(o)&&o.some(function(f){return typeof f!="string"})||!Array.isArray(o)&&typeof o!="string")return console.error("startCustomIntegrations() only accepts string | string[]"),this;var d=typeof o=="string"?[o]:o,g=d.filter(function(f){return!(f in u._customIntegrations)});return g.length?(console.error(`Can't find custom integration(s): "`.concat(g.join(", "),'"')),this):(this.sendMessageToCallMachine({action:"start-custom-integrations",ids:d}),this)}},{key:"stopCustomIntegrations",value:function(o){var u=this;if(V(),ve(this._callObjectMode,"stopCustomIntegrations()"),Z(this._callState,"stopCustomIntegrations()"),Array.isArray(o)&&o.some(function(f){return typeof f!="string"})||!Array.isArray(o)&&typeof o!="string")return console.error("stopCustomIntegrations() only accepts string | string[]"),this;var d=typeof o=="string"?[o]:o,g=d.filter(function(f){return!(f in u._customIntegrations)});return g.length?(console.error(`Can't find custom integration(s): "`.concat(g.join(", "),'"')),this):(this.sendMessageToCallMachine({action:"stop-custom-integrations",ids:d}),this)}},{key:"customTrayButtons",value:function(){return ve(this._callObjectMode,"customTrayButtons()"),V(),this._customTrayButtons}},{key:"updateCustomTrayButtons",value:function(o){return ve(this._callObjectMode,"updateCustomTrayButtons()"),V(),Z(this._callState,"updateCustomTrayButtons()"),ho(o)?(this.sendMessageToCallMachine({action:"update-custom-tray-buttons",btns:o}),this._customTrayButtons=o,this):(console.error("updateCustomTrayButtons only accepts a dictionary of the type ".concat(JSON.stringify(Rn))),this)}},{key:"theme",value:function(){return ve(this._callObjectMode,"theme()"),this.properties.theme}},{key:"setTheme",value:function(o){var u=this;return ve(this._callObjectMode,"setTheme()"),new Promise(function(d,g){try{u.validateProperties({theme:o}),u.properties.theme=$({},o),u.sendMessageToCallMachine({action:"set-theme",theme:u.properties.theme});try{u.emitDailyJSEvent({action:Bl,theme:u.properties.theme})}catch(f){console.log("could not emit 'theme-updated'",f)}d(u.properties.theme)}catch(f){g(f)}})}},{key:"requestFullscreen",value:(s=U(function*(){if(V(),this._iframe&&!document.fullscreenElement&&Aa())try{(yield this._iframe.requestFullscreen)?this._iframe.requestFullscreen():this._iframe.webkitRequestFullscreen()}catch(o){console.log("could not make video call fullscreen",o)}}),function(){return s.apply(this,arguments)})},{key:"exitFullscreen",value:function(){V(),document.fullscreenElement?document.exitFullscreen():document.webkitFullscreenElement&&document.webkitExitFullscreen()}},{key:"getSidebarView",value:(i=U(function*(){var o=this;return this._callObjectMode?(console.error("getSidebarView is not available in callObject mode"),Promise.resolve(null)):new Promise(function(u){o.sendMessageToCallMachine({action:"get-sidebar-view"},function(d){u(d.view)})})}),function(){return i.apply(this,arguments)})},{key:"setSidebarView",value:function(o){return this._callObjectMode?(console.error("setSidebarView is not available in callObject mode"),this):(this.sendMessageToCallMachine({action:"set-sidebar-view",view:o}),this)}},{key:"room",value:(r=U(function*(){var o=this,u=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{}).includeRoomConfigDefaults,d=u===void 0||u;return this._accessState.access===Fr||this.needsLoad()?this.properties.url?{roomUrlPendingJoin:this.properties.url}:null:new Promise(function(g){o.sendMessageToCallMachine({action:"lib-room-info",includeRoomConfigDefaults:d},function(f){delete f.action,delete f.callbackStamp,g(f)})})}),function(){return r.apply(this,arguments)})},{key:"geo",value:(n=U(function*(){try{var o=yield fetch("https://gs.daily.co/_ks_/x-swsl/:");return{current:(yield o.json()).geo}}catch(u){return console.error("geo lookup failed",u),{current:""}}}),function(){return n.apply(this,arguments)})},{key:"setNetworkTopology",value:(e=U(function*(o){var u=this;return V(),Z(this._callState,"setNetworkTopology()"),new Promise(function(d,g){u.sendMessageToCallMachine({action:"set-network-topology",opts:o},function(f){f.error?g({error:f.error}):d({workerId:f.workerId})})})}),function(o){return e.apply(this,arguments)})},{key:"getNetworkTopology",value:(t=U(function*(){var o=this;return new Promise(function(u,d){o.needsLoad()&&u({topology:"none"}),o.sendMessageToCallMachine({action:"get-network-topology"},function(g){g.error?d({error:g.error}):u({topology:g.topology})})})}),function(){return t.apply(this,arguments)})},{key:"setPlayNewParticipantSound",value:function(o){if(V(),typeof o!="number"&&o!==!0&&o!==!1)throw new Error("argument to setShouldPlayNewParticipantSound should be true, false, or a number, but is ".concat(o));this.sendMessageToCallMachine({action:"daily-method-set-play-ding",arg:o})}},{key:"on",value:function(o,u){return Re.prototype.on.call(this,o,u)}},{key:"once",value:function(o,u){return Re.prototype.once.call(this,o,u)}},{key:"off",value:function(o,u){return Re.prototype.off.call(this,o,u)}},{key:"validateProperties",value:function(o){for(var u in o){if(!_t[u])throw new Error("unrecognized property '".concat(u,"'"));if(_t[u].validate&&!_t[u].validate(o[u],this))throw new Error("property '".concat(u,"': ").concat(_t[u].help))}}},{key:"assembleMeetingUrl",value:function(){var o,u,d=$($({},this.properties),{},{emb:this.callClientId,embHref:encodeURIComponent(window.location.href),proxy:(o=this.properties.dailyConfig)!==null&&o!==void 0&&o.proxyUrl?encodeURIComponent((u=this.properties.dailyConfig)===null||u===void 0?void 0:u.proxyUrl):void 0}),g=d.url.match(/\?/)?"&":"?";return d.url+g+Object.keys(_t).filter(function(f){return _t[f].queryString&&d[f]!==void 0}).map(function(f){return"".concat(_t[f].queryString,"=").concat(d[f])}).join("&")}},{key:"needsLoad",value:function(){return[fa,ma,vt,tt].includes(this._callState)}},{key:"sendMessageToCallMachine",value:function(o,u){if(this._destroyed&&(this._logUseAfterDestroy(),this.strictMode))throw new Error("Use after destroy");this._messageChannel.sendMessageToCallMachine(o,u,this.callClientId,this._iframe)}},{key:"forwardPackagedMessageToCallMachine",value:function(o){this._messageChannel.forwardPackagedMessageToCallMachine(o,this._iframe,this.callClientId)}},{key:"addListenerForPackagedMessagesFromCallMachine",value:function(o){return this._messageChannel.addListenerForPackagedMessagesFromCallMachine(o,this.callClientId)}},{key:"removeListenerForPackagedMessagesFromCallMachine",value:function(o){this._messageChannel.removeListenerForPackagedMessagesFromCallMachine(o)}},{key:"handleMessageFromCallMachine",value:function(o){switch(o.action){case Nl:this.sendMessageToCallMachine($({action:Rl},this.properties));break;case"call-machine-initialized":this._callMachineInitialized=!0;var u={action:jn,level:"log",code:1011,stats:{event:"bundle load",time:this._bundleLoadTime==="no-op"?0:this._bundleLoadTime,preLoaded:this._bundleLoadTime==="no-op",url:hn(this.properties.dailyConfig)}};this.sendMessageToCallMachine(u),this._delayDuplicateInstanceLog&&this._logDuplicateInstanceAttempt();break;case ya:this._loadedCallback&&(this._loadedCallback(),this._loadedCallback=null),this.emitDailyJSEvent(o);break;case Vl:var d,g=$({},o);delete g.internal,this._maxAppMessageSize=((d=o.internal)===null||d===void 0?void 0:d._maxAppMessageSize)||Ur,this._joinedCallback&&(this._joinedCallback(o.participants),this._joinedCallback=null),this.emitDailyJSEvent(g);break;case zl:case Gl:if(this._callState===vt)return;if(o.participant&&o.participant.session_id){var f=o.participant.local?"local":o.participant.session_id;if(this._callObjectMode){var M=this._callMachine().store;Ja(o.participant,M),Va(o.participant,M),Wa(o.participant,this._participants[f],M)}try{this.maybeParticipantTracksStopped(this._participants[f],o.participant),this.maybeParticipantTracksStarted(this._participants[f],o.participant),this.maybeEventRecordingStopped(this._participants[f],o.participant),this.maybeEventRecordingStarted(this._participants[f],o.participant)}catch(pi){console.error("track events error",pi)}this.compareEqualForParticipantUpdateEvent(o.participant,this._participants[f])||(this._participants[f]=$({},o.participant),this.toggleParticipantAudioBasedOnNativeAudioFocus(),this.emitDailyJSEvent(o))}break;case Hl:if(o.participant&&o.participant.session_id){var D=this._participants[o.participant.session_id];D&&this.maybeParticipantTracksStopped(D,null),delete this._participants[o.participant.session_id],this.emitDailyJSEvent(o)}break;case Ql:pe(this._participantCounts,o.participantCounts)||(this._participantCounts=o.participantCounts,this.emitDailyJSEvent(o));break;case Kl:var B={access:o.access};o.awaitingAccess&&(B.awaitingAccess=o.awaitingAccess),pe(this._accessState,B)||(this._accessState=B,this.emitDailyJSEvent(o));break;case Yl:if(o.meetingSession){this._meetingSessionSummary=o.meetingSession,this.emitDailyJSEvent(o);var W=$($({},o),{},{action:"meeting-session-updated"});this.emitDailyJSEvent(W)}break;case Sa:var ce;this._iframe&&!o.preserveIframe&&(this._iframe.src=""),this._updateCallState(tt),this.resetMeetingDependentVars(),this._loadedCallback&&(this._loadedCallback(o.errorMsg),this._loadedCallback=null),o.preserveIframe;var ne=Ui(o,id);ne!=null&&(ce=ne.error)!==null&&ce!==void 0&&ce.details&&(ne.error.details=JSON.parse(ne.error.details)),this._maybeSendToSentry(o),this._joinedCallback&&(this._joinedCallback(null,ne),this._joinedCallback=null),this.emitDailyJSEvent(ne);break;case Wl:this._callState!==tt&&this._updateCallState(vt),this.resetMeetingDependentVars(),this._resolveLeave&&(this._resolveLeave(),this._resolveLeave=null),this.emitDailyJSEvent(o);break;case"selected-devices-updated":o.devices&&this.emitDailyJSEvent(o);break;case wu:var Je=o.threshold,it=o.quality;Je===this._network.threshold&&it===this._network.quality||(this._network.quality=it,this._network.threshold=Je,this.emitDailyJSEvent(o));break;case ku:o&&o.cpuLoadState&&this.emitDailyJSEvent(o);break;case Cu:o&&o.faceCounts!==void 0&&this.emitDailyJSEvent(o);break;case bu:var Ve=o.activeSpeaker;this._activeSpeaker.peerId!==Ve.peerId&&(this._activeSpeaker.peerId=Ve.peerId,this.emitDailyJSEvent({action:o.action,activeSpeaker:this._activeSpeaker}));break;case"show-local-video-changed":if(this._callObjectMode)return;var Vn=o.show;this._showLocalVideo=Vn,this.emitDailyJSEvent({action:o.action,show:Vn});break;case _u:var nn=o.enabled;this._activeSpeakerMode!==nn&&(this._activeSpeakerMode=nn,this.emitDailyJSEvent({action:o.action,enabled:this._activeSpeakerMode}));break;case Zl:case eu:case tu:this._waitingParticipants=o.allWaitingParticipants,this.emitDailyJSEvent({action:o.action,participant:o.participant});break;case xu:pe(this._receiveSettings,o.receiveSettings)||(this._receiveSettings=o.receiveSettings,this.emitDailyJSEvent({action:o.action,receiveSettings:o.receiveSettings}));break;case Pu:if(!pe(this._inputSettings,o.inputSettings)){var de=this._getInputSettings();this._inputSettings=o.inputSettings,this._preloadCache.inputSettings={},pe(de,this._getInputSettings())||this.emitDailyJSEvent({action:o.action,inputSettings:this._getInputSettings()})}break;case"send-settings-updated":pe(this._sendSettings,o.sendSettings)||(this._sendSettings=o.sendSettings,this._preloadCache.sendSettings=null,this.emitDailyJSEvent({action:o.action,sendSettings:o.sendSettings}));break;case"local-audio-level":this._localAudioLevel=o.audioLevel,this._preloadCache.localAudioLevelObserver=null,this.emitDailyJSEvent(o);break;case"remote-participants-audio-level":this._remoteParticipantsAudioLevel=o.participantsAudioLevel,this._preloadCache.remoteParticipantsAudioLevelObserver=null,this.emitDailyJSEvent(o);break;case pu:var We=o.session_id;this._rmpPlayerState[We]=o.playerState,this.emitDailyJSEvent(o);break;case mu:delete this._rmpPlayerState[o.session_id],this.emitDailyJSEvent(o);break;case fu:var Ct=o.session_id,rn=this._rmpPlayerState[Ct];rn&&this.compareEqualForRMPUpdateEvent(rn,o.remoteMediaPlayerState)||(this._rmpPlayerState[Ct]=o.remoteMediaPlayerState,this.emitDailyJSEvent(o));break;case"custom-button-click":case"sidebar-view-changed":this.emitDailyJSEvent(o);break;case Xl:var hi=this._meetingSessionState.topology!==(o.meetingSessionState&&o.meetingSessionState.topology);this._meetingSessionState=ii(o.meetingSessionState,this._callObjectMode),(this._callObjectMode||hi)&&this.emitDailyJSEvent(o);break;case gu:this._isScreenSharing=!0,this.emitDailyJSEvent(o);break;case vu:case yu:this._isScreenSharing=!1,this.emitDailyJSEvent(o);break;case ba:case _a:case ou:case cu:case lu:case iu:case su:case au:case $l:case ql:case du:case hu:case"test-completed":case Su:case uu:case Eu:case Mu:case Tu:case Ou:case wa:case Au:case"dialin-ready":case"dialin-connected":case"dialin-error":case"dialin-stopped":case"dialin-warning":case"dialout-connected":case"dialout-answered":case"dialout-error":case"dialout-stopped":case"dialout-warning":this.emitDailyJSEvent(o);break;case"request-fullscreen":this.requestFullscreen();break;case"request-exit-fullscreen":this.exitFullscreen()}}},{key:"maybeEventRecordingStopped",value:function(o,u){var d="record";o&&(u.local||u[d]!==!1||o[d]===u[d]||this.emitDailyJSEvent({action:_a}))}},{key:"maybeEventRecordingStarted",value:function(o,u){var d="record";o&&(u.local||u[d]!==!0||o[d]===u[d]||this.emitDailyJSEvent({action:ba}))}},{key:"maybeEventTrackStopped",value:function(o,u,d,g){o&&(o.readyState!=="ended"&&u&&o.id===u.id||this.emitDailyJSEvent({action:ru,track:o,participant:d,type:g}))}},{key:"maybeEventTrackStarted",value:function(o,u,d,g){u&&(o&&o.readyState!=="ended"&&u.id===o.id||this.emitDailyJSEvent({action:nu,track:u,participant:d,type:g}))}},{key:"maybeParticipantTracksStopped",value:function(o,u){if(o)for(var d in o.tracks)this.maybeEventTrackStopped(o.tracks[d].track,u&&u.tracks[d]?u.tracks[d].track:null,u,d)}},{key:"maybeParticipantTracksStarted",value:function(o,u){if(u)for(var d in u.tracks)this.maybeEventTrackStarted(o&&o.tracks[d]?o.tracks[d].track:null,u.tracks[d].track,u,d)}},{key:"compareEqualForRMPUpdateEvent",value:function(o,u){var d,g;return o.state===u.state&&((d=o.settings)===null||d===void 0?void 0:d.volume)===((g=u.settings)===null||g===void 0?void 0:g.volume)}},{key:"emitDailyJSEvent",value:function(o){try{o.callClientId=this.callClientId,this.emit(o.action,o)}catch(u){console.log("could not emit",o,u)}}},{key:"compareEqualForParticipantUpdateEvent",value:function(o,u){return!!pe(o,u)&&(!o.videoTrack||!u.videoTrack||o.videoTrack.id===u.videoTrack.id&&o.videoTrack.muted===u.videoTrack.muted&&o.videoTrack.enabled===u.videoTrack.enabled)&&(!o.audioTrack||!u.audioTrack||o.audioTrack.id===u.audioTrack.id&&o.audioTrack.muted===u.audioTrack.muted&&o.audioTrack.enabled===u.audioTrack.enabled)}},{key:"nativeUtils",value:function(){return H()?typeof DailyNativeUtils>"u"?(console.warn("in React Native, DailyNativeUtils is expected to be available"),null):DailyNativeUtils:null}},{key:"updateIsPreparingToJoin",value:function(o){this._updateCallState(this._callState,o)}},{key:"_updateCallState",value:function(o){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this._isPreparingToJoin;if(o!==this._callState||u!==this._isPreparingToJoin){var d=this._callState,g=this._isPreparingToJoin;this._callState=o,this._isPreparingToJoin=u;var f=this._callState===gt;this.updateShowAndroidOngoingMeetingNotification(f);var M=Fn(d,g),D=Fn(this._callState,this._isPreparingToJoin);M!==D&&(this.updateKeepDeviceAwake(D),this.updateDeviceAudioMode(D),this.updateNoOpRecordingEnsuringBackgroundContinuity(D))}}},{key:"resetMeetingDependentVars",value:function(){this._participants={},this._participantCounts=eo,this._waitingParticipants={},this._activeSpeaker={},this._activeSpeakerMode=!1,this._didPreAuth=!1,this._accessState={access:Fr},this._finalSummaryOfPrevSession=this._meetingSessionSummary,this._meetingSessionSummary={},this._meetingSessionState=ii(Za,this._callObjectMode),this._isScreenSharing=!1,this._receiveSettings={},this._inputSettings=void 0,this._sendSettings={},this._localAudioLevel=0,this._isLocalAudioLevelObserverRunning=!1,this._remoteParticipantsAudioLevel={},this._isRemoteParticipantsAudioLevelObserverRunning=!1,this._maxAppMessageSize=Ur,this._callMachineInitialized=!1,this._bundleLoadTime=void 0,this._preloadCache}},{key:"updateKeepDeviceAwake",value:function(o){H()&&this.nativeUtils().setKeepDeviceAwake(o,this.callClientId)}},{key:"updateDeviceAudioMode",value:function(o){if(H()&&!this.disableReactNativeAutoDeviceManagement("audio")){var u=o?this._nativeInCallAudioMode:"idle";this.nativeUtils().setAudioMode(u)}}},{key:"updateShowAndroidOngoingMeetingNotification",value:function(o){if(H()&&this.nativeUtils().setShowOngoingMeetingNotification){var u,d,g,f;if(this.properties.reactNativeConfig&&this.properties.reactNativeConfig.androidInCallNotification){var M=this.properties.reactNativeConfig.androidInCallNotification;u=M.title,d=M.subtitle,g=M.iconName,f=M.disableForCustomOverride}f&&(o=!1),this.nativeUtils().setShowOngoingMeetingNotification(o,u,d,g,this.callClientId)}}},{key:"updateNoOpRecordingEnsuringBackgroundContinuity",value:function(o){H()&&this.nativeUtils().enableNoOpRecordingEnsuringBackgroundContinuity&&this.nativeUtils().enableNoOpRecordingEnsuringBackgroundContinuity(o)}},{key:"toggleParticipantAudioBasedOnNativeAudioFocus",value:function(){var o,u;if(H()){var d=(o=this._callMachine())===null||o===void 0||(u=o.store)===null||u===void 0?void 0:u.getState();for(var g in d==null?void 0:d.streams){var f=d.streams[g];f&&f.pendingTrack&&f.pendingTrack.kind==="audio"&&(f.pendingTrack.enabled=this._hasNativeAudioFocus)}}}},{key:"disableReactNativeAutoDeviceManagement",value:function(o){return this.properties.reactNativeConfig&&this.properties.reactNativeConfig.disableAutoDeviceManagement&&this.properties.reactNativeConfig.disableAutoDeviceManagement[o]}},{key:"absoluteUrl",value:function(o){if(o!==void 0){var u=document.createElement("a");return u.href=o,u.href}}},{key:"sayHello",value:function(){var o="hello, world.";return console.log(o),o}},{key:"_logUseAfterDestroy",value:function(){var o=Object.values(bt)[0];if(this.needsLoad())if(o&&!o.needsLoad()){var u={action:jn,level:"error",code:this.strictMode?9995:9997};o.sendMessageToCallMachine(u)}else this.strictMode||console.error("You are are attempting to use a call instance that was previously destroyed, which is unsupported. Please remove `strictMode: false` from your constructor properties to enable strict mode to track down and fix this unsupported usage.");else{var d={action:jn,level:"error",code:this.strictMode?9995:9997};this._messageChannel.sendMessageToCallMachine(d,null,this.callClientId,this._iframe)}}},{key:"_logDuplicateInstanceAttempt",value:function(){for(var o=0,u=Object.values(bt);o<u.length;o++){var d=u[o];d._callMachineInitialized?(d.sendMessageToCallMachine({action:jn,level:"warn",code:this.allowMultipleCallInstances?9993:9992}),d._delayDuplicateInstanceLog=!1):d._delayDuplicateInstanceLog=!0}}},{key:"_maybeSendToSentry",value:function(o){var u,d,g,f,M,D;if(!((u=o.error)!==null&&u!==void 0&&u.type&&(![Il,Dl,va].includes(o.error.type)||o.error.type===va&&o.error.msg.includes("deleted")))){var B=(d=this.properties)!==null&&d!==void 0&&d.url?new URL(this.properties.url):void 0,W="production";B&&B.host.includes(".staging.daily")&&(W="staging");var ce,ne,Je,it,Ve,Vn=[sl(),rl(),El(),kl(),Al(),Pl(),al(),xl()].filter(function(pi){return!["BrowserApiErrors","Breadcrumbs","GlobalHandlers"].includes(pi.name)}),nn=new dl({dsn:"https://f10f1c81e5d44a4098416c0867a8b740@o77906.ingest.sentry.io/168844",transport:gl,stackParser:Sl,integrations:Vn,environment:W}),de=new et;if(de.setClient(nn),nn.init(),this.session_id&&de.setExtra("sessionId",this.session_id),this.properties){var We=$({},this.properties);We.userName=We.userName?"[Filtered]":void 0,We.userData=We.userData?"[Filtered]":void 0,We.token=We.token?"[Filtered]":void 0,de.setExtra("properties",We)}if(B){var Ct=B.searchParams.get("domain");if(!Ct){var rn=B.host.match(/(.*?)\./);Ct=rn&&rn[1]||""}Ct&&de.setTag("domain",Ct)}o.error&&(de.setTag("fatalErrorType",o.error.type),de.setExtra("errorDetails",o.error.details),!((ce=o.error.details)===null||ce===void 0)&&ce.uri&&de.setTag("serverAddress",o.error.details.uri),!((ne=o.error.details)===null||ne===void 0)&&ne.workerGroup&&de.setTag("workerGroup",o.error.details.workerGroup),!((Je=o.error.details)===null||Je===void 0)&&Je.geoGroup&&de.setTag("geoGroup",o.error.details.geoGroup),!((it=o.error.details)===null||it===void 0)&&it.on&&de.setTag("connectionAttempt",o.error.details.on),(Ve=o.error.details)!==null&&Ve!==void 0&&Ve.bundleUrl&&(de.setTag("bundleUrl",o.error.details.bundleUrl),de.setTag("bundleError",o.error.details.sourceError.type))),de.setTags({callMode:this._callObjectMode?H()?"reactNative":(g=this.properties)!==null&&g!==void 0&&(f=g.dailyConfig)!==null&&f!==void 0&&(M=f.callMode)!==null&&M!==void 0&&M.includes("prebuilt")?this.properties.dailyConfig.callMode:"custom":"prebuilt-frame",version:ue.version()});var hi=((D=o.error)===null||D===void 0?void 0:D.msg)||o.errorMsg;de.captureException(new Error(hi))}}},{key:"_callMachine",value:function(){var o,u,d;return(o=window._daily)===null||o===void 0||(u=o.instances)===null||u===void 0||(d=u[this.callClientId])===null||d===void 0?void 0:d.callMachine}}],[{key:"supportedBrowser",value:function(){if(H())return{supported:!0,mobile:!0,name:"React Native",version:null,supportsScreenShare:!0,supportsSfu:!0,supportsVideoProcessing:!1,supportsAudioProcessing:!1};var o=Sc.getParser(we());return{supported:!!La(),mobile:o.getPlatformType()==="mobile",name:o.getBrowserName(),version:o.getBrowserVersion(),supportsFullscreen:!!Aa(),supportsScreenShare:!!Du(),supportsSfu:!!La(),supportsVideoProcessing:xa(),supportsAudioProcessing:Pa()}}},{key:"version",value:function(){return"0.73.0"}},{key:"createCallObject",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return o.layout="none",new ue(null,o)}},{key:"wrap",value:function(o){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(V(),!o||!o.contentWindow||typeof o.src!="string")throw new Error("DailyIframe::Wrap needs an iframe-like first argument");return u.layout||(u.customLayout?u.layout="custom-v1":u.layout="browser"),new ue(o,u)}},{key:"createFrame",value:function(o,u){var d,g;V(),o&&u?(d=o,g=u):o&&o.append?(d=o,g={}):(d=document.body,g=o||{});var f=g.iframeStyle;f||(f=d===document.body?{position:"fixed",border:"1px solid black",backgroundColor:"white",width:"375px",height:"450px",right:"1em",bottom:"1em"}:{border:0,width:"100%",height:"100%"});var M=document.createElement("iframe");window.navigator&&window.navigator.userAgent.match(/Chrome\/61\./)?M.allow="microphone, camera":M.allow="microphone; camera; autoplay; display-capture; screen-wake-lock",M.style.visibility="hidden",d.appendChild(M),M.style.visibility=null,Object.keys(f).forEach(function(D){return M.style[D]=f[D]}),g.layout||(g.customLayout?g.layout="custom-v1":g.layout="browser");try{return new ue(M,g)}catch(D){throw d.removeChild(M),D}}},{key:"createTransparentFrame",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};V();var u=document.createElement("iframe");return u.allow="microphone; camera; autoplay",u.style.cssText=`
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border: 0;
      pointer-events: none;
    `,document.body.appendChild(u),o.layout||(o.layout="custom-v1"),ue.wrap(u,o)}},{key:"getCallInstance",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:void 0;return o?bt[o]:Object.values(bt)[0]}}]),ue}();function Nt(t,e){var n={};for(var r in t)if(t[r]instanceof MediaStreamTrack)n[r]=Ht;else if(r==="dailyConfig"){if(t[r].modifyLocalSdpHook){var i=window._daily.instances[e].customCallbacks||{};i.modifyLocalSdpHook=t[r].modifyLocalSdpHook,window._daily.instances[e].customCallbacks=i,delete t[r].modifyLocalSdpHook}if(t[r].modifyRemoteSdpHook){var s=window._daily.instances[e].customCallbacks||{};s.modifyRemoteSdpHook=t[r].modifyRemoteSdpHook,window._daily.instances[e].customCallbacks=s,delete t[r].modifyRemoteSdpHook}n[r]=t[r]}else n[r]=t[r];return n}function Z(t){var e=arguments.length>2?arguments[2]:void 0;if(t!==gt){var n="".concat(arguments.length>1&&arguments[1]!==void 0?arguments[1]:"This daily-js method"," only supported after join.");throw e&&(n+=" ".concat(e)),console.error(n),new Error(n)}}function Fn(t,e){return[Br,gt].includes(t)||e}function ti(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"This daily-js method",r=arguments.length>3?arguments[3]:void 0;if(Fn(t,e)){var i="".concat(n," not supported after joining a meeting.");throw r&&(i+=" ".concat(r)),console.error(i),new Error(i)}}function Un(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"This daily-js method",n=arguments.length>2?arguments[2]:void 0;if(!t){var r="".concat(e,arguments.length>3&&arguments[3]!==void 0&&arguments[3]?" requires preAuth() or startCamera() to initialize call state.":" requires preAuth(), startCamera(), or join() to initialize call state.");throw n&&(r+=" ".concat(n)),console.error(r),new Error(r)}}function ni(t){if(t){var e="A pre-call quality test is in progress. Please try ".concat(arguments.length>1&&arguments[1]!==void 0?arguments[1]:"This daily-js method"," again once testing has completed. Use stopTestCallQuality() to end it early.");throw console.error(e),new Error(e)}}function Oe(t){if(!t){var e="".concat(arguments.length>1&&arguments[1]!==void 0?arguments[1]:"This daily-js method"," is only supported on custom callObject instances");throw console.error(e),new Error(e)}}function ve(t){if(t){var e="".concat(arguments.length>1&&arguments[1]!==void 0?arguments[1]:"This daily-js method"," is only supported as part of Daily's Prebuilt");throw console.error(e),new Error(e)}}function V(){if(H())throw new Error("This daily-js method is not currently supported in React Native")}function Yt(){if(!H())throw new Error("This daily-js method is only supported in React Native")}function so(t){if(t===void 0)return!0;var e;if(typeof t=="string")e=t;else try{e=JSON.stringify(t),pe(JSON.parse(e),t)||console.warn("The userData provided will be modified when serialized.")}catch(n){throw Error("userData must be serializable to JSON: ".concat(n))}if(e.length>4096)throw Error("userData is too large (".concat(e.length," characters). Maximum size suppported is ").concat(4096,"."));return!0}function ao(t,e){for(var n=e.allowAllParticipantsKey,r=function(m){var b=["local"];return n||b.push("*"),m&&!b.includes(m)},i=function(m){return!!(m.layer===void 0||Number.isInteger(m.layer)&&m.layer>=0||m.layer==="inherit")},s=function(m){return!!m&&!(m.video&&!i(m.video))&&!(m.screenVideo&&!i(m.screenVideo))},a=0,l=Object.entries(t);a<l.length;a++){var c=ot(l[a],2),h=c[0],p=c[1];if(!r(h)||!s(p))return!1}return!0}function oo(t){return Q(t)==="object"&&!(t.video&&(Q(t.video)!=="object"||!function(i){var s=["type","config"];return!i||Q(i)!=="object"||!function(a){return typeof a!="string"?!1:Object.values(Dn).includes(a)?!0:(console.error("inputSettings video processor type invalid"),!1)}(i.type)||i.config&&(Q(i.config)!=="object"||!function(a,l){var c=Object.keys(l);if(c.length===0)return!0;var h="invalid object in inputSettings -> video -> processor -> config";switch(a){case Dn.BGBLUR:return c.length>1||c[0]!=="strength"?(console.error(h),!1):!(typeof l.strength!="number"||l.strength<=0||l.strength>1||isNaN(l.strength))||(console.error("".concat(h,"; expected: {0 < strength <= 1}, got: ").concat(l.strength)),!1);case Dn.BGIMAGE:return!(l.source!==void 0&&!function(p){if(p.source==="default")return p.type="default",!0;if(p.source instanceof ArrayBuffer)return!0;if(pn(p.source))return p.type="url",!!function(v){var _=new URL(v),S=_.pathname;if(_.protocol==="data:")try{var L=S.substring(S.indexOf(":")+1,S.indexOf(";")).split("/")[1];return Jr.includes(L)}catch(T){return console.error("failed to deduce blob content type",T),!1}var C=S.split(".").at(-1).toLowerCase().trim();return Jr.includes(C)}(p.source)||(console.error("invalid image type; supported types: [".concat(Jr.join(", "),"]")),!1);return m=p.source,b=Number(m),isNaN(b)||!Number.isInteger(b)||b<=0||b>10?(console.error("invalid image selection; must be an int, > 0, <= ".concat(10)),!1):(p.type="daily-preselect",!0);var m,b}(l));default:return!0}}(i.type,i.config))?!1:(Object.keys(i).filter(function(a){return!s.includes(a)}).forEach(function(a){console.warn("invalid key inputSettings -> video -> processor : ".concat(a)),delete i[a]}),!0)}(t.video.processor)))&&!(t.audio&&(Q(t.audio)!=="object"||(n=t.audio.processor,r=["type"],!n||Q(n)!=="object"||(Object.keys(n).filter(function(i){return!r.includes(i)}).forEach(function(i){console.warn("invalid key inputSettings -> audio -> processor : ".concat(i)),delete n[i]}),e=n.type,typeof e!="string"||!Object.values(Ma).includes(e)&&(console.error("inputSettings audio processor type invalid"),1)))));var e,n,r}function co(t,e){var n,r=[];t.video&&!xa((n=e==null?void 0:e.useLegacyVideoProcessor)!==null&&n!==void 0&&n)&&(delete t.video,r.push("video")),t.audio&&!Pa()&&(delete t.audio,r.push("audio")),r.length>0&&console.error("Ignoring settings for browser- or platform-unsupported input processor(s): ".concat(r.join(", ")))}function ri(){var t=Object.values(Dn).join(" | "),e=Object.values(Ma).join(" | ");return"inputSettings must be of the form: { video?: { processor: { type: [ ".concat(t," ], config?: {} } }, audio?: { processor: {type: [ ").concat(e," ] } } }")}function lo(t){var e=t.allowAllParticipantsKey;return"receiveSettings must be of the form { [<remote participant id> | ".concat(jl).concat(e?' | "'.concat("*",'"'):"","]: ")+'{ [video: [{ layer: [<non-negative integer> | "inherit"] } | "inherit"]], [screenVideo: [{ layer: [<non-negative integer> | "inherit"] } | "inherit"]] }}}'}function uo(){return"customIntegrations should be an object of type ".concat(JSON.stringify(ei),".")}function ho(t){if(t&&Q(t)!=="object"||Array.isArray(t))return console.error("customTrayButtons should be an Object of the type ".concat(JSON.stringify(Rn),".")),!1;if(t)for(var e=0,n=Object.entries(t);e<n.length;e++)for(var r=ot(n[e],1)[0],i=0,s=Object.entries(t[r]);i<s.length;i++){var a=ot(s[i],2),l=a[0],c=a[1],h=Rn.id[l];if(!h)return console.error("customTrayButton does not support key ".concat(l)),!1;switch(l){case"iconPath":case"iconPathDarkMode":if(!pn(c))return console.error("customTrayButton ".concat(l," should be a url.")),!1;break;case"visualState":if(!["default","sidebar-open","active"].includes(c))return console.error("customTrayButton ".concat(l," should be ").concat(h,". Got: ").concat(c)),!1;break;default:if(Q(c)!==h)return console.error("customTrayButton ".concat(l," should be a ").concat(h,".")),!1}}return!0}function po(t){if(!t||t&&Q(t)!=="object"||Array.isArray(t))return console.error(uo()),!1;for(var e=function(m){return"".concat(m," should be ").concat(ei.id[m])},n=function(m,b){return console.error("customIntegration ".concat(m,": ").concat(b))},r=0,i=Object.entries(t);r<i.length;r++){var s=ot(i[r],1)[0];if(!("label"in t[s]))return n(s,"label is required"),!1;if(!("location"in t[s]))return n(s,"location is required"),!1;if(!("src"in t[s])&&!("srcdoc"in t[s]))return n(s,"src or srcdoc is required"),!1;for(var a=0,l=Object.entries(t[s]);a<l.length;a++){var c=ot(l[a],2),h=c[0],p=c[1];switch(h){case"allow":case"csp":case"name":case"referrerPolicy":case"sandbox":if(typeof p!="string")return n(s,e(h)),!1;break;case"iconURL":if(!pn(p))return n(s,"".concat(h," should be a url")),!1;break;case"src":if("srcdoc"in t[s])return n(s,"cannot have both src and srcdoc"),!1;if(!pn(p))return n(s,'src "'.concat(p,'" is not a valid URL')),!1;break;case"srcdoc":if("src"in t[s])return n(s,"cannot have both src and srcdoc"),!1;if(typeof p!="string")return n(s,e(h)),!1;break;case"location":if(!["main","sidebar"].includes(p))return n(s,e(h)),!1;break;case"controlledBy":if(p!=="*"&&p!=="owners"&&(!Array.isArray(p)||p.some(function(m){return typeof m!="string"})))return n(s,e(h)),!1;break;case"shared":if((!Array.isArray(p)||p.some(function(m){return typeof m!="string"}))&&p!=="owners"&&typeof p!="boolean")return n(s,e(h)),!1;break;default:if(!ei.id[h])return console.error("customIntegration does not support key ".concat(h)),!1}}}return!0}function fo(t,e){if(e===void 0)return!1;switch(Q(e)){case"string":return Q(t)===e;case"object":if(Q(t)!=="object")return!1;for(var n in t)if(!fo(t[n],e[n]))return!1;return!0;default:return!1}}function mo(t,e){var n=t.sessionId,r=t.toEndPoint,i=t.useSipRefer;if(!n||!r)throw new Error("".concat(e,"() requires a sessionId and toEndPoint"));if(typeof n!="string"||typeof r!="string")throw new Error("Invalid paramater: sessionId and toEndPoint must be of type string");if(i&&!r.startsWith("sip:"))throw new Error('"toEndPoint" must be a "sip" address');if(!r.startsWith("sip:")&&!r.startsWith("+"))throw new Error("toEndPoint: ".concat(r,' must starts with either "sip:" or "+"'))}function go(t){if(Q(t)!=="object")throw new Error('RemoteMediaPlayerSettings: must be "object" type');if(t.state&&!Object.values(qr).includes(t.state))throw new Error("Invalid value for RemoteMediaPlayerSettings.state, valid values are: "+JSON.stringify(qr));if(t.volume){if(typeof t.volume!="number")throw new Error('RemoteMediaPlayerSettings.volume: must be "number" type');if(t.volume<0||t.volume>2)throw new Error("RemoteMediaPlayerSettings.volume: must be between 0.0 - 2.0")}}function vo(t,e,n){return!(typeof t!="number"||t<e||t>n)}function ii(t,e){return t&&!e&&delete t.data,t}function od(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}var cd={};od(cd,"DailyTransport",()=>yo);class yo extends Fi{constructor({dailyFactoryOptions:e={}}={}){super(),this._botId="",this._selectedCam={},this._selectedMic={},this._selectedSpeaker={},this._dailyFactoryOptions=e}initialize(e,n){this._callbacks=e.callbacks??{},this._onMessage=n;const r=io.getCallInstance();r&&r.destroy(),this._daily=io.createCallObject({...this._dailyFactoryOptions,startVideoOff:e.enableCam!=!0,startAudioOff:e.enableMic==!1,allowMultipleCallInstances:!0}),this.attachEventListeners(),this.state="disconnected",Y.debug("[RTVI Transport] Initialized")}get state(){return this._state}set state(e){var n,r;this._state!==e&&(this._state=e,(r=(n=this._callbacks).onTransportStateChanged)==null||r.call(n,e))}async getAllCams(){const{devices:e}=await this._daily.enumerateDevices();return e.filter(n=>n.kind==="videoinput")}updateCam(e){this._daily.setInputDevicesAsync({videoDeviceId:e}).then(n=>{this._selectedCam=n.camera})}get selectedCam(){return this._selectedCam}async getAllMics(){const{devices:e}=await this._daily.enumerateDevices();return e.filter(n=>n.kind==="audioinput")}updateMic(e){this._daily.setInputDevicesAsync({audioDeviceId:e}).then(n=>{this._selectedMic=n.mic})}get selectedMic(){return this._selectedMic}async getAllSpeakers(){const{devices:e}=await this._daily.enumerateDevices();return e.filter(n=>n.kind==="audiooutput")}updateSpeaker(e){this._daily.setOutputDeviceAsync({outputDeviceId:e}).then(n=>{this._selectedSpeaker=n.speaker})}get selectedSpeaker(){return this._selectedSpeaker}enableMic(e){this._daily.setLocalAudio(e)}get isMicEnabled(){return this._daily.localAudio()}enableCam(e){this._daily.setLocalVideo(e)}get isCamEnabled(){return this._daily.localVideo()}enableScreenShare(e){e?this._daily.startScreenShare():this._daily.stopScreenShare()}get isSharingScreen(){return this._daily.localScreenAudio()||this._daily.localScreenVideo()}tracks(){var i,s,a,l,c,h,p,m,b,v,_,S,L,C,T,A,y;const e=((i=this._daily)==null?void 0:i.participants())??{},n=e==null?void 0:e[this._botId],r={local:{audio:(l=(a=(s=e==null?void 0:e.local)==null?void 0:s.tracks)==null?void 0:a.audio)==null?void 0:l.persistentTrack,screenAudio:(p=(h=(c=e==null?void 0:e.local)==null?void 0:c.tracks)==null?void 0:h.screenAudio)==null?void 0:p.persistentTrack,screenVideo:(v=(b=(m=e==null?void 0:e.local)==null?void 0:m.tracks)==null?void 0:b.screenVideo)==null?void 0:v.persistentTrack,video:(L=(S=(_=e==null?void 0:e.local)==null?void 0:_.tracks)==null?void 0:S.video)==null?void 0:L.persistentTrack}};return n&&(r.bot={audio:(T=(C=n==null?void 0:n.tracks)==null?void 0:C.audio)==null?void 0:T.persistentTrack,video:(y=(A=n==null?void 0:n.tracks)==null?void 0:A.video)==null?void 0:y.persistentTrack}),r}async initDevices(){var a,l,c,h,p,m,b,v,_,S,L,C;if(!this._daily)throw new be("Transport instance not initialized");this.state="initializing";const e=await this._daily.startCamera(),{devices:n}=await this._daily.enumerateDevices(),r=n.filter(T=>T.kind==="videoinput"),i=n.filter(T=>T.kind==="audioinput"),s=n.filter(T=>T.kind==="audiooutput");(l=(a=this._callbacks).onAvailableCamsUpdated)==null||l.call(a,r),(h=(c=this._callbacks).onAvailableMicsUpdated)==null||h.call(c,i),(m=(p=this._callbacks).onAvailableSpeakersUpdated)==null||m.call(p,s),this._selectedCam=e.camera,(v=(b=this._callbacks).onCamUpdated)==null||v.call(b,e.camera),this._selectedMic=e.mic,(S=(_=this._callbacks).onMicUpdated)==null||S.call(_,e.mic),this._selectedSpeaker=e.speaker,(C=(L=this._callbacks).onSpeakerUpdated)==null||C.call(L,e.speaker),this._daily.isLocalAudioLevelObserverRunning()||await this._daily.startLocalAudioLevelObserver(100),this._daily.isRemoteParticipantsAudioLevelObserverRunning()||await this._daily.startRemoteParticipantsAudioLevelObserver(100),this.state="initialized"}async connect(e,n){var r,i,s;if(!this._daily)throw new be("Transport instance not initialized");if(!n.signal.aborted){this.state="connecting";try{await this._daily.join({url:e.room_url,token:e.token});const a=await this._daily.room();a&&"id"in a&&(this._expiry=(r=a.config)==null?void 0:r.exp)}catch{throw this.state="error",new Pi}n.signal.aborted||(this.state="connected",(s=(i=this._callbacks).onConnected)==null||s.call(i))}}async sendReadyMessage(){return new Promise(e=>{(async()=>this._daily.on("track-started",n=>{var r;(r=n.participant)!=null&&r.local||(this.state="ready",this.sendMessage(se.clientReady()),e())}))()})}attachEventListeners(){this._daily.on("available-devices-updated",this.handleAvailableDevicesUpdated.bind(this)),this._daily.on("selected-devices-updated",this.handleSelectedDevicesUpdated.bind(this)),this._daily.on("track-started",this.handleTrackStarted.bind(this)),this._daily.on("track-stopped",this.handleTrackStopped.bind(this)),this._daily.on("participant-joined",this.handleParticipantJoined.bind(this)),this._daily.on("participant-left",this.handleParticipantLeft.bind(this)),this._daily.on("local-audio-level",this.handleLocalAudioLevel.bind(this)),this._daily.on("remote-participants-audio-level",this.handleRemoteAudioLevel.bind(this)),this._daily.on("app-message",this.handleAppMessage.bind(this)),this._daily.on("left-meeting",this.handleLeftMeeting.bind(this)),this._daily.on("nonfatal-error",this.handleNonFatalError.bind(this))}async disconnect(){this._daily.stopLocalAudioLevelObserver(),this._daily.stopRemoteParticipantsAudioLevelObserver(),await this._daily.leave(),await this._daily.destroy()}sendMessage(e){this._daily.sendAppMessage(e,"*")}handleAppMessage(e){e.data.label==="rtvi-ai"&&this._onMessage({id:e.data.id,type:e.data.type,data:e.data.data})}handleAvailableDevicesUpdated(e){var n,r,i,s,a,l;(r=(n=this._callbacks).onAvailableCamsUpdated)==null||r.call(n,e.availableDevices.filter(c=>c.kind==="videoinput")),(s=(i=this._callbacks).onAvailableMicsUpdated)==null||s.call(i,e.availableDevices.filter(c=>c.kind==="audioinput")),(l=(a=this._callbacks).onAvailableSpeakersUpdated)==null||l.call(a,e.availableDevices.filter(c=>c.kind==="audiooutput"))}handleSelectedDevicesUpdated(e){var n,r,i,s,a,l,c,h,p;((n=this._selectedCam)==null?void 0:n.deviceId)!==e.devices.camera&&(this._selectedCam=e.devices.camera,(i=(r=this._callbacks).onCamUpdated)==null||i.call(r,e.devices.camera)),((s=this._selectedMic)==null?void 0:s.deviceId)!==e.devices.mic&&(this._selectedMic=e.devices.mic,(l=(a=this._callbacks).onMicUpdated)==null||l.call(a,e.devices.mic)),((c=this._selectedSpeaker)==null?void 0:c.deviceId)!==e.devices.speaker&&(this._selectedSpeaker=e.devices.speaker,(p=(h=this._callbacks).onSpeakerUpdated)==null||p.call(h,e.devices.speaker))}handleTrackStarted(e){var n,r,i,s;e.type==="screenAudio"||e.type==="screenVideo"?(r=(n=this._callbacks).onScreenTrackStarted)==null||r.call(n,e.track,e.participant?wt(e.participant):void 0):(s=(i=this._callbacks).onTrackStarted)==null||s.call(i,e.track,e.participant?wt(e.participant):void 0)}handleTrackStopped(e){var n,r,i,s;e.type==="screenAudio"||e.type==="screenVideo"?(r=(n=this._callbacks).onScreenTrackStopped)==null||r.call(n,e.track,e.participant?wt(e.participant):void 0):(s=(i=this._callbacks).onTrackStopped)==null||s.call(i,e.track,e.participant?wt(e.participant):void 0)}handleParticipantJoined(e){var r,i,s,a;const n=wt(e.participant);(i=(r=this._callbacks).onParticipantJoined)==null||i.call(r,n),!n.local&&(this._botId=e.participant.session_id,(a=(s=this._callbacks).onBotConnected)==null||a.call(s,n))}handleParticipantLeft(e){var r,i,s,a;const n=wt(e.participant);(i=(r=this._callbacks).onParticipantLeft)==null||i.call(r,n),!n.local&&(this._botId="",(a=(s=this._callbacks).onBotDisconnected)==null||a.call(s,n))}handleLocalAudioLevel(e){var n,r;(r=(n=this._callbacks).onLocalAudioLevel)==null||r.call(n,e.audioLevel)}handleRemoteAudioLevel(e){var i,s;const n=this._daily.participants(),r=Object.keys(e.participantsAudioLevel);for(let a=0;a<r.length;a++){const l=r[a],c=e.participantsAudioLevel[l];(s=(i=this._callbacks).onRemoteAudioLevel)==null||s.call(i,c,wt(n[l]))}}handleLeftMeeting(){var e,n;this.state="disconnecting",this._botId="",(n=(e=this._callbacks).onDisconnected)==null||n.call(e)}handleNonFatalError(e){var n,r;switch(e.type){case"screen-share-error":(r=(n=this._callbacks).onScreenShareError)==null||r.call(n,e.errorMsg);break}}}const wt=t=>({id:t.user_id,local:t.local,name:t.user_name}),bo=F.createContext(null),ld=({children:t})=>{const e=F.useRef(new De({transport:new yo,params:{baseUrl:"https://quibble-web.quibbleai.io:7860",endpoints:{connect:"/connect"}},enableMic:!0}));return j.jsx(bo.Provider,{value:e.current,children:t})},ud=()=>{const t=F.useContext(bo);if(!t)throw new Error("usePipeCat must be used within a PipeCatProvider");return t},Ue={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};let dd=0;function me(t,e){const n=`atom${++dd}`,r={toString(){return(Ue?"production":void 0)!=="production"&&this.debugLabel?n+":"+this.debugLabel:n}};return typeof t=="function"?r.read=t:(r.init=t,r.read=hd,r.write=pd),e&&(r.write=e),r}function hd(t){return t(this)}function pd(t,e,n){return e(this,typeof n=="function"?n(t(this)):n)}const _o=(t,e)=>t.unstable_is?t.unstable_is(e):e===t,si=t=>"init"in t,ai=t=>!!t.write,$n=new WeakMap,oi=t=>{var e;return ci(t)&&!((e=$n.get(t))!=null&&e[1])},fd=(t,e)=>{const n=$n.get(t);if(n)n[1]=!0,n[0].forEach(r=>r(e));else if((Ue?"production":void 0)!=="production")throw new Error("[Bug] cancelable promise not found")},md=t=>{if($n.has(t))return;const e=[new Set,!1];$n.set(t,e);const n=()=>{e[1]=!0};t.then(n,n),t.onCancel=r=>{e[0].add(r)}},ci=t=>typeof(t==null?void 0:t.then)=="function",wo=t=>"v"in t||"e"in t,qn=t=>{if("e"in t)throw t.e;if((Ue?"production":void 0)!=="production"&&!("v"in t))throw new Error("[Bug] atom state is not initialized");return t.v},So=(t,e,n)=>{n.p.has(t)||(n.p.add(t),e.then(()=>{n.p.delete(t)},()=>{n.p.delete(t)}))},ko=(t,e,n,r,i)=>{var s;if((Ue?"production":void 0)!=="production"&&r===e)throw new Error("[Bug] atom cannot depend on itself");n.d.set(r,i.n),oi(n.v)&&So(e,n.v,i),(s=i.m)==null||s.t.add(e),t&&gd(t,r,e)},Xt=()=>({D:new Map,H:new Set,M:new Set,L:new Set}),Zt=(t,e,n)=>{t[e].add(n)},Co=(t,e,n)=>{t.D.has(e)||(t.D.set(e,new Set),Zt(t,"M",()=>{var r;(r=n.m)==null||r.l.forEach(i=>Zt(t,"M",i))}))},gd=(t,e,n)=>{const r=t.D.get(e);r&&r.add(n)},vd=(t,e)=>t.D.get(e),St=t=>{let e,n=!1;const r=i=>{try{i()}catch(s){n||(e=s,n=!0)}};for(;t.H.size||t.M.size||t.L.size;)t.D.clear(),t.H.forEach(r),t.H.clear(),t.M.forEach(r),t.M.clear(),t.L.forEach(r),t.L.clear();if(n)throw e},Eo=(...[t,e,n,r])=>{const i=(C,T,A)=>{const y="v"in T,w=T.v,E=oi(T.v)?T.v:null;if(ci(A)){md(A);for(const k of T.d.keys())So(C,A,t(k));T.v=A}else T.v=A;delete T.e,delete T.x,(!y||!Object.is(w,T.v))&&(++T.n,E&&fd(E,A))},s=(C,T)=>{var A;const y=t(T);if(wo(y)&&(y.m&&!y.x||Array.from(y.d).every(([x,N])=>s(C,x).n===N)))return y;y.d.clear();let w=!0;const E=x=>{if(_o(T,x)){const q=t(x);if(!wo(q))if(si(x))i(x,q,x.init);else throw new Error("no atom init");return qn(q)}const N=s(C,x);try{return qn(N)}finally{if(w)ko(C,T,y,x,N);else{const q=Xt();ko(q,T,y,x,N),m(q,T,y),St(q)}}};let k,P;const I={get signal(){return k||(k=new AbortController),k.signal},get setSelf(){return(Ue?"production":void 0)!=="production"&&!ai(T)&&console.warn("setSelf function cannot be used with read-only atom"),!P&&ai(T)&&(P=(...x)=>{if((Ue?"production":void 0)!=="production"&&w&&console.warn("setSelf function cannot be called in sync"),!w)return p(T,...x)}),P}};try{const x=e(T,E,I);if(i(T,y,x),ci(x)){(A=x.onCancel)==null||A.call(x,()=>k==null?void 0:k.abort());const N=()=>{if(y.m){const q=Xt();m(q,T,y),St(q)}};x.then(N,N)}return y}catch(x){return delete y.v,y.e=x,delete y.x,++y.n,y}finally{w=!1}},a=C=>qn(s(void 0,C)),l=(C,T,A)=>{var y,w;const E=new Map;for(const k of((y=A.m)==null?void 0:y.t)||[]){const P=t(k);P.m&&E.set(k,P)}for(const k of A.p)E.set(k,t(k));return(w=vd(C,T))==null||w.forEach(k=>{E.set(k,t(k))}),E},c=(C,T,A)=>{const y=[],w=new Set,E=new Set,k=[[T,A]];for(;k.length>0;){const[P,I]=k[k.length-1];if(E.has(P)){k.pop();continue}if(w.has(P)){y.push([P,I,I.n]),E.add(P),I.x=!0,k.pop();continue}w.add(P);for(const[x,N]of l(C,P,I))P!==x&&!w.has(x)&&k.push([x,N])}Zt(C,"H",()=>{const P=new Set([T]);for(let I=y.length-1;I>=0;--I){const[x,N,q]=y[I];let oe=!1;for(const ye of N.d.keys())if(ye!==x&&P.has(ye)){oe=!0;break}oe&&(s(C,x),m(C,x,N),q!==N.n&&(Co(C,x,N),P.add(x))),delete N.x}})},h=(C,T,...A)=>{let y=!0;const w=k=>qn(s(C,k)),E=(k,...P)=>{const I=t(k);try{if(_o(T,k)){if(!si(k))throw new Error("atom not writable");const x=I.n,N=P[0];i(k,I,N),m(C,k,I),x!==I.n&&(Co(C,k,I),c(C,k,I));return}else return h(C,k,...P)}finally{y||St(C)}};try{return n(T,w,E,...A)}finally{y=!1}},p=(C,...T)=>{const A=Xt();try{return h(A,C,...T)}finally{St(A)}},m=(C,T,A)=>{if(A.m&&!oi(A.v)){for(const y of A.d.keys())A.m.d.has(y)||(b(C,y,t(y)).t.add(T),A.m.d.add(y));for(const y of A.m.d||[])if(!A.d.has(y)){A.m.d.delete(y);const w=v(C,y,t(y));w==null||w.t.delete(T)}}},b=(C,T,A)=>{if(!A.m){s(C,T);for(const y of A.d.keys())b(C,y,t(y)).t.add(T);if(A.m={l:new Set,d:new Set(A.d.keys()),t:new Set},ai(T)){const y=A.m;let w;const E=(k,P)=>{let I=!0;w=(...x)=>{try{return h(k,T,...x)}finally{I||St(k)}};try{return P()}finally{I=!1}};Zt(C,"L",()=>{const k=E(C,()=>r(T,(...P)=>w(...P)));k&&(y.u=P=>E(P,k))})}}return A.m},v=(C,T,A)=>{if(A.m&&!A.m.l.size&&!Array.from(A.m.t).some(y=>{var w;return(w=t(y).m)==null?void 0:w.d.has(T)})){const y=A.m.u;y&&Zt(C,"L",()=>y(C)),delete A.m;for(const w of A.d.keys()){const E=v(C,w,t(w));E==null||E.t.delete(T)}return}return A.m};return{get:a,set:p,sub:(C,T)=>{const A=Xt(),y=t(C),E=b(A,C,y).l;return E.add(T),St(A),()=>{E.delete(T);const k=Xt();v(k,C,y),St(k)}},unstable_derive:C=>Eo(...C(t,e,n,r))}},yd=t=>{const e=new WeakMap,n=new Set;let r,i=0;const s=t.unstable_derive((c,h,p,m)=>(r=c,[b=>{let v=e.get(b);if(!v){const _=c(b);v=new Proxy(_,{set(S,L,C){return L==="m"&&n.add(b),Reflect.set(S,L,C)},deleteProperty(S,L){return L==="m"&&n.delete(b),Reflect.deleteProperty(S,L)}}),e.set(b,v)}return v},h,(b,v,_,...S)=>i?_(b,...S):p(b,v,_,...S),m])),a=s.set;return Object.assign(s,{dev4_get_internal_weak_map:()=>({get:c=>{const h=r(c);if(h.n!==0)return h}}),dev4_get_mounted_atoms:()=>n,dev4_restore_atoms:c=>{a({read:()=>null,write:(p,m)=>{++i;try{for(const[b,v]of c)si(b)&&m(b,v)}finally{--i}}})}})},Mo=()=>{const t=new WeakMap,n=Eo(r=>{if((Ue?"production":void 0)!=="production"&&!r)throw new Error("Atom is undefined or null");let i=t.get(r);return i||(i={d:new Map,p:new Set,n:0},t.set(r,i)),i},(r,...i)=>r.read(...i),(r,...i)=>r.write(...i),(r,...i)=>{var s;return(s=r.onMount)==null?void 0:s.call(r,...i)});return(Ue?"production":void 0)!=="production"?yd(n):n};let en;const bd=()=>(en||(en=Mo(),(Ue?"production":void 0)!=="production"&&(globalThis.__JOTAI_DEFAULT_STORE__||(globalThis.__JOTAI_DEFAULT_STORE__=en),globalThis.__JOTAI_DEFAULT_STORE__!==en&&console.warn("Detected multiple Jotai instances. It may cause unexpected behavior with the default store. https://github.com/pmndrs/jotai/discussions/2044"))),en),To={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},_d=F.createContext(void 0),Oo=t=>{const e=F.useContext(_d);return(t==null?void 0:t.store)||e||bd()},li=t=>typeof(t==null?void 0:t.then)=="function",Ao=t=>{t.status="pending",t.then(e=>{t.status="fulfilled",t.value=e},e=>{t.status="rejected",t.reason=e})},wd=F.use||(t=>{if(t.status==="pending")throw t;if(t.status==="fulfilled")return t.value;throw t.status==="rejected"?t.reason:(Ao(t),t)}),ui=new WeakMap,xo=t=>{let e=ui.get(t);return e||(e=new Promise((n,r)=>{let i=t;const s=c=>h=>{i===c&&n(h)},a=c=>h=>{i===c&&r(h)},l=c=>{"onCancel"in c&&typeof c.onCancel=="function"&&c.onCancel(h=>{if((To?"production":void 0)!=="production"&&h===c)throw new Error("[Bug] p is not updated even after cancelation");li(h)?(ui.set(h,e),i=h,h.then(s(h),a(h)),l(h)):n(h)})};t.then(s(t),a(t)),l(t)}),ui.set(t,e)),e};function Sd(t,e){const n=Oo(e),[[r,i,s],a]=F.useReducer(h=>{const p=n.get(t);return Object.is(h[0],p)&&h[1]===n&&h[2]===t?h:[p,n,t]},void 0,()=>[n.get(t),n,t]);let l=r;(i!==n||s!==t)&&(a(),l=n.get(t));const c=e==null?void 0:e.delay;if(F.useEffect(()=>{const h=n.sub(t,()=>{if(typeof c=="number"){const p=n.get(t);li(p)&&Ao(xo(p)),setTimeout(a,c);return}a()});return a(),h},[n,t,c]),F.useDebugValue(l),li(l)){const h=xo(l);return wd(h)}return l}function kd(t,e){const n=Oo(e);return F.useCallback((...i)=>{if((To?"production":void 0)!=="production"&&!("write"in t))throw new Error("not writable atom");return n.set(t,...i)},[n,t])}const Cd={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};function Ed(t,e){let n=null;const r=new Map,i=new Set,s=l=>{let c;if(e===void 0)c=r.get(l);else for(const[p,m]of r)if(e(p,l)){c=m;break}if(c!==void 0)if(n!=null&&n(c[1],l))s.remove(l);else return c[0];const h=t(l);return r.set(l,[h,Date.now()]),a("CREATE",l,h),h};function a(l,c,h){for(const p of i)p({type:l,param:c,atom:h})}return s.unstable_listen=l=>(i.add(l),()=>{i.delete(l)}),s.getParams=()=>r.keys(),s.remove=l=>{if(e===void 0){if(!r.has(l))return;const[c]=r.get(l);r.delete(l),a("REMOVE",l,c)}else for(const[c,[h]]of r)if(e(c,l)){r.delete(c),a("REMOVE",c,h);break}},s.setShouldRemove=l=>{if(n=l,!!n)for(const[c,[h,p]]of r)n(p,c)&&(r.delete(c),a("REMOVE",c,h))},s}const Md=t=>typeof(t==null?void 0:t.then)=="function";function Td(t=()=>{try{return window.localStorage}catch(n){(Cd?"production":void 0)!=="production"&&typeof window<"u"&&console.warn(n);return}},e){var n;let r,i;const s={getItem:(c,h)=>{var p,m;const b=_=>{if(_=_||"",r!==_){try{i=JSON.parse(_,e==null?void 0:e.reviver)}catch{return h}r=_}return i},v=(m=(p=t())==null?void 0:p.getItem(c))!=null?m:null;return Md(v)?v.then(b):b(v)},setItem:(c,h)=>{var p;return(p=t())==null?void 0:p.setItem(c,JSON.stringify(h,void 0))},removeItem:c=>{var h;return(h=t())==null?void 0:h.removeItem(c)}},a=c=>(h,p,m)=>c(h,b=>{let v;try{v=JSON.parse(b||"")}catch{v=m}p(v)});let l;try{l=(n=t())==null?void 0:n.subscribe}catch{}return!l&&typeof window<"u"&&typeof window.addEventListener=="function"&&window.Storage&&(l=(c,h)=>{if(!(t()instanceof window.Storage))return()=>{};const p=m=>{m.storageArea===t()&&m.key===c&&h(m.newValue)};return window.addEventListener("storage",p),()=>{window.removeEventListener("storage",p)}}),l&&(s.subscribe=a(l)),s}Td();function Od(t,e){const n=F.useMemo(()=>me(null,(r,i,...s)=>t(r,i,...s)),[t]);return kd(n,e)}Mo();const Ad=F.createContext({}),Po=()=>{const{client:t}=F.useContext(Ad);return t},Rt=(t,e)=>{const n=Po();F.useEffect(()=>{if(n)return n.on(t,e),()=>{n.off(t,e)}},[t,e,n])},xd=me(null),Pd=me(null),Ld=me(null),jd=me(null),Dd=me(null),Id=me(null),Lo=Ed(({local:t,trackType:e})=>{if(t)switch(e){case"audio":return xd;case"screenAudio":return Ld;case"screenVideo":return jd;case"video":return Pd}return e==="audio"?Dd:Id}),jo=(t,e)=>{const n=Po(),r=Sd(Lo({local:e==="local",trackType:t})),i=Od(F.useCallback((s,a,l,c,h)=>{const p=Lo({local:h,trackType:c}),m=s(p);(m==null?void 0:m.id)!==l.id&&a(p,l)},[e,r,t]));return Rt(R.TrackStarted,F.useCallback((s,a)=>{i(s,s.kind,!!(a!=null&&a.local))},[])),Rt(R.ScreenTrackStarted,F.useCallback((s,a)=>{const l=s.kind==="audio"?"screenAudio":"screenVideo";i(s,l,!!(a!=null&&a.local))},[])),F.useEffect(()=>{var l;if(!n)return;const s=n.tracks(),a=(l=s==null?void 0:s[e])==null?void 0:l[t];a&&i(a,t,e==="local")},[e,t,i,n]),r};function Nd(...t){return F.useCallback(e=>{for(let n=0;n<t.length;n++){const r=t[n];typeof r=="function"?r(e):r&&typeof r=="object"&&(r.current=e)}},t)}var Rd=Nd;const Bd=F.forwardRef(function({participant:e="local",fit:n="contain",mirror:r,onResize:i,style:s={},trackType:a="video",...l},c){const h=jo(a,e),p=F.useRef(null),m=Rd(p,c);return F.useEffect(function(){const v=p.current;if(!v)return;const _=()=>{const A=v.play();A!==void 0&&A.then(()=>{v.controls=!1}).catch(y=>{v.controls=!0,console.warn("Failed to play video",y)})},S=()=>{v.paused&&_()},L=()=>{v.style.transform="scale(1)"},C=()=>{v.style.transform="",setTimeout(()=>{v.paused&&_()},100)},T=()=>{document.visibilityState!=="hidden"&&v.paused&&_()};return v.addEventListener("canplay",S),v.addEventListener("enterpictureinpicture",L),v.addEventListener("leavepictureinpicture",C),document.addEventListener("visibilitychange",T),()=>{v.removeEventListener("canplay",S),v.removeEventListener("enterpictureinpicture",L),v.removeEventListener("leavepictureinpicture",C),document.removeEventListener("visibilitychange",T)}},[]),F.useEffect(function(){const v=p.current;if(!(!v||!h))return v.srcObject=new MediaStream([h]),v.load(),()=>{v.srcObject=null,v.load()}},[h,h==null?void 0:h.id]),F.useEffect(function(){const v=p.current;if(!i||!v)return;let _;function S(){_&&cancelAnimationFrame(_),_=requestAnimationFrame(()=>{const L=p.current;if(!L||document.hidden)return;const C=L.videoWidth,T=L.videoHeight;C&&T&&(i==null||i({aspectRatio:C/T,height:T,width:C}))})}return S(),v.addEventListener("loadedmetadata",S),v.addEventListener("resize",S),()=>{_&&cancelAnimationFrame(_),v.removeEventListener("loadedmetadata",S),v.removeEventListener("resize",S)}},[i]),j.jsx("video",{autoPlay:!0,muted:!0,playsInline:!0,ref:m,style:{objectFit:n,transform:r?"scale(-1, 1)":"",...s},...l})});Bd.displayName="RTVIClientVideo",me([]),me([]),me([]),me({}),me({}),me({}),me("disconnected");const Fd=F.memo(({backgroundColor:t="transparent",barColor:e="black",barWidth:n=30,barGap:r=12,barMaxHeight:i=120,participantType:s})=>{const a=F.useRef(null),l=jo("audio",s);return F.useEffect(()=>{if(!a.current)return;const c=5*n+4*r,h=i,p=a.current,m=2,b=()=>{p.width=c*m,p.height=h*m,p.style.width=`${c}px`,p.style.height=`${h}px`,v.lineCap="round",v.scale(m,m)},v=p.getContext("2d");if(b(),!l)return;const _=new AudioContext,S=_.createMediaStreamSource(new MediaStream([l])),L=_.createAnalyser();L.fftSize=1024,S.connect(L);const C=new Uint8Array(L.frequencyBinCount);v.lineCap="round";const T=[{startFreq:85,endFreq:255,smoothValue:0},{startFreq:255,endFreq:500,smoothValue:0},{startFreq:500,endFreq:2e3,smoothValue:0},{startFreq:2e3,endFreq:4e3,smoothValue:0},{startFreq:4e3,endFreq:8e3,smoothValue:0}],A=E=>{const k=_.sampleRate/2;return Math.round(E/k*(L.frequencyBinCount-1))};function y(){L.getByteFrequencyData(C),v.clearRect(0,0,p.width/m,p.height/m),v.fillStyle=t,v.fillRect(0,0,p.width/m,p.height/m);let E=!1;const k=T.length*n+(T.length-1)*r,P=(p.width/m-k)/2,I=n/2;T.forEach((x,N)=>{const q=A(x.startFreq),oe=A(x.endFreq),ye=C.slice(q,oe),je=ye.reduce((qe,Bt)=>qe+Bt,0)/ye.length,nt=.2;je<1?x.smoothValue=Math.max(x.smoothValue-nt*5,0):(x.smoothValue=x.smoothValue+(je-x.smoothValue)*nt,E=!0);const Ae=P+N*(n+r),rt=Math.min(x.smoothValue/255*i,i),$e=Math.max(p.height/m/2-rt/2,I),kt=Math.min(p.height/m/2+rt/2,p.height/m-I);x.smoothValue>0?(v.beginPath(),v.moveTo(Ae+n/2,$e),v.lineTo(Ae+n/2,kt),v.lineWidth=n,v.strokeStyle=e,v.stroke()):(v.beginPath(),v.arc(Ae+n/2,p.height/m/2,I,0,2*Math.PI),v.fillStyle=e,v.fill(),v.closePath())}),E||w(I,e),requestAnimationFrame(y)}function w(E,k){const P=T.length*n+(T.length-1)*r,I=(p.width/m-P)/2,x=p.height/m/2;T.forEach((N,q)=>{const oe=I+q*(n+r);v.beginPath(),v.arc(oe+n/2,x,E,0,2*Math.PI),v.fillStyle=k,v.fill(),v.closePath()})}return y(),window.addEventListener("resize",b),()=>{_.close(),window.removeEventListener("resize",b)}},[t,e,r,i,n,l]),j.jsx("canvas",{ref:a,style:{display:"block",width:"100%",height:"100%"}})});Fd.displayName="VoiceVisualizer";class Ud{constructor(e,n){this.apiKey=e,this.handlers=n,this.ws=null,this.reconnectAttempts=0,this.maxReconnectAttempts=3,this.baseReconnectDelay=1e3,this.isConnecting=!1,this.inactivityTimeout=null,this.manuallyEnded=!1,this.resetInactivityTimer()}connect(){this.isConnecting||(this.manuallyEnded=!1,console.log("Connecting to WebSocket..."),this.ws=new WebSocket(`wss://stage-chatbox.quibbleai.io:3333/ws?apiKey=${this.apiKey}`),this.ws.onopen=()=>{var e,n;console.log("WebSocket connected"),this.isConnecting=!1,this.reconnectAttempts=0,(n=(e=this.handlers).onConnect)==null||n.call(e)},this.ws.onmessage=e=>{var n,r,i,s,a,l,c,h;try{const p=JSON.parse(e.data);switch(p.event){case"ready":console.log("Ready event received"),(r=(n=this.handlers).onReady)==null||r.call(n);break;case"typing":console.log("Typing event received"),(s=(i=this.handlers).onTyping)==null||s.call(i,p.data.status);break;case"assistant_message":console.log("Assistant message received"),(l=(a=this.handlers).onMessage)==null||l.call(a,p.data.assistant_text);break;default:console.warn("Unknown event received:",p.event)}}catch(p){console.error("Message parsing error:",p),(h=(c=this.handlers).onError)==null||h.call(c,p)}},this.ws.onclose=()=>{console.log("WebSocket closed"),this.isConnecting=!1,this.handleReconnect()},this.ws.onerror=e=>{var n,r;console.error("WebSocket error:",e),(r=(n=this.handlers).onError)==null||r.call(n,e)})}resetInactivityTimer(){this.inactivityTimeout&&clearTimeout(this.inactivityTimeout),this.inactivityTimeout=setTimeout(()=>{var e;if(((e=this.ws)==null?void 0:e.readyState)===WebSocket.OPEN){const n={event:"keepAlive"};this.ws.send(JSON.stringify(n))}},5e4),this.inactivityTimeout=setTimeout(()=>{var e,n;console.log("Connection closed due to inactivity"),(n=(e=this.handlers).onSessionEnd)==null||n.call(e),this.disconnect()},18e4)}sendMessage(e){var n,r,i;if(this.resetInactivityTimer(),((n=this.ws)==null?void 0:n.readyState)===WebSocket.OPEN){const s={event:"user_message",data:{user_text:e}};console.log("Sending message:",s),this.ws.send(JSON.stringify(s)),(i=(r=this.handlers).onLocalMessage)==null||i.call(r,e)}else throw new Error("WebSocket is not connected")}handleReconnect(){var n,r;if(this.manuallyEnded){console.log("Manual disconnect - skipping reconnect");return}if(this.reconnectAttempts>=this.maxReconnectAttempts){(r=(n=this.handlers).onError)==null||r.call(n,new Error("Max reconnection attempts reached"));return}const e=this.baseReconnectDelay*Math.pow(2,this.reconnectAttempts);this.reconnectAttempts++,console.log(`Attempting to reconnect in ${e}ms (attempt ${this.reconnectAttempts})`),setTimeout(()=>this.connect(),e)}disconnect(e=!1){e&&(this.manuallyEnded=!0),this.inactivityTimeout&&clearTimeout(this.inactivityTimeout),this.ws&&(console.log("Disconnecting WebSocket"),this.ws.close(),this.ws=null)}}const tn=(t,e="white")=>{const n=`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="${e}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">${t}</svg>`;return`data:image/svg+xml;base64,${btoa(n)}`},$d=()=>j.jsx("img",{src:tn('<path d="m22 2-7 20-4-9-9-4Z" /><path d="M22 2 11 13" />'),alt:"Send",className:"cb-w-5 cb-h-5 cb-text-current"}),qd=()=>j.jsx("img",{src:tn('<path d="M18 6 6 18" /><path d="m6 6 12 12" />'),alt:"Close",className:"cb-w-6 cb-h-6 cb-text-current"}),Jd=()=>j.jsx("img",{src:tn('<path d="M18.36 6.64A9 9 0 0 1 20.77 15" /><path d="M6.16 6.16a9 9 0 1 0 12.68 12.68" /><path d="M12 2v4" />'),alt:"Power",className:"cb-w-6 cb-h-6 cb-text-current"}),di=({onWhiteBackground:t=!1})=>j.jsx("img",{src:tn('<path d="M12 8V4H8" /><rect width="16" height="12" x="4" y="8" rx="2" /><path d="M2 14h2" /><path d="M20 14h2" /><path d="M15 13v2" /><path d="M9 13v2" />',t?"#6B46C1":"white"),alt:"Bot",className:"cb-w-6 cb-h-6"}),Vd=()=>j.jsx("img",{src:tn('<path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/><line x1="12" y1="19" x2="12" y2="23"/><line x1="8" y1="23" x2="16" y2="23"/>'),alt:"Microphone",className:"cb-w-5 cb-h-5 cb-text-current"}),Wd=(t,e=30)=>{const[n,r]=F.useState(""),i=F.useRef(null);return F.useEffect(()=>{let s=0;const a=setInterval(()=>{s<t.length?(r(t.substring(0,s+1)),s++,i.current&&i.current.scrollIntoView({behavior:"smooth",block:"end"})):clearInterval(a)},e);return()=>clearInterval(a)},[t,e]),{displayedText:n,containerRef:i}},zd=t=>{const e=[];let n=0;for(;n<t.length;){const r=Math.min(t.indexOf("[",n)===-1?1/0:t.indexOf("[",n),t.indexOf("- {",n)===-1?1/0:t.indexOf("- {",n));if(r===1/0)break;if(r>n&&e.push({type:"text",content:t.slice(n,r).trim()}),t[r]==="["){const i=t.indexOf("]",r)+1;if(i===0)break;try{const s=t.slice(r,i),a=JSON.parse(s.replace(/'/g,'"'));e.push({type:"table",data:a}),n=i}catch{n=r+1}}else{let i=[],s=r;for(;s!==-1&&t.startsWith("- {",s);){const a=t.indexOf("}",s)+1;if(a===0)break;try{const l=t.slice(s+2,a),c=JSON.parse(l.replace(/'/g,'"'));i.push(c),s=t.indexOf("- {",a)}catch{break}}i.length>0?(e.push({type:"table",data:i}),n=t.indexOf("}",r)+1):n=r+1}}return n<t.length&&e.push({type:"text",content:t.slice(n).trim()}),e},Gd=({data:t})=>{const e=Object.keys(t[0]);return j.jsx("div",{className:"cb-w-fit",children:j.jsxs("table",{className:"cb-w-full cb-border-collapse cb-text-sm cb-table",children:[j.jsx("thead",{children:j.jsx("tr",{className:"cb-bg-purple-100",children:e.map(n=>j.jsx("th",{className:"cb-border cb-border-purple-200 cb-p-2 cb-text-left cb-font-semibold cb-text-gray-800 cb-table-cell",children:n.charAt(0).toUpperCase()+n.slice(1)},n))})}),j.jsx("tbody",{children:t.map((n,r)=>j.jsx("tr",{className:"cb-even:bg-purple-50",children:e.map(i=>j.jsx("td",{className:"cb-border cb-border-purple-200 cb-p-2 cb-text-sm cb-text-gray-800 cb-table-cell",children:n[i]},i))},r))})]})})},Do=({message:t,type:e})=>{const n=e==="user",r=t.includes("[")||t.includes("- {"),{displayedText:i,containerRef:s}=Wd(e==="assistant"&&!r?t:""),a=()=>{if(!n&&r)try{const l=zd(t);return j.jsx("div",{className:`cb-w-fit ${n?"cb-text-white":"cb-text-gray-800"}`,children:l.map((c,h)=>j.jsxs(F.Fragment,{children:[c.type==="text"&&j.jsx("p",{className:`cb-my-2 cb-font-semibold ${n?"cb-text-white":"cb-text-gray-800"}`,children:c.content}),c.type==="table"&&j.jsx("div",{className:"cb-my-4",children:j.jsx(Gd,{data:c.data})})]},h))})}catch(l){return console.error("Error parsing sections:",l),j.jsx("span",{children:t})}return j.jsx("span",{className:n?"cb-text-white":"cb-text-gray-800",children:e==="assistant"?i:t})};return j.jsxs("div",{ref:s,className:`cb-flex ${n?"cb-flex-row-reverse cb-text-white":"cb-flex-row cb-text-gray-800"} cb-items-end cb-gap-2 cb-mb-4`,children:[e==="assistant"&&j.jsx("div",{className:"cb-h-8 cb-w-8 cb-flex cb-items-center cb-justify-center cb-rounded-full cb-bg-[#BE3CEB] cb-flex-shrink-0",children:j.jsx(di,{className:"cb-w-5 cb-h-5 cb-text-white"})}),j.jsx("div",{className:`cb-w-fit cb-p-3 cb-rounded-lg ${n?"cb-bg-[#BE3CEB] cb-text-white cb-rounded-br-none cb-ml-auto":"cb-bg-gray-100 cb-text-gray-800 cb-rounded-bl-none cb-mr-auto"} cb-font-semibold cb-text-sm`,children:a()})]})};Do.propTypes={message:sn.string.isRequired,type:sn.string.isRequired};const Hd=()=>j.jsx("div",{className:"cb-flex cb-items-center cb-bg-gray-100 cb-py-3 cb-px-4 cb-rounded-lg cb-w-fit",children:j.jsxs("div",{className:"cb-flex cb-items-center cb-gap-2",children:[j.jsx("div",{className:"cb-w-2 cb-h-2 cb-rounded-full cb-bg-gray-500 cb-animate-bounce"}),j.jsx("div",{className:"cb-w-2 cb-h-2 cb-rounded-full cb-bg-gray-500 cb-animate-bounce [animation-delay:-0.15s]"}),j.jsx("div",{className:"cb-w-2 cb-h-2 cb-rounded-full cb-bg-gray-500 cb-animate-bounce [animation-delay:-0.3s]"})]})}),Qd="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC4AAAAvCAYAAACc5fiSAAAABmJLR0QA/wD/AP+gvaeTAAAGZElEQVRo3tVZe2xTZRTvvbeP9bbdunZby95tt25ru3aOjb1f0M3JQyGiRECJZMYQX8wHCxolQiKoRIiOABJCQKYEBBQIMhigyNMwGDE+g49ohD8YyOZw8trxnNESBXvvbXuHcJLff/f+zu+e73znnO+7CkXklot4ArEWcRTRjehHXEGcQ3yL2Ix4GVGB4BT/o+kRzyBOWNVamGBOh3npBdDmrIK9nrvhiHcMHPONhX35jbAxtxYWZhbBtCQHuPg4wHdOIRYiMm6lYBViFssw3Y3xKbAyqxyOF4yDrjDwcd5IeDQpC3Sc8hJyrUAkDbXoQsSXVbGWQeddYQq+EZ/jatAqKBnmLPJOHSrRTRih/gUZhVELvhHrc2rAFqOHQPTVcopuydDoYIsMUQ6Fg957YGSclcTvDuyfqG22UxsLuz0NQyY6CNrM95rSSPyuwF6K2B6yqGIG2t31Qy76uviCscHIr4xUtEPDcj0bcmtumeggDntHgyPGAJFsWAaxf3ZqfthOqX5/kFMNb9tHwFu2YlidXQGfYl2PZMOqGLYHdQwLR/hUD28cXDapjqie+43DQMtyl/H9TsRWxCbEAaz5PXfpTPBKmg86fdI5p1uyKOqrpIqmdvwDRUoK+R7ctLXXcvIkYjrC9B+cVOIaER12TIE12ZWSuA9gpYlXqq/iezlShD9A0ZFCTK08Wc0P4Dtzw6i/49UMe36+xH4ww5pDQXlXCvF2KU2mAytNoiqGojE5go3vYhTMb632EkkryjFML76jFSJM4FnlZdrVYiWLVgWffzGKUlsWy6ku7nD5RcWXGxLJ10Qhsok1OIeIEb2ROZyIDgWqTzT26n3YcMT8taR4yN9yIaLFzckuUaKsazXWL0NXjsM0OPuJSNSpNOKzXwsRdSx1lAqSfJRXRyS/yBDtoK2YhREV8nnUN4by/IpQAfhpm2uUlGVbJuMAN6FKQnqm4ZCHzzpDkfQswm63HKMeCvXGZCKYKaNwV4qaF/RJCIy9JaFI+hB/SsAcGYXbJPokTAtF8ntZzjqocm0LiVTz/fTlz8so3KuLsQn6JBi0TvJbHIrku4rczdBQ0BUS7rQ5RNAmo/BHLMZ6QZ+EGNXgWBHycL21wLZYkKDG3QGMgj0X7aD/D9vgSZ8n6HOU9xCKZihV2FAkc22WJtGvNxvK6OubZBDtUHL6i3X5+wT9FWetDDa8kDbSqPOKCi9xtlEEfqUGEm20s4Y9KerPYX2chM8XIlJjGnRXu3eIkqUnTiGyHVHcSj0bq80Dv/eIqC99jJ18lYkRLpMShXpfJ6ZMORGuR/Bhim7WqBKuSAlQiXNtcNYX7dRutdI8ICUSft8XkGIaT8QnKM0kCLZTelCkpYgmWIx+4n9aakQ2OZObJRETfJlvAq/JIAf7Ec8F6m1K4GrNQyWPBNNGpNWUEhRCqfN92kunw1lRB8dq+6vd7ZLFU+oU2pdAWsKDEMe7QaNKArXShPmZBVZjA1DJE6se/+Y7hjz5INQtQ14EmfRFgwRSnckJh3VG8FYr7CmUiv3OzKRpt1x0ob0VlKx6QMvpfkYNdREN+oiucPI9WozIXgO8Mh7e8W6HeXnvgVll6dNy+lahrhnKUumPgt3yGBIfH/JI61RmeN29HvZUdg9ia+mP4Iot6uM5w4eRpE0C4mBSXC1usM9kF0z7iHLapLbAEl/7ddFBtJefAhvv6tOwmhciSRs6Ni3UqBKv5mfMly36VPKoehQaq2HDiK9uEh3EumKcEFn+AmpIj3S+KKUfVNREqH5TGYxEMM071FyMqkRocbbC7sozIUUHMTlt5iUdZ1gdzXBEuTYOsU+tjB+g2l1gWwS1nr0Co+nhwSmPBqbA7HGSY7ht2XrPHzsrTouKJmws+QbUrOaCXCM1Hb0o97bTr0EVF4enlVygHmA2lEAs7wocApj+wGhKU1554OMZHRe7q9I85gLlsRTxmXzOeXyvZij+FSUGfnLVBe5eihCZAuVMgxVji1Pn7VtVeFBUeEPSpD6ZzgKyGKNiVU9pWG3vaOvD/W1FnSGFT0mdSfeVLyluMzNjx3wN87i33NTYu7Sg4ybh45Ob/pL5ekTev9a4As3Y8s/kGYb3LnCvu151SuL99JdikuI2NyVdY2uVhu+tmozeFueSAZ7T06HZqriDrF6vjDvEs/ouxR1qNx3Q/wZPOqJAP92DzQAAAABJRU5ErkJggg==",Kd=({apiKey:t,isOpen:e,onStateChange:n,setIsOpen:r,messages:i,setMessages:s})=>{const[a,l]=F.useState(""),[c,h]=F.useState(!1),[p,m]=F.useState(!1),b=ud(),[v,_]=F.useState(!1),[S,L]=F.useState(!1),[C,T]=F.useState(!1),A=F.useRef(null),y=F.useRef(null);F.useEffect(()=>(y.current=new Ud(t,{onConnect:()=>_(!0),onDisconnect:()=>_(!1),onTyping:()=>h(!0),onMessage:N=>{h(!1),s(q=>[...q,{role:"assistant",content:N}])},onLocalMessage:N=>{s(q=>[...q,{role:"user",content:N}])},onReady:()=>{T(!0)},onSessionEnd:()=>{m(!0)}}),()=>{var N;return(N=y.current)==null?void 0:N.disconnect()}),[t]),F.useEffect(()=>{e&&!v&&(y.current.manuallyEnded=!1,y.current.connect())},[e,v]),F.useEffect(()=>{A.current&&(A.current.scrollTop=A.current.scrollHeight)},[i,c]),F.useEffect(()=>{n&&n(e)},[e,n]),F.useEffect(()=>{const N=q=>{q&&typeof q.final=="boolean"&&q.final===!0?(console.log("Final transcription received:",q.text),y.current.sendMessage(q.text)):console.log("Non-final transcription or invalid data:",q)};return b.on(R.UserTranscript,N),()=>{b.off(R.UserTranscript,N)}},[b]),Rt(R.BotTyping,()=>{h(!0)}),Rt(R.ActionsAvailable,()=>{console.log("Actions available")}),Rt(R.Connected,()=>{console.log("Connected")}),Rt(R.SessionEnd,()=>{m(!0)});const w=N=>{if(N.preventDefault(),!(!a.trim()||!v||!C))try{y.current.sendMessage(a),l("")}catch(q){console.error("Failed to send message:",q)}},E=async N=>{N.preventDefault(),N.stopPropagation();try{await b.connect(),console.log("Voice button clicked")}catch(q){console.error("Failed to initialize voice chat:",q)}},k=N=>{N.key==="Enter"&&!N.shiftKey&&(N.preventDefault(),w(N))},P=async()=>{r(!1),n&&n(!1),await b.disconnect(),y.current.disconnect(!0),s([]),_(!1),L(!0),m(!0)},I=()=>{r(!1),n&&n(!1)},x=async()=>{s([]),m(!1),await b.connect(),y.current.connect()};return j.jsxs("div",{className:`cb-chat-window cb-fixed cb-bottom-4 cb-right-[4.5rem] cb-origin-bottom-left cb-transition-all cb-duration-200 cb-w-[400px] cb-h-[600px] cb-bg-gray-50 cb-rounded-lg cb-shadow-xl cb-flex cb-flex-col ${e?"cb-scale-100 cb-opacity-100 cb-translate-y-0":"cb-scale-95 cb-opacity-0 cb-translate-y-4"}`,children:[p&&j.jsx("div",{className:"cb-modal-backdrop",children:j.jsxs("div",{className:"cb-modal-content",children:[j.jsx("p",{className:"cb-session-ended-text",children:"The last session is over. Please start over if you require further help."}),j.jsxs("div",{className:"cb-session-ended-buttons",children:[j.jsx("button",{onClick:x,className:"cb-session-button cb-start-again",children:"Start Again"}),j.jsx("button",{onClick:P,className:"cb-session-button cb-cancel",children:"Cancel"})]})]})}),j.jsxs("div",{className:"cb-bg-[#BE3CEB] cb-p-4 cb-rounded-t-lg cb-flex cb-items-center cb-justify-between cb-z-50",children:[j.jsxs("div",{className:"cb-flex cb-items-center cb-gap-2",children:[j.jsx("div",{className:"cb-h-7 cb-w-7 cb-flex cb-items-center cb-justify-center cb-rounded-full cb-bg-white",children:j.jsx(di,{className:"cb-w-5 cb-h-5 cb-text-[#BE3CEB] cb-cursor-pointer",onWhiteBackground:!0})}),j.jsxs("h2",{className:"cb-text-white cb-flex cb-items-center cb-justify-center cb-text-lg cb-font-semibold",children:["Quibble Support",v&&C&&j.jsx("span",{className:"cb-inline-block cb-w-2 cb-h-2 cb-rounded-full cb-bg-green-400 cb-ml-2"})]})]}),j.jsxs("div",{className:"cb-flex cb-items-center cb-gap-2",children:[j.jsx("button",{onClick:P,className:"cb-text-white hover:cb-text-red-200 cb-transition-colors cb-cursor-pointer",title:"End Chat",children:j.jsx(Jd,{className:"cb-w-6 cb-h-6 cb-cursor-pointer"})}),j.jsx("button",{onClick:I,className:"cb-text-white hover:cb-text-purple-200 cb-transition-colors cb-cursor-pointer",title:"Close Chat",children:j.jsx(qd,{className:"cb-w-6 cb-h-6 cb-cursor-pointer"})})]})]}),j.jsxs("div",{ref:A,className:"cb-flex-1 cb-overflow-y-auto cb-p-4 cb-space-y-4 cb-bg-gray-50 cb-chat-messages cb-z-50",children:[i.map((N,q)=>j.jsx(Do,{message:N.content,type:N.role==="user"?"user":"assistant"},q)),c&&j.jsxs("div",{className:"cb-flex cb-items-center cb-gap-2",children:[j.jsx("div",{className:"cb-h-8 cb-w-8 cb-flex cb-items-center cb-justify-center cb-rounded-full cb-bg-[#BE3CEB]",children:j.jsx(di,{className:"cb-w-5 cb-h-5 cb-text-white"})}),j.jsx(Hd,{})]})]}),j.jsx("div",{className:"cb-bg-white cb-p-4 cb-shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.1)] cb-z-20",children:j.jsxs("div",{className:"cb-flex cb-gap-2 cb-w-full",children:[j.jsx("button",{type:"button",onClick:E,className:"cb-p-2 cb-text-white cb-bg-[#BE3CEB] cb-rounded-lg hover:cb-bg-[#ac2adb] disabled:cb-bg-gray-400 disabled:cb-cursor-not-allowed cb-transition-colors",children:j.jsx(Vd,{className:"cb-w-5 cb-h-5"})}),j.jsx("form",{onSubmit:w,className:"cb-flex-1",children:j.jsxs("div",{className:"cb-flex cb-gap-2",children:[j.jsx("textarea",{value:a,onChange:N=>l(N.target.value),onKeyDown:k,placeholder:"Type a message...",className:"cb-flex-1 cb-resize-none cb-p-2 cb-border cb-rounded-lg cb-border-gray-300 focus:cb-outline-none focus:cb-border-[#BE3CEB] focus:cb-ring-1 focus:cb-ring-[#BE3CEB] cb-bg-white cb-max-h-32 cb-font-normal",rows:"1"}),j.jsx("button",{type:"submit",disabled:!v,className:"cb-p-2 cb-text-white cb-bg-[#BE3CEB] cb-rounded-lg hover:cb-bg-[#ac2adb] disabled:cb-bg-gray-400 disabled:cb-cursor-not-allowed cb-transition-colors",children:j.jsx($d,{className:"cb-w-5 cb-h-5"})})]})})]})})]})},Io=({onStateChange:t,apiKey:e})=>{const[n,r]=F.useState(!1),[i,s]=F.useState([]),a=()=>{const l=!n;r(l),t&&t(l)};return j.jsx("div",{className:"cb-fixed cb-inset-0 cb-pointer-events-none",children:j.jsxs("div",{className:"cb-fixed cb-bottom-4 cb-right-4 cb-pointer-events-auto",children:[j.jsx("button",{onClick:a,className:`cb-items-center cb-justify-center cb-w-14 cb-h-14 cb-cursor-pointer cb-bg-[#ECFFE6] cb-duration-200 cb-rounded-full cb-shadow-[0_0_15px_5px_rgba(255,245,228,0.6)] ${n?"cb-opacity-0":"cb-flex cb-opacity-100"}`,children:j.jsx("img",{src:Qd,alt:"quibbleAI",className:"cb-w-8 cb-h-8 cb-cursor-pointer"})}),n&&j.jsx(ld,{children:j.jsx(Kd,{apiKey:e,isOpen:n,onStateChange:t,setIsOpen:r,messages:i,setMessages:s})})]})})};Io.propTypes={apiKey:sn.string.isRequired,onStateChange:sn.func};var Jn={},No;function Yd(){if(No)return Jn;No=1;var t=Bo;return Jn.createRoot=t.createRoot,Jn.hydrateRoot=t.hydrateRoot,Jn}var Xd=Yd();function Ro(t,e={}){const n=document.createElement("div");n.id="chatbot-container",document.body.appendChild(n),Xd.createRoot(n).render(F.createElement(F.StrictMode,null,F.createElement(Io,{apiKey:t,onStateChange:e.onStateChange})))}return window.ChatbotWidget={init:Ro},Wn.init=Ro,Object.defineProperty(Wn,Symbol.toStringTag,{value:"Module"}),Wn}({},React,ReactDOM);
